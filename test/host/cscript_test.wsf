<?xml version='1.0' encoding='UTF-8'?>
<job id="test">
    <script language="javascript"><![CDATA[

var
    gpfSourcesPath = "..\\..\\",
    fso = new ActiveXObject("Scripting.FileSystemObject"),
    include = function (path) {
        eval(fso.OpenTextFile(path, 1/*forReading*/, false, 0).ReadAll());
    },
    version;

if (WScript.Arguments.length > 0) {
    version = WScript.Arguments(0);
}
if ("release" === version) {
    include("..\\..\\build\\gpf.js");
} else if ("debug" === version) {
    include("..\\..\\build\\gpf-debug.js");
} else {
    include("..\\..\\boot.js");
}
WScript.Echo("Using " + version + " version");
if (!gpf.sources) {
    include("..\\..\\sources.js");
}
include("..\\manager.js");

function callback(event) {
    if ("error" === event.type())  {
        WScript.Echo("(X) " + event.get("message"));
    } else if ("warning" === event.type()) {
        WScript.Echo("/!\\ " + event.get("message"));
    } else if ("info" === event.type()) {
        WScript.Echo("[?] " + event.get("message"));
    } else if ("log" === event.type()) {
        WScript.Echo(event.get("message"));
    } else if ("success" === event.type()) {
        WScript.Echo("OK " + event.get("name"));
    } else if ("failure" === event.type()) {
        WScript.Echo("KO " + event.get("name"));
        gpf.testReport(event.get("name"), callback);
    }
}

gpf.runTests(callback);

gpf.runAsyncQueue();

    ]]></script>
</job>