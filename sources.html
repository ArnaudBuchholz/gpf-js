<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>GPF-JS sources</title>
        <link rel="stylesheet" type="text/css" href="res/html.css">
        <link rel="stylesheet" type="text/css" href="res/table.css">
        <link rel="stylesheet" type="text/css" href="res/sources.css">
        <script language="JavaScript" src="build/gpf-debug.js"></script>
        <script language="JavaScript" src="res/xhr.js"></script>
        <script language="JavaScript" src="res/tpl.js"></script>
        <script language="JavaScript" src="sources.js"></script>
    </head>
    <body class="noselect">
        <table>
            <thead>
                <th>Name</th>
                <th>Dep.</th>
                <th>Ref.</th>
                <th>Load</th>
                <th>Test</th>
                <th>Doc.</th>
                <th>Description</th>
                <th>Implements</th>
            </thead>
            <tbody id="rows"></tbody>
        </table>
        <button id="save">Save</button>

        <template id="tpl_row">
{%
    function row() {
        $write("id=\"" + $object.getName() + "\" ");
        if (!$object.isReadOnly()) {
            $write("draggable=\"true\" ");
        }
    }

    function check(propertyName) {
        if ($object.isReadOnly()) {
            $write("disabled=\"true\" ");
        }
        if ($object.testProperty(propertyName)) {
            $write("checked");
        }
    }
%}
            <tr {%%}="row();">
                <td>{% $write($object.getName()); %}</td>
                <td>{%

if ($object.hasDependencies()) {
    %}<span class="dependencies" {%%}="$write('title=\'' + $object.getDependencies().join('\n') + '\'');">{% $write($object.getDependencies().length); %}</span>{%
} else {
    $write("&nbsp;");
}

                %}</td>
                <td>{%

if ($object.isReferenced()) {
    %}<span class="references" {%%}="$write('title=\'' + $object.getDependencyOf().join('\n') + '\'');">{% $write($object.getDependencyOf().length); %}</span>{%
} else {
    $write("&nbsp;");
}

                %}</td>
                <td><input id="load_{{$index}}" type="checkbox" {%%}="check('load');"></td>
                <td><input id="test_{{$index}}" type="checkbox" {%%}="check('test');"></td>
                <td><input id="doc_{{$index}}" type="checkbox" {%%}="check('doc');"></td>
                <td class="description">{% $write($object.getDescription()); %}</td>
                <td><ul class="items">{%

$object.getItems().forEach(function (item) {
    %}<li>{%
    if (item.internal) {
        %}<span class="internal">internal</span>{%
    }
    %}<span class="items">{% $write(item.type); %}</span>{%
    $write(item.name);
    %}</li>{%
});

                %}</ul></td>
            </tr>
        </template>
        <template id="edit_description">
            <input type="text" style="width: 100%;"/>
        </template>
    </body>
</html>
