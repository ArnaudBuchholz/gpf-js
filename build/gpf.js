!function(a,b){"use strict";if("function"==typeof define&&define.amd)define(["exports"],b);else if("undefined"!=typeof exports)b(exports);else if("undefined"!=typeof module&&module.exports)b(module.exports);else{var c={};b(c),a.gpf=c}}(this,function(a){"use strict";function b(){}function c(b,c){if(void 0===c&&(c="Assertion with no message",b=!1),!b)throw console.warn("ASSERTION FAILED: "+c),a.Error.assertionFailed({message:c})}function d(a){for(var b in a)a.hasOwnProperty(b)&&c(a[b],b)}function e(a,b,c){var d,e=a.length;for(d=0;e>d;++d)b.call(c,a[d],d,a)}function f(a,b,c){for(var d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)}function g(a,b){this[0][b]=a}function h(a,b){var c=this[0],d=this[2];void 0===c[b]?c[b]=a:d(c,b,a)}function i(a,b,c){var d;return void 0===c?d=g:(wb("function"==typeof c,"Expected function"),d=h),f(b,d,arguments),a}function j(a,c){var d=c.on;c.methods&&i(d.prototype,c.methods,b),c.statics&&i(d,c.statics,b)}function k(a){for(var b=[],c=a;c--;)b.unshift("p["+c+"]");return b}function l(a){var b=["var C = this, p = arguments, l = p.length;"],c=k(a);return c.forEach(function(a,d){b.push("if ("+d+" === l) { return new C("+c.slice(0,d).join(", ")+");}")}),b.join("\r\n")}function m(a){return new Function(l(a))}function n(a){return 10>a?"0"+a:a}function o(a){var b,c,d,e,f;if("string"==typeof a&&(Bb.lastIndex=0,b=Bb.exec(a))){for(d=[],e=b.length-1,f=0;e>f;++f)c=b[f+1],c?d.push(parseInt(b[f+1],10)):d.push(0);if(--d[1],d[1]<12&&d[2]<32&&d[3]<24&&d[4]<60&&d[5]<60)return d}}function p(){var a=arguments[0],b=o(a);return b?new Cb(Cb.UTC.apply(Cb.UTC,b)):Ab.apply(Cb,arguments)}function q(){var a=Function.prototype.toString.call(this),b=a.indexOf("function"),c=a.indexOf("(",b);return a.substr(b+9,c-b-9).replace(Eb,"").trim()}function r(a,b,c){function d(a){return function(b){e&&(e=!1,a(b))}}var e=!0;try{a(d(b),d(c))}catch(f){e&&(e=!1,c(f))}}function s(){var a=this;a._handlers.forEach(function(b){b.process(a)}),a._handlers=[]}function t(a){var b=this;b._state=!1,b._value=a,s.call(b)}function u(a){var b=this;try{if(wb(a!==b,"A promise cannot be resolved with itself."),a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void r(c.bind(a),u.bind(b),t.bind(b))}b._state=!0,b._value=a,s.call(b)}catch(d){t.call(b,d)}}function v(){}function w(a,b){return a.dt-b.dt}function x(a,b){wb("number"==typeof b,"Timeout is required");var c={id:++Hb,dt:new Date((new Date).getTime()+b),cb:a};return Gb.push(c),Gb.sort(w),Hb}function y(a){var b;Gb.every(function(c,d){return c.id===a?(b=d,!1):!0})||Gb.splice(b,1)}function z(){for(var a,b,c=Gb;c.length;)a=c.shift(),b=new Date,a.dt>b&&Ib(a.dt-b),a.cb()}function A(a,b){return void 0!==a?a[b]:void 0}function B(a,b){var c=a[b];return void 0===c&&(c=a[b]={}),c}function C(b,c){var d;return"gpf"===b[0]?(d=a,b=b.slice(1)):d=rb,b.reduce(c,d)}function D(a,b){var c;return c=b?B:A,C(a,c)}function E(){return!1}function F(a,b){var c;return void 0===b&&(b=a,a=[]),wb("string"==typeof b&&b.length,"Source expected (or use _gpfEmptyFunc)"),0===a.length?Vb(b):(c=[].concat(a),c.push(b),Vb.apply(null,c))}function G(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function H(a){return null===a||"object"!=typeof a?rb:a}function I(a){var b,c=typeof a;return"function"===c?1===a.length:"object"!==c?!1:(b=a.dispatchEvent,"function"==typeof b?1===b.length:!0)}function J(a,c){var d,e=a.scope;return"function"==typeof c.dispatchEvent?c.dispatchEvent.bind(c):"function"==typeof c?c.bind(e):(d=c[a.type]||c["*"]||b,d.bind(c.scope||c))}function K(a,b,c){var d=J(a,b);d(a),void 0!==c&&c(a)}function L(b,c,d){var e=H(this);return wb(I(d),"Expected a valid event handler"),b instanceof bc||(b=new a.events.Event(b,c,e)),new Promise(function(a){++cc>10?setTimeout(K.bind(null,b,d,a),0):(K(b,d),a(b)),--cc})}function M(a){return new Promise(function(b,c){a(function(a){Kb===a.type?c(a.get("error")):b(a)})})}function N(a,b){var c,d=a.split("."),e=d.pop(),f=D(d,!0);f[e]=function(){return c=b(a),f[e]=c,c.apply(this,arguments)}}function O(a){return a.charAt(0).toUpperCase()+a.substr(1)}function P(a,b){var c=a;return f(b,function(a,b){c=c.split(b).join(a)}),c}function Q(a,b){return a=P(a,dc[b]),"javascript"===b&&(a='"'+a+'"'),a}function R(a,b,c){var d,e=typeof a;return c||(c=typeof b),c===e?a:"undefined"===e?b:(d=ec[c](a,e,b),void 0===d?b:d)}function S(a){return a.trim()}function T(a){this.parameters=[],void 0!==a&&this._extract(a)}function U(a){this._pending=[],this._done=[],!0===a?this._haveDifferentPrototypes=E:this._alike=E}function V(a,b,c){return function(d){var e,g,h=new fc;return h.code=a,h.name=b,d?(g={},f(d,function(a,b){g["{"+b+"}"]=a.toString()}),e=P(c,g)):e=c,h.message=e,h}}function W(a,b,c){var d=V(a,b,c);return d.CODE=a,d.NAME=b,d.MESSAGE=c,d}function X(b,c){var d,e;sb(b);for(d in c)c.hasOwnProperty(d)&&(e=++gc,a.Error["CODE_"+d.toUpperCase()]=e,a.Error[d]=W(e,d,c[d]))}function Y(a){var b=a._eventDispatcherListeners;return b||(b=a._eventDispatcherListeners={}),b}function Z(a,b){var c=Y(this);return void 0===c[a]&&(c[a]=[]),c[a].push(b),this}function $(a,b){var c,d,e=this._eventDispatcherListeners;return e&&(c=e[a],void 0!==c&&(d=c.indexOf(b),-1!==d&&c.splice(d,1))),this}function _(a,b){var c,d=b.length;for(c=0;d>c;++c)L.call(a.scope,a,{},b[c])}function aa(a,b){var c,d,e,f=this._eventDispatcherListeners;return f?(a instanceof bc?(c=a,d=a.type):d=a,e=this._eventDispatcherListeners[d],void 0===e?this:(c||(c=new bc(d,b,this)),_(c,e),c)):this}function ba(a,b){jc[b]=a,void 0===ic[a]&&(ic[a]=b)}function ca(a,b){f(b,function(b,c){var d=a+c;0===b?ba(d,"."+c):"string"==typeof b?b.split(",").forEach(function(a){ba(d,"."+a)}):ca(d+"/",b)})}function da(a){var b=jc[a.toLowerCase()];return void 0===b&&(b="application/octet-stream"),b}function ea(a){var b=ic[a.toLowerCase()];return void 0===b&&(b=".bin"),b}function fa(){null===jc&&(jc={},ic={},ca("",hc))}function ga(a,b,c){var d,e,f,g=a.base,h=a.value,i=[];for(d=void 0===c?32:c*b,e=(1<<d-b)-1,d=(1<<b)-1;0!==h;)f=h&d,i.unshift(g.charAt(f)),h=h>>b&e;return i}function ha(a){for(var b,c=a.base,d=a.value,e=[],f=c.length;0!==d;)b=d%f,e.unshift(c.charAt(b)),d=(d-b)/f;return e}function ia(b,c){var d=a.bin.isPow2(b.base.length);return d>-1&&(void 0===c||32>=c*d)?ga(b,d,c):ha(b)}function ja(a,b,c){var d=c.length,e=c.pad,f=ia({base:a,value:b},d);if(void 0!==d)for(void 0===e&&(e=a.charAt(0));f.length<d;)f.unshift(e.charAt(f.length%e.length));else 0===f.length&&(f=[a.charAt(0)]);return f.join("")}function ka(a,b,c){var d=a.length,e=0,f=0;for(void 0===c&&(c=a.charAt(0));f<b.length&&-1!==c.indexOf(b.charAt(f));)++f;for(;f<b.length;)e=d*e+a.indexOf(b.charAt(f++));return e}function la(a){var b,c,d,e;b=a instanceof Array,c=[];for(d in a)"function"!=typeof a[d]&&(e=na(a[d]),b?c.push(e):c.push(Q(d,"javascript")+":"+e));return b?"["+c.join(",")+"]":"{"+c.join(",")+"}"}function ma(a){return a.toString()}function na(a){var b=qc[typeof a];return void 0!==b?b(a):null===a?"null":la(a)}function oa(a){return F("return "+a)()}function pa(a){if(-1<a.indexOf("/"))a=a.split("/");else{if(!(-1<a.indexOf("\\")))return[a];a=a.toLowerCase().split("\\")}return a.length&&!a[a.length-1]&&a.pop(),a}function qa(a){return a=pa(a),a[a.length-1]}function ra(a){return a.split("*")}function sa(a){"!"===a.charAt(0)&&(this.negative=!0,a=a.substr(1));var b=a.indexOf("**");-1===b?this.start=a.split("/").map(ra):(b>0&&(wb("/"===a.charAt(b-1),"** must be preceded by /"),this.start=a.substr(0,b-1).split("/").map(ra)),b<a.length-2&&(wb("/"===a.charAt(b+2),"** must be followed by /"),this.end=a.substr(b+3).split("/").map(ra).reverse()))}function ta(a){return a instanceof sa?a:new sa(a)}function ua(a){return a instanceof Array?a.map(ta):[ta(a)]}function va(a){var b=a.negative;return a.match(this.parts)?(this.result=!b,!1):b?(this.result=!0,!1):!0}function wa(a,b){var c=pa(b),d=ua(a),e={parts:c};return d.every(va,e),e.result}function xa(a){var b,c,d=rc.length;for(b=0;d>b;++b)if(c=rc.charAt(b),-1!==a.indexOf(c))return c;return rc.charAt(0)}function ya(a){var b=a.length-1;return"\r"===a.charAt(b)?a.substr(0,b):a}function za(a,b){b=b||{},this._lines=a.split("\n").map(ya);var c=b.header||this._lines.shift();this._separator=b.separator||xa(c),this._quote=b.quote||'"',this._columns=c.split(this._separator)}function Aa(a){return"constructor"===a?"constructor ":a}function Ba(a){return"constructor "===a?"constructor":a}function Ca(a){return function(){a.isConstructionAllowed()&&a._resolvedConstructor.apply(this,arguments)}}function Da(a){var b=a.toString().split("._super");return!b.every(function(a){return-1!==_b.indexOf(a.charAt(0))})}function Ea(a,b){return function(){var c,d=this._super;this._super=a;try{c=b.apply(this,arguments)}finally{void 0===d?delete this._super:this._super=d}return c}}function Fa(a,b,c){this._uid=++uc,tc[this._uid]=this,this._Subs=[],"function"==typeof a?(this._name=a.compatibleName()||"anonymous",this._Constructor=a):(this._name=a,this._Super=b,this._definition=c,this._build())}function Ga(a){var b,c=a[vc];return void 0===c?(b=new Fa(a),a[vc]=b._uid):b=tc[c],b}function Ha(a,b,c){xb({"name is required (String)":"string"==typeof a,"base is required (String|Function)":"string"==typeof b||b instanceof Function,"definition is required (Object)":"object"==typeof c});var d,e,f,g,h;return-1<a.indexOf(".")&&(e=a.split("."),g=e.pop(),f=D(e,!0)),"string"==typeof b&&(b=D(b.split(".")),wb(b instanceof Function,"base must resolve to a function")),h=new Fa(a,b,c),d=h._Constructor,void 0!==f&&(f[g]=d),d}function Ia(a,b){var c=this[b];void 0!==c&&(this[a]=c,delete this[b])}function Ja(a,b,c){return f(Bc,Ia,c),Ha(a,b,c)}function Ka(a,b){return a+=".",b=a+b,function(c,d,e){return void 0===e&&"object"==typeof d&&(e=d,d=b),-1===c.indexOf(".")&&(c=a+c),Ja(c,d||b,e||{})}}function La(b,c){c="$"+c,a[c]=function(){var a=F("return function "+c+"(args) {this.constructor.apply(this, args);};")();return a.prototype=b.prototype,function(){return new a(arguments)}}()}function Ma(a){return F("return this."+a+".length;")}function Na(a){return F(["idx"],"return this."+a+"[idx];")}function Oa(a,b,c){var d,e,f="$"===a.charAt(0);return f?(a=a.substr(1),d=a+"Attribute"):d=a,e=Gc(d,b,c),f&&La(e,a),e}function Pa(b,c){throw sb(b,c),a.Error.abstractMethod()}function Qa(){return this._MEMBER_}function Ra(a){var b=this._MEMBER_;return this._MEMBER_=a,b}function Sa(a,b){var c,d,e,f;return c=a.toString().split("_MEMBER_").join(b),e=c.indexOf("(")+1,f=c.indexOf(")",e)-1,d=c.substr(e,f-e+1).split(",").map(function(a){return a.trim()}),e=c.indexOf("{")+1,f=c.lastIndexOf("}")-1,c=c.substr(e,f-e+1),F(d,c)}function Ta(a,b){var c,d,e,f;for(c in b.prototype)if("constructor"!==c){if(d=b.prototype[c],e=a[c],f=typeof e,typeof d!==f)return!1;if("function"===f&&d.length!==e.length)return!1}return!0}function Ua(b,c,d){var e=null;if(Ta(b,c))return b;if(Ta(b,a.interfaces.IUnknown)&&(e=b.queryInterface(c)),null===e&&(void 0===d||d))throw a.Error.interfaceExpected({name:Ga(c)._name});return e}function Va(b){var c,d=new a.attributes.Map(this).getMemberAttributes("Class").filter(a.attributes.InterfaceImplementAttribute);return d.every(function(a){return c=a._builder,a._interfaceDefinition!==b||!c})?null:"function"==typeof c?c(this):this[c]()}function Wa(a){return function(b){sb(b);var c=Va.apply(this,arguments);return null===c&&(c=a.apply(this,arguments)),c}}function Xa(b,c,d){function e(a){L.call(b,a,{},d)}var f,g=Nc.query(b,Nc.IEnumerator);if(1<c.length)f=function(b){if(a.events.EVENT_CONTINUE===b.type){if(!g.moveNext(f))return}else{if(a.events.EVENT_STOP===b.type)return e(a.events.EVENT_STOPPED);if(a.events.EVENT_DATA!==b.type)return e(b.type)}c(g.current(),f)},g.moveNext(f)&&c(g.current(),f);else for(f=function(b){if(a.events.EVENT_DATA!==b.type)return e(b);do c(g.current());while(g.moveNext(f))};g.moveNext(f);)c(g.current())}function Ya(a){var b=-1;return{reset:function(){b=-1},moveNext:function(c){var d;return++b,d=b<a.length,!d&&c&&L.call(this,Nb,{},c),d},current:function(){return a[b]}}}function Za(a){var b=new Fc.Map(a).filter(Fc.EnumerableAttribute),c=b.getMembers();return Ya(a[c[0]])}function $a(b){return function(c,d,e){function f(a,b){L(a,b||{},e)}function g(a){Kb===a.type&&f(a),0===--i&&f(Nb)}function h(d){var e,l,m=d.type;Tb===m?(++i,b.explore(d.filePath,function(a){Kb===a.type?f(a):Nc.IEnumerator.each(a.get("enumerator"),h,g)})):Sb===m&&(e=d.filePath,l=a.path.relative(c,e),j(k,l)&&f(Mb,{path:l}))}var i=0,j=a.path.match,k=a.path.compileMatchPattern(d);b.getInfo(c,function(a){Kb===a.type?f(a):h(a.get("info"))})}}function _a(a,b){this._readable=Ua(a.readable,Nc.IReadableStream,!0),this._writable=Ua(a.writable,Nc.IWritableStream,!0),void 0!==a.chunkSize&&(this._chunkSize=a.chunkSize),this._eventsHandler=b}function ab(a,b){var c=new _a(a,b);c.ready()}function bb(a,b){for(var c,d,e=a.length,f=0;b>0&&e>f&&(c=a[f],d=c.length,b>=d);)++f,b-=d;return{count:f,remaining:b}}function cb(a,b,c){var d,e;return wb(b<=a.length,"itemsCount within strings range"),d=b>0?a.splice(0,b):[],a.length&&c&&(e=a.shift(),d.push(e.substr(0,c)),a.unshift(e.substr(c))),d.join("")}function db(a,b){var c=bb(a,b);return cb(a,c.count,c.remaining)}var eb,fb,gb,hb,ib="0.1.5-alpha",jb="browser",kb="nodejs",lb="phantomjs",mb="rhino",nb="unknown",ob="wscript",pb=nb,qb=!1,rb=this,sb=b,tb=b,ub=!1,vb=!1;"undefined"!=typeof WScript?(pb=ob,qb=!0):"undefined"!=typeof print&&"undefined"!=typeof java?(pb=mb,qb=!1):"undefined"!=typeof phantom&&phantom.version?(pb=lb,qb="\\"===require("fs").separator):"undefined"!=typeof module&&module.exports?(pb=kb,hb=require("path"),qb="\\"===hb.sep,rb=global):"undefined"!=typeof window&&(pb=jb,rb=window),a.host=function(){return pb},a.version=function(){return ib},jb===pb&&(vb=!0,tb=function(a){window.location="https://arnaudbuchholz.github.io/gpf/exit.html?"+(a||0)},eb=window,fb=document,gb=fb.getElementsByTagName("head")[0]||fb.documentElement),kb===pb&&(ub=!0,tb=function(a){process.exit(a)}),lb===pb&&(ub=!0,vb=!0,tb=function(a){phantom.exit(a)}),mb===pb&&(rb.console={log:function(a){print("    "+a)},info:function(a){print("[?] "+a)},warn:function(a){print("/!\\ "+a)},error:function(a){print("(X) "+a)}},tb=function(a){java.lang.System.exit(a)}),ob===pb&&(rb.console={log:function(a){WScript.Echo("    "+a)},info:function(a){WScript.Echo("[?] "+a)},warn:function(a){WScript.Echo("/!\\ "+a)},error:function(a){WScript.Echo("(X) "+a)}},tb=function(a){WScript.Quit(a)});var wb,xb;a.assert=c,a.asserts=d,wb=b,xb=b;var yb;yb=rb.gpf,a.noConflict=function(){return void 0===yb?delete rb.gpf:rb.gpf=yb,a};var zb=function(a){return Array.isArray(a)};jb===pb&&(eb.HTMLCollection||eb.NodeList)&&(zb=function(a){return Array.isArray(a)||a instanceof eb.HTMLCollection||a instanceof eb.NodeList}),a.isArrayLike=zb,a.forEach=function(a,b,c){return zb(a)?void e(a,b,c):void f(a,b,c)},a.extend=i,j("Array",{on:Array,methods:{every:function(a){var b,c=arguments[1],d=this.length;for(b=0;d>b;++b)if(!a.call(c,this[b],b,this))return!1;return!0},filter:function(a){var b,c,d=arguments[1],e=[],f=this.length;for(b=0;f>b;++b)c=this[b],a.call(d,this[b],b,this)&&e.push(c);return e},forEach:function(a){var b,c=arguments[1],d=this.length;for(b=0;d>b;++b)a.call(c,this[b],b,this)},indexOf:function(a){for(var b=arguments[1],c=b||0,d=this.length;d>c;){if(this[c]===a)return c;++c}return-1},map:function(a){var b,c=arguments[1],d=this.length,e=new Array(d);for(b=0;d>b;++b)e[b]=a.call(c,this[b],b,this);return e},reduce:function(a){var b,c=arguments[1],d=this.length,e=0;for(b=void 0===c?this[e++]:c;d>e;++e)b=a(b,this[e],e,this);return b}},statics:{from:function(a){var b,c=a.length,d=[],e=arguments[1],f=arguments[2];if("string"==typeof a)for(b=0;c>b;++b)d.push(a.charAt(b));else for(b=0;c>b;++b)d.push(a[b]);return"function"==typeof e&&(d=d.map(e,f)),d},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)}}});var Ab=m(10);j("Date",{on:Date,methods:{toISOString:function(){return[this.getUTCFullYear(),"-",n(this.getUTCMonth()+1),"-",n(this.getUTCDate()),"T",n(this.getUTCHours()),":",n(this.getUTCMinutes()),":",n(this.getUTCSeconds()),".",(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5),"Z"].join("")}}});var Bb=new RegExp(["^([0-9][0-9][0-9][0-9])","\\-","([0-9][0-9])","\\-","([0-9][0-9])","(?:T","([0-9][0-9])","\\:","([0-9][0-9])","\\:","([0-9][0-9])","(?:\\.","([0-9][0-9][0-9])","Z)?)?$"].join("")),Cb=rb.Date;!function(){var a,b,c=["prototype","UTC","parse","now"],d=c.length;for(a=0;d>a;++a)b=c[a],p[b]=Cb[b];var e=!1;try{var f=new Date("2003-01-22T22:45:34.075Z"),g=new Date("2003-01-22");e=2003===f.getUTCFullYear()&&0===f.getUTCMonth()&&22===f.getUTCDate()&&22===f.getUTCHours()&&45===f.getUTCMinutes()&&34===f.getUTCSeconds()&&75===f.getUTCMilliseconds()&&2003===g.getUTCFullYear()&&0===g.getUTCMonth()&&22===g.getUTCDate()}catch(h){}e||(rb.Date=p)}();var Db=Array.prototype.slice;j("Function",{on:Function,methods:{bind:function(a){var b=this,c=Db.call(arguments,1);return function(){var d=Db.call(arguments,0);b.apply(a,c.concat(d))}}}});var Eb=new RegExp("//.*$|/\\*(?:[^\\*]*|\\*[^/]*)\\*/","gm");!function(){function a(){}return"functionName"!==a.name}()?Function.prototype.compatibleName=function(){return this.name}:Function.prototype.compatibleName=q,j("Object",{on:Object,statics:{create:function(){function a(){}return function(b){a.prototype=b;var c=new a;return a.prototype=null,c.__proto__||(c.__proto__=b),c}}(),getPrototypeOf:function(a){return a.__proto__?a.__proto__:a.constructor.prototype},keys:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c},values:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}}}),j("String",{on:String,methods:{trim:function(){var a=new RegExp("^[\\s\ufeff ]+|[\\s\ufeff ]+$","g");return function(){return this.replace(a,"")}}()}});var Fb=a.Promise=function(a){r(a,u.bind(this),t.bind(this))};v.prototype={onFulfilled:null,onRejected:null,resolve:null,reject:null,process:function(a){var b=this;return null===a._state?(a.hasOwnProperty("_handlers")||(a._handlers=[]),void a._handlers.push(b)):void setTimeout(function(){var c,d;if(c=a._state?b.onFulfilled:b.onRejected,null===c)return void(a._state?b.resolve(a._value):b.reject(a._value));try{d=c(a._value)}catch(e){return void b.reject(e)}b.resolve(d)},0)}},Fb.prototype={_state:null,_value:null,_handlers:[],then:function(a,b){var c=this;return new Fb(function(d,e){var f=new v;void 0!==a&&(f.onFulfilled=a),void 0!==b&&(f.onRejected=b),f.resolve=d,f.reject=e,f.process(c)})},"catch":function(a){return this.then(null,a)}},Fb.resolve=function(a){return new Fb(function(b){b(a)})},Fb.reject=function(a){return new Fb(function(b,c){sb(b),c(a)})},Fb.all=function(a){return 0===a.length?Fb.resolve([]):new Fb(function(b,c){function d(f,g){try{if(f&&f instanceof Fb)return void f.then(function(a){d(a,g)},c);a[g]=f,0===--e&&b(a)}catch(h){c(h)}}var e=a.length;a.forEach(d)})},Fb.race=function(a){return new Fb(function(b,c){a.forEach(function(a){a.then(b,c)})})},void 0===rb.Promise&&(rb.Promise=Fb);var Gb=[],Hb=0,Ib=b;a.handleTimeout=b,"undefined"==typeof setTimeout&&(ob===pb?Ib=function(a){WScript.Sleep(a)}:mb===pb?Ib=java.lang.Thread.sleep:console.warn("No implementation for setTimeout"),rb.setTimeout=x,rb.clearTimeout=y,a.handleTimeout=z),a.context=function(a){return void 0===a?rb:D(a.split("."))};var Jb="*",Kb="error",Lb="ready",Mb="data",Nb="endOfData",Ob="continue",Pb="stop",Qb="stopped",Rb=0,Sb=1,Tb=2,Ub=99,Vb=Function,Wb=2147483647,Xb=4294967295,Yb="abcdefghijklmnopqrstuvwxyz",Zb="ABCDEFGHIJKLMNOPQRSTUVWXYZ",$b="0123456789",_b=Yb+Zb+$b+"_$",ac="break,case,class,catch,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,let,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield".split(",");G(a,{HOST_BROWSER:jb,HOST_NODEJS:kb,HOST_PHANTOMJS:lb,HOST_RHINO:mb,HOST_UNKNOWN:nb,HOST_WSCRIPT:ob}),ub&&(a.node={}),a.web={},a.events={isValidHandler:I};var bc=a.events.Event=function(a,b,c){this.type=a,this.scope=H(c),void 0!==b&&(this._params=b)};bc.prototype={constructor:bc,type:"",scope:null,_params:{},get:function(a){return this._params[a]}};var cc=0;bc.prototype.fire=function(a){return L.call(this,this,{},a)},a.events.fire=function(b,c,d){sb(b,c,d);var e,f=this;return this!==a.events&&(e=f),void 0===d&&(d=c,c={}),L.call(e,b,c,d)},a.events.getPromiseHandler=M,G(a.events,{EVENT_ANY:Jb,EVENT_ERROR:Kb,EVENT_READY:Lb,EVENT_DATA:Mb,EVENT_END_OF_DATA:Nb,EVENT_CONTINUE:Ob,EVENT_STOP:Pb,EVENT_STOPPED:Qb}),vb&&(a.web.include=function(){function a(a,b){this.id=++g,this.url=a,this.eventsHandler=b,h[this.id]=this}function b(a){return h[a.substr(f.length)]}function c(){var a=this,c=b(a.id);c&&c.check(a)}function d(){var a=this,c=b(a.id);c&&c.failed(a)}function e(a){gb.insertBefore(a,gb.firstChild)}var f="gpf-include-",g=0,h={};return a.prototype={id:0,url:"",eventsHandler:null,clean:function(a){var b=a.parentNode;a.onerror=a.onload=a.onreadystatechange=null,b&&b.removeChild(a),delete h[this.id]},check:function(a){var b=a.readyState;(!b||-1<["loaded","complete"].indexOf(b))&&(this.clean(a),setTimeout(L,0,Lb,{url:this.url},this.eventsHandler))},failed:function(a){this.clean(a),setTimeout(L,0,Kb,{url:this.url},this.eventsHandler)}},function(b,g){var h=new a(b,g),i=fb.createElement("script");i.language="javascript",i.src=b,i.id=f+h.id,i.onload=i.onreadystatechange=c,i.onerror=d,void 0!==i.async&&(i.async=!0),setTimeout(e,0,i)}}());var dc={javascript:{"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r","	":"\\t"},xml:{"&":"&amp;","<":"&lt;",">":"&gt;"}};!function(){var a=dc,b={};f(a.xml,function(a,c){b[c]=a}),f({224:"&agrave;",225:"&aacute;",232:"&egrave;",233:"&eacute;",234:"&ecirc;"},function(a,c){b[String.fromCharCode(c)]=a}),a.html=b}();var ec={"boolean":function(a,b,c){return sb(c),"string"===b?"yes"===a||"true"===a?!0:0!==parseInt(a,10):"number"===b?0!==a:void 0},number:function(a,b,c){return sb(c),"string"===b?parseFloat(a):void 0},string:function(a,b,c){return a instanceof Date?a.toISOString():(sb(b,c),a.toString())},object:function(a,b,c){return c instanceof Date&&"string"===b&&o(a)?new Date(a):void 0}};a.value=R,i(a,{clone:function(a){return JSON.parse(JSON.stringify(a))},test:function(a,b){var c;if(a instanceof Array){for(c=a.length;c>0;)if(a[--c]===b)return c}else for(c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c},set:function(a,b){wb(a instanceof Array,"gpf.set must be used with an Array");for(var c=a.length;c>0;)if(a[--c]===b)return a;return a.push(b),a},clear:function(a,b){var c;if(a instanceof Array){for(c=a.length;c>0;)if(a[--c]===b){a.splice(c,1);break}}else for(c in a)a.hasOwnProperty(c)&&a[c]===b&&delete a[c];return a},xor:function(a,b){return a&&!b||!a&&b}}),a.exit=function(a){void 0===a&&(a=0),tb(a)},T.prototype={isNative:!1,name:"",parameters:[],body:"",replaceInBody:function(a){this.body=P(this.body,a)},_extract:function(a){this.name=a.compatibleName();var b,c,d=Function.prototype.toString.call(a).replace(Eb,"");0<a.length?(b=d.indexOf("(")+1,c=d.indexOf(")",b)-1,this.parameters=d.substr(b,c-b+1).split(",").map(S)):this.parameters=[],-1<d.indexOf("[native")?this.isNative=!0:(b=d.indexOf("{")+1,c=d.lastIndexOf("}")-1,this.body=d.substr(b,c-b+1))},generate:function(){return F("return "+this._toSource())()},_toSource:function(){var a;return a=this.name?" "+this.name:"",["function",a," ("].concat(this.parameters).concat([") {\n",this.body,"\n}"]).join("")}},U.prototype={_pending:[],_done:[],_stack:function(a,b){var c,d,e=this._done;for(c=e.indexOf(a);c>-1;){if(d=c%2?e[c-1]:e[c+1],d===b)return;c=e.indexOf(a,c+1)}e=this._pending,e.push(a),e.push(b)},_haveDifferentPrototypes:function(a,b){return a.constructor!==b.constructor},explore:function(){for(var a,b,c=this._pending,d=this._done;0!==c.length;){if(b=c.pop(),a=c.pop(),d.push(a,b),this._haveDifferentPrototypes(a,b))return!1;if(this._checkMembersDifferences(a,b))return!1}return!0},_checkMembersDifferences:function(a,b){var c,d=0;for(c in a)if(a.hasOwnProperty(c)&&(++d,!this.like(a[c],b[c])))return!0;for(c in b)b.hasOwnProperty(c)&&--d;return 0!==d},_downcast:function(a){return"object"==typeof a?a instanceof String?a.toString():a.valueOf():a},_alike:function(a,b){return this._downcast(a)===this._downcast(b)},like:function(a,b){return a===b?!0:typeof a!=typeof b?this._alike(a,b):null===a||null===b||"object"!=typeof a?!1:(this._stack(a,b),!0)}},a.like=function(a,b,c){var d=new U(c);return d.like(a,b)&&d.explore()};var fc=a.Error=function(){};fc.prototype={constructor:fc,code:0,name:"Error",message:""};var gc=0;X("boot",{notImplemented:"Not implemented",abstractMethod:"Abstract method",assertionFailed:"Assertion failed: {message}",invalidParameter:"Invalid parameter"}),a.mixins={EventDispatcher:{addEventListener:Z,removeEventListener:$,dispatchEvent:aa}};var hc={application:{javascript:"js"},image:{gif:0,jpeg:"jpg,jpeg",png:0},text:{css:0,html:"htm,html",plain:"txt,text,log"}},ic=null,jc=null;N("gpf.web.getMimeType",function(){return fa(),da}),N("gpf.web.getFileExtension",function(){return fa(),ea});var kc=Zb+Yb+$b+"+/",lc="0123456789ABCDEF",mc=987654321,nc=(new Date).getTime()&Xb;a.bin={pow2:function(a){if(31===a)return Wb+1;if(32===a)return Xb+1;if(31>a)return 1<<a;var b=Xb+1;for(a-=31;--a;)b*=2;return b},isPow2:function(a){if(a>0&&0===(a&a-1)){for(var b=0;a>1;)++b,a/=2;return b}return-1},toHexa:function(a,b,c){return ja(lc,a,{length:b,pad:c})},fromHexa:function(a,b){return ka(lc,a,b)},toBase64:function(a,b,c){return ja(kc,a,{length:b,pad:c})},fromBase64:function(a,b){return ka(kc,a,b)},test:function(a,b){return(a&b)===b},clear:function(a,b){return a&~b},random:function(){return mc=36969*(65535&mc)+(mc>>16)&Xb,nc=18e3*(65535&nc)+(nc>>16)&Xb,((mc<<16)+nc&Xb)+Wb}};var oc,pc,qc={undefined:b,"function":b,number:ma,"boolean":ma,string:function(a){return Q(a,"javascript")}};"undefined"==typeof JSON?(oc=na,pc=oa,rb.JSON={stringify:oc,parse:pc}):(oc=JSON.stringify,pc=JSON.parse),a.path={join:function(a){a=pa(a);var b,c,d=arguments.length;for(b=1;d>b;++b){for(c=pa(arguments[b]);".."===c[0];){if(c.shift(),!a.length)return"";a.pop()}c.length&&(a=a.concat(c))}return a.join("/")},parent:function(a){return a=pa(a),a.pop(),a.join("/")},name:qa,nameOnly:function(a){var b=qa(a),c=b.lastIndexOf(".");return-1===c?b:b.substr(0,c)},extension:function(a){var b=qa(a),c=b.lastIndexOf(".");return-1===c?"":b.substr(c)},relative:function(a,b){a=pa(a),b=pa(b);for(var c;a.length&&b.length&&a[0]===b[0];)a.shift(),b.shift();for(c=a.length+1;--c;)b.unshift("..");return b.join("/")}},sa.prototype={constructor:sa,negative:!1,start:null,end:null,_matchName:function(a,b){var c,d,e=a.length,f=0;for(c=0;e>c;++c)if(d=a[c]){if(f=b.indexOf(d,f),-1===f)return!1;if(0===c&&f>0)return!1}return!d||f+d.length===b.length},_matchStart:function(a){var b,c=a.parts,d=c.length,e=a.startPos,f=this.start,g=f.length;for(b=0;g>b;++b){if(!this._matchName(f[b],c[e]))return!1;if(++e>=d)return b===g-1&&!this.end}a.startPos=e},_matchEnd:function(a){var b,c=a.parts,d=a.startPos,e=c.length-1,f=this.end,g=f.length;for(b=0;g>b;++b){if(!(e>-1&&this._matchName(f[b],c[e])))return!1;if(e--<d)return!1}},match:function(a){var b,c={parts:a,startPos:0};return this.start&&(b=this._matchStart(c),void 0!==b)?b:this.end&&(b=this._matchEnd(c),void 0!==b)?b:!0}},i(a.path,{match:function(a,b){return wa(a,b)||!1},compileMatchPattern:function(a){return ua(a)}}),a.js={keywords:function(){return[].concat(ac)}},X("csv",{csvInvalid:"Invalid CSV syntax (bad quote sequence or missing end of file)"});var rc=";,	 ";za.prototype={_lines:[],_separator:"",_quote:"",_columns:[],_unquote:function(b){for(var c=this._quote,d=b.indexOf(c),e=!0;d>-1;){if(d===b.length-1){b=b.substr(0,d),e=!1;break}if(b.charAt(d+1)!==c)throw a.Error.csvInvalid();b=b.substr(0,d)+b.substr(d+1),d=b.indexOf(c,d+1)}return[b,e]},_processQuotedLineValue:function(a,b,c){var d,e=a[b],f=[a[b-1]];return c.includeCarriageReturn?f.push("\r\n"):f.push(this._separator),d=this._unquote(e),f.push(d[0]),c.inQuotedString=d[1],a[b-1]=f.join(""),c.includeCarriageReturn=!1,a.splice(b,1),b},_processLineValue:function(a,b,c){var d,e=a[b];return 0===e.indexOf(this._quote)&&(c.inQuotedString=!0,d=this._unquote(e.substr(1)),a[b]=d[0],c.inQuotedString=d[1]),b+1},_processLineValues:function(a,b,c){var d;for(c.inQuotedString?(c.includeCarriageReturn=!0,a.unshift(b.pop()),d=1):(d=0,c.includeCarriageReturn=!1);d<a.length;)d=c.inQuotedString?this._processQuotedLineValue(a,d,c):this._processLineValue(a,d,c);return[].splice.apply(b,[b.length,0].concat(a)),!c.inQuotedString},_readValues:function(){for(var b,c=this._lines,d=this._separator,e=[],f={inQuotedString:!1,includeCarriageReturn:!1};c.length&&(b=c.shift().split(d),!this._processLineValues(b,e,f)););if(f.inQuotedString)throw a.Error.csvInvalid();return e},read:function(){var a=this._readValues(),b={};return this._columns.forEach(function(c,d){b[c]=a[d]}),b},readAll:function(){for(var a=[];this._lines.length;)a.push(this.read());return a}},a.csv={parse:function(a,b){var c=new za(a,b);return c.readAll()}},X("define",{classMemberOverloadWithTypeChange:"You can't overload a member and change its type",classInvalidVisibility:"Invalid visibility keyword"});var sc=!0,tc={},uc=0,vc="_gpf_"+a.bin.toHexa(a.bin.random(),8),wc="public|protected|private|static".split("|"),xc=-1,yc=0,zc=1,Ac=3;Fa.prototype={constructor:Fa,_uid:0,_name:"",_Super:Object,_Subs:[],_definitionAttributes:null,_Constructor:b,_definitionConstructor:null,_resolvedConstructor:b,_definition:null,isConstructionAllowed:function(){return sc},addMember:function(b,c,d){if(void 0===d)d=yc;else if(d=wc.indexOf(d),-1===d)throw a.Error.classInvalidVisibility();this._addMember(b,c,d)},_addMember:function(a,b,c){Ac===c?(wb(void 0===this._Constructor[a],"Static members can't be overridden"),this._Constructor[a]=b):"constructor"===a?this._addConstructor(b,c):this._addNonStaticMember(a,b,c)},_addConstructor:function(a,b){xb({"Constructor must be a function":"function"==typeof a,"Own constructor can't be overridden":null===this._definitionConstructor}),Da(a)&&(a=Ea(this._Super,a)),sb(b),this._definitionConstructor=a},_addNonStaticMember:function(b,c,d){var e,f,g=typeof c,h=this._Constructor.prototype;if(wb(!h.hasOwnProperty(b),"Existing own member can't be overridden"),e=this._Super.prototype[b],f=typeof e,"undefined"!==f){if(null!==e&&g!==f)throw a.Error.classMemberOverloadWithTypeChange();"function"===g&&Da(c)&&(c=Ea(e,c))}sb(d),h[b]=c},_filterAttribute:function(a,b){var c;return"["!==a.charAt(0)||"]"!==a.charAt(a.length-1)?!1:(a=Aa(a.substr(1,a.length-2)),this._definitionAttributes?c=this._definitionAttributes[a]:this._definitionAttributes={},void 0===c&&(c=[]),this._definitionAttributes[a]=c.concat(b),!0)},_defaultVisibility:xc,_deduceVisibility:function(a){var b=this._defaultVisibility;return xc===b&&(b="_"===a.charAt(0)?zc:yc),b},_processDefinitionMember:function(b,c){if(!this._filterAttribute(c,b)){var d=wc.indexOf(c);if(xc===d)return this._addMember(c,b,this._deduceVisibility(c));if(xc!==this._defaultVisibility)throw a.Error.classInvalidVisibility();this._processDefinition(b,d)}},_processDefinition:function(a,b){var c=ob===pb;this._defaultVisibility=b,f(a,this._processDefinitionMember,this),c&&a.hasOwnProperty("toString")&&this._processDefinitionMember(a.toString,"toString"),this._defaultVisibility=xc,c&&a.hasOwnProperty("constructor")&&this._addConstructor(a.constructor,this._defaultVisibility)},_processAttributes:function(){var a,b,c=this._definitionAttributes;c&&(wb("function"==typeof Ic,"Attributes can't be defined before they exist"),a=this._Constructor,b=a.prototype,f(c,function(c,d){d=Ba(d),d in b||"Class"===d?Ic(a,d,c):console.error("gpf.define: Invalid attribute name '"+d+"'")}))},_getNewClassConstructor:function(a){var b=new T(Ca);return b.replaceInBody({"function":"function "+a}),b.generate()(this)},_safeNewSuper:function(){var a;return sc=!1,a=new this._Super,sc=!0,a},_build:function(){var a,b,c,d;d=this._name.split(".").pop(),a=this._getNewClassConstructor(d),
this._Constructor=a,a[vc]=this._uid,b=this._safeNewSuper(),a.prototype=b,b.constructor=a,c=Ga(this._Super),c._Subs.push(a),this._processDefinition(this._definition,xc),this._processAttributes(),this._resolveConstructor()},_resolveConstructor:function(){this._definitionConstructor?this._resolvedConstructor=this._definitionConstructor:Object!==this._Super&&(this._resolvedConstructor=this._Super)}};var Bc={"-":"private","#":"protected","+":"public","~":"static"};a.define=function(a,b,c){return"object"==typeof b&&(c=b,b=void 0),void 0===b&&(b=Object),Ha(a,b,c||{})},Fa.prototype._attributes=null;var Cc,Dc,Ec,Fc=a.attributes={},Gc=Ka("gpf.attributes","Attribute"),Hc=Ja("gpf.attributes.Attribute",Object,{"#":{_member:"",_alterPrototype:function(a){sb(a)}},"+":{getMemberName:function(){return this._member}}});Dc=b,Ec=b,Ja("gpf.attributes.Array",Object,{"-":{_array:[]},"+":{constructor:function(){this._array=[]},getItemsCount:Ma("_array"),getItem:Na("_array"),has:function(a){return Dc(a),!this._array.every(function(b){return!(b instanceof a)})},filter:function(a){Dc(a);var b=new Fc.Array;return b._array=this._array.filter(function(b){return b instanceof a}),b},forEach:function(a,b){this._array.forEach(a,b)},every:function(a,b){return this._array.every(a,b)}}}),Cc=new Fc.Array,Ja("gpf.attributes.Map",Object,{"-":{_members:{},_count:0,_copy:function(a,b,c){return f(this._members,function(d,e){e=Ba(e),d._array.forEach(function(d){b&&!b(e,d,c)||a.add(e,d)})}),a},_filterCallback:function(a,b,c){return sb(a),b instanceof c}},"+":{constructor:function(a){this._members={},a instanceof Function?this.fillFromClassDef(Ga(a)):void 0!==a&&this.fillFromObject(a)},fillFromClassDef:function(a){for(var b,c;a&&(b=a._attributes,b&&b._copy(this),c=a._Super,c!==Object);)a=Ga(c);return this},fillFromObject:function(a){var b=Ga(a.constructor);return this.fillFromClassDef(b)},getCount:function(){return this._count},add:function(a,b){Ec(b),a=Aa(a);var c=this._members[a];void 0===c&&(c=this._members[a]=new Fc.Array),c._array.push(b),++this._count},filter:function(a){return Dc(a),this._copy(new Fc.Map,this._filterCallback,a)},getMemberAttributes:function(a){a=Aa(a);var b=this._members[a];return void 0!==b&&b instanceof Fc.Array?b:Cc},getMembers:function(){var a=[];return f(this._members,function(b,c){sb(b),a.push(Ba(c))}),a},forEach:function(a,b){f(this._members,function(c,d,e){a.call(b,c,Ba(d),e)})}}});var Ic=Fc.add=function(a,b,c){c instanceof Fc.Array?c=c._array:c instanceof Array||(c=[c]);var d,e,f,g=Ga(a),h=g._attributes;for(h||(h=g._attributes=new Fc.Map),d=c.length,e=0;d>e;++e)f=c[e],wb(f instanceof Hc,"Expected attribute"),f._member=b,h.add(b,f),f._alterPrototype(a.prototype)};X("a_attributes",{onlyForAttributeClass:"The attribute {attributeName} can be used only on an Attribute class",onlyOnClassForAttributeClass:"The attribute {attributeName} must be used on Class",classOnlyAttribute:"The attribute {attributeName} can be used only for Class",memberOnlyAttribute:"The attribute {attributeName} can be used only for members",uniqueAttributeConstraint:"Attribute {attributeName} already defined on {className}",uniqueMemberAttributeConstraint:"Attribute {attributeName} already defined on {className}::{memberName}"});var Jc=Oa("AttrClassOnlyAttribute",{"#":{_alterPrototype:function(b){if(!(b instanceof Hc))throw a.Error.onlyForAttributeClass({attributeName:Ga(this.constructor)._name});if("Class"!==this._member)throw a.Error.onlyOnClassForAttributeClass({attributeName:Ga(this.constructor)._name})}}}),Kc=Oa("AttrConstraintAttribute",Jc,{"~":{originalAlterPrototype:"_alterPrototype:checked"},"-":{_checkAndAlterPrototype:function(a){var b=this,c=Fc.AttrConstraintAttribute,d=c.originalAlterPrototype,e=new Fc.Map(b);e.filter(Kc).forEach(function(c){c.forEach(function(c){c._check(b,a)})}),b[d](a)}},"#":{_check:Pa,_alterPrototype:function(a){var b=Fc.AttrConstraintAttribute,c=b.originalAlterPrototype;this._super(a),void 0===a[c]&&(a[c]=a._alterPrototype,a._alterPrototype=this._checkAndAlterPrototype)}}});Oa("$ClassAttribute",Kc,{"#":{_check:function(b,c){if(sb(c),"Class"!==b._member){var d=b.constructor,e=Ga(d);throw a.Error.classOnlyAttribute({attributeName:e._name})}}}}),Oa("$MemberAttribute",Kc,{"#":{_check:function(b,c){if(sb(c),"Class"===b._member){var d=b.constructor,e=Ga(d);throw a.Error.memberOnlyAttribute({attributeName:e._name})}}}}),Oa("$UniqueAttribute",Kc,{"-":{_classScope:!0},"#":{_check:function(b,c){var d,e,f,g,h,i,j=b._member;if(d=c.constructor,e=Ga(d),f=new Fc.Map(d),g=b.constructor,h=Ga(g),i=f.filter(g),this._classScope){if(1<i.getCount())throw a.Error.uniqueAttributeConstraint({attributeName:h._name,className:e._name})}else if(1<i.getMemberAttributes(j).getItemsCount())throw a.Error.uniqueMemberAttributeConstraint({attributeName:h._name,className:e._name,memberName:j})}},"+":{constructor:function(a){void 0!==a&&(this._classScope=!0===a)}}});var Lc,Mc=Oa("ClassAttribute");Oa("$ClassProperty",Mc,{"[Class]":[a.$MemberAttribute(),a.$UniqueAttribute(!1)],"-":{_writeAllowed:!1,_publicName:void 0,_visibility:void 0},"#":{_alterPrototype:function(a){var b=this._member,c=this._publicName,d=this._visibility,e=Ga(a.constructor);c||(c="_"===b.charAt(0)?b.substr(1):b),c=O(c),this._writeAllowed&&e.addMember("set"+c,Sa(Ra,b),d),e.addMember("get"+c,Sa(Qa,b),d)}},"+":{constructor:function(a,b,c){a&&(this._writeAllowed=!0),"string"==typeof b&&(this._publicName=b),"string"==typeof c&&(this._visibility=c)}}}),Oa("$ClassEventHandler",Mc,{"[Class]":[a.$MemberAttribute(),a.$UniqueAttribute(!1)]}),Lc=Oa("$ClassNonSerialized",Mc,{"[Class]":[a.$MemberAttribute(),a.$UniqueAttribute(!1)]}),X("interfaces",{interfaceExpected:"Expected interface not implemented: {name}"});var Nc=a.interfaces={isImplementedBy:function(a,b){return a instanceof Function&&(a=a.prototype),Ta(a,b)},query:Ua},Oc=Ka("gpf.interfaces","Interface");Ja("gpf.interfaces.Interface",Object,{}),Oc("IEventDispatcher",{addEventListener:function(a,b){return sb(a,b),this},removeEventListener:function(a,b){return sb(a,b),this},dispatchEvent:function(a,b){sb(a,b)}});var Pc=Oc("IUnknown",{queryInterface:function(a){return sb(a),null}});Oa("$InterfaceImplement",{"-":{"[_interfaceDefinition]":[a.$ClassProperty(!1)],_interfaceDefinition:b,"[_builder]":[a.$ClassProperty(!1)],_builder:null,_addMissingInterfaceMembers:function(a){var b,c=this._interfaceDefinition.prototype;for(b in c)b in a||(a[b]=c[b])},_addQueryInterface:function(b){void 0===b.queryInterface?(b.queryInterface=Va,Ic(b.constructor,"Class",[a.$InterfaceImplement(Pc)])):Va!==b.queryInterface&&(b.queryInterface=Wa(b.queryInterface))}},"#":{_alterPrototype:function(b){this._builder?this._addQueryInterface(b):(this._addMissingInterfaceMembers(b),(new a.attributes.Map).fillFromClassDef(Ga(this._interfaceDefinition)).forEach(function(a,c){Ic(b.constructor,c,a)}))}},"+":{constructor:function(a,b){this._interfaceDefinition=a,b&&(this._builder=b)}}}),X("i_enumerator",{enumerableInvalidMember:"$Enumerator can be associated to arrays only"}),Oc("IEnumerator",{reset:function(){},"[moveNext]":[a.$ClassEventHandler()],moveNext:function(a){return sb(a),!1},current:function(){return null},"~":{each:Xa,fromArray:Ya}}),Oa("$Enumerable",Fc.ClassAttribute,{Class:[a.$UniqueAttribute(),a.$MemberAttribute()],_alterPrototype:function(b){if(!zb(b[this._member]))throw a.Error.enumerableInvalidMember();Ic(b.constructor,"Class",[new Fc.InterfaceImplementAttribute(Nc.IEnumerator,Za)])}});var Qc=Oc("IReadOnlyArray",{getItemsCount:function(){return 0},getItem:function(a){sb(a)}});Oc("IArray",Qc,{setItemsCount:function(a){return sb(a),0},setItem:function(a,b){sb(a,b)}}),Oa("$ClassIArray",Fc.ClassAttribute,{"[Class]":[a.$UniqueAttribute(),a.$MemberAttribute()],"-":{_writeAllowed:!1},"#":{_alterPrototype:function(b){var c,d=this._member;c=this._writeAllowed?Nc.IArray:Nc.IReadOnlyArray,Ic(b.constructor,"Class",[a.$InterfaceImplement(c)]),b.getItemsCount=Ma(d),b.getItem=Na(d),this._writeAllowed&&(b.setItemsCount=F(["count"],["var oldValue = this.",d,".length;","this.",d,".length = count;","return oldValue;"].join("")),b.setItem=F(["idx","value"],["var oldValue = this.",d,"[idx];","this.",d,"[idx] = value;","return oldValue;"].join("")))}},"+":{constructor:function(a){a&&(this._writeAllowed=!0)}}}),Ic(Fc.Array,"_array",[a.$ClassIArray(!1)]),Oc("IReadableStream",{"[read]":[a.$ClassEventHandler()],read:function(a,b){sb(a,b)}}),Oc("IWritableStream",{"[write]":[a.$ClassEventHandler()],write:function(a,b){sb(a,b)}}),Oc("IFileStorage",{"[getInfo]":[a.$ClassEventHandler()],getInfo:function(a,b){sb(a,b)},"[readAsBinaryStream]":[a.$ClassEventHandler()],readAsBinaryStream:function(a,b){sb(a,b)},"[writeAsBinaryStream]":[a.$ClassEventHandler()],writeAsBinaryStream:function(a,b){sb(a,b)},close:function(a,b){sb(a,b)},"[explore]":[a.$ClassEventHandler()],explore:function(a,b){sb(a,b)},"[createFolder]":[a.$ClassEventHandler()],createFolder:function(a,b){sb(a,b)},"[deleteFile]":[a.$ClassEventHandler()],deleteFile:function(a,b){sb(a,b)},"[deleteFolder]":[a.$ClassEventHandler()],deleteFolder:function(a,b){sb(a,b)}}),X("fs",{fileNotFound:"File not found"}),a.fs={host:function(){return null},find:b},N("gpf.fs.find",function(){return $a(a.fs.host())}),G(a.fs,{TYPE_NOT_FOUND:Rb,TYPE_FILE:Sb,TYPE_DIRECTORY:Tb,TYPE_UNKNOWN:Ub}),X("stream",{readInProgress:"A read operation is already in progress",writeInProgress:"A write operation is already in progress"});var Rc=4096;a.stream={},_a.prototype={_readable:null,_writable:null,_chunkSize:Rc,_eventsHandler:null,scope:null},_a.prototype[Lb]=function(a){sb(a),this._readable.read(this._chunkSize,this)},_a.prototype[Nb]=function(a){sb(a),L.call(this,Lb,{},this._eventsHandler)},_a.prototype[Mb]=function(a){var b=a.get("buffer");this._writable.write(b,this)},_a.prototype[Jb]=function(a){L.call(this,a,{},this._eventsHandler)},a.stream.pipe=ab;var Sc=Ja("StringStream",Object,{"[Class]":[a.$InterfaceImplement(Nc.IReadableStream),a.$InterfaceImplement(Nc.IWritableStream)],"+":{constructor:function(a){"string"==typeof a?this._buffer=[a]:this._buffer=[]},read:function(a,b){var c;0===this._buffer.length?L.call(this,Nb,{},b):(c=db(this._buffer,a),L.call(this,Mb,{buffer:c},b))},write:function(a,b){wb("string"==typeof a&&a.length,"String buffer must contain data"),this._buffer.push(a),L.call(this,Lb,{},b)},toString:function(){return this._buffer.join("")}},"-":{_buffer:[]}});i(a,{capitalize:O,replaceEx:P,escapeFor:Q,stringExtractFromStringArray:db,stringToStream:function(a){return new Sc(a)},stringFromStream:function(a,b){if(a instanceof Sc)L(Lb,{buffer:a.toString()},b);else{var c=new Sc;ab({readable:a,writable:c},function(a){Lb===a.type?L(Lb,{buffer:c.toString()},b):L(a,{},b)})}}});var Tc=Ja("ArrayStream",Object,{"[Class]":[a.$InterfaceImplement(Nc.IReadableStream),a.$InterfaceImplement(Nc.IWritableStream)],"+":{constructor:function(a){a instanceof Array?this._buffer=[].concat(a):this._buffer=[]},read:function(a,b){var c;0===this._buffer.length?L.call(this,Nb,{},b):(c=this._buffer.splice(0,a),L.call(this,Mb,{buffer:c},b))},write:function(a,b){wb(a instanceof Array,"Array expected"),this._buffer=this._buffer.concat(a),L.call(this,Lb,{},b)},toArray:function(){return[].concat(this._buffer)}},"-":{_buffer:[]}});i(a,{arrayToStream:function(a){return new Tc(a)},arrayFromStream:function(a,b){if(a instanceof Tc)L(Lb,{buffer:a.toArray()},b);else{var c=new Tc;ab({readable:a,writable:c},function(a){Lb===a.type?L(Lb,{buffer:c.toArray()},b):L(a,{},b)})}}})});