(function(e,s){"function"===typeof define&&define.amd?define(["exports"],s):"undefined"!==typeof exports?s(exports):"undefined"!==typeof module&&module.exports?s(module.exports):s(e.gpf={})})(this,function(e){function s(a){var b=(new e.attributes.Map(this)).member("Class").filter(e.attributes.InterfaceImplementAttribute),c,d,f;for(c=0;c<b.length();++c)if(d=b.get(c),f=d._builder,d._interfaceDefinition===a&&f)return"function"===typeof f?f(this):this[f]();return null}function ma(a){return function(){var b=
s.apply(this,arguments);null===b&&(b=a.apply(this,arguments));return b}}var n,D=!1,q,z,w=function(a){return null===a||"object"!==typeof a?q:a},l=!1,m=!1,E,L,A=function(){};"undefined"!==typeof WScript?(n="wscript",D=!0,q=function(){return this}.apply(null,[]),z=function(a){WScript.Quit(a)},q.console={log:function(a){WScript.Echo("    "+a)},info:function(a){WScript.Echo("[?] "+a)},warn:function(a){WScript.Echo("/!\\ "+a)},error:function(a){WScript.Echo("(X) "+a)}}):"undefined"!==typeof phantom&&phantom.version?
(n="phantomjs",D="\\"===require("fs").separator,q=window,m=l=!0,z=phantom.exit):"undefined"!==typeof module&&module.exports?(n="nodejs",D="\\"===require("path").sep,q=global,l=!0,z=process.exit):("undefined"!==typeof window?(n="browser",q=window,m=!0):(n="unknown",q=this),z=A);l&&(e.node={});e.web={};m&&(E=document,L=E.getElementsByTagName("head")[0]||E.documentElement);e.version=function(){return"0.1"};e.host=function(){return n};e.context=function(a){var b,c,d;if(void 0===a)return q;"string"===
typeof a&&(a=a.split("."));b=a.length;c=0;"gpf"===a[0]?(d=e,++c):d=q;for(;c<b&&(d=d[a[c]],void 0!==d);++c);return d};e.loaded=function(a){a&&a();return!0};e.ASSERT=function(){};var F=Array.prototype.slice;void 0===Array.prototype.every&&(Array.prototype.every=function(a,b){var c=this.length,d;for(d=0;d<c;++d)if(!a.apply(b,[this[d],d,this]))return!1;return!0});void 0===Array.prototype.forEach&&(Array.prototype.forEach=function(a,b){var c=this.length,d;for(d=0;d<c;++d)a.apply(b,[this[d],d,this])});
void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(a,b){var c,d=this.length;for(c=void 0!==b?b:0;c<d;){if(this[c]===a)return c;++c}return-1});void 0===Array.prototype.map&&(Array.prototype.map=function(a,b){var c=this.length,d=Array(c),f;for(f=0;f<c;++f)d[f]=a.apply(b,[this[f],f,this]);return d});void 0===Function.prototype.bind&&(Function.prototype.bind=function(a){var b=this,c=F.apply(arguments,[1]);return function(){var d=F.apply(arguments,[0]);b.apply(a,c.concat(d))}});(function(){return"functionName"!==
function(){}.name?!0:!1})()?function(){var a=RegExp("//.*$|/\\*.*\\*/","g");Function.prototype.compatibleName=function(){var b=""+this,c=b.indexOf("function"),d=b.indexOf("(",c);return b.substr(c+9,d-c-9).replace(a,"").trim()}}():Function.prototype.compatibleName=function(){return this.name};e.setReadOnlyProperty=void 0===Object.defineProperty?function(a,b,c){a[b]=c;return a}:function(a,b,c){Object.defineProperty(a,b,{enumerable:!0,configurable:!1,writable:!1,value:c});return a};void 0===String.prototype.trim&&
function(){var a=RegExp("^[\\s\ufeff\u00a0]+|[\\s\ufeff\u00a0]+$","g");String.prototype.trim=function(){return this.replace(a,"")}}();var V=Function,W=function(){return!1},x=function(a,b){var c;void 0===b&&(b=a,a=[]);e.ASSERT("string"===typeof b&&b.length,"Source expected (or use _gpfEmptyFunc)");if(0===a.length)return V(b);c=[].concat(a);c.push(b);return V.apply(null,c)},na="break case catch continue debugger default delete do else finally for function if in instanceof new return switch this throw try typeof var void while with".split(" ");
e.events={};var M=e.events.Event=function(a,b,c){e.setReadOnlyProperty(this,"type",a);e.setReadOnlyProperty(this,"scope",w(c));void 0!==b&&(this._params=b)},X=0,Y=function(a,b){var c=a.scope;e.ASSERT(b,"Expected eventsHandler");"function"===typeof b._dispatchEvent?b._dispatchEvent(a):"function"===typeof b.apply?b.apply(c,[a]):(c=b[a.type],void 0===c&&(c=b["*"]),void 0!==c&&c.apply(b.scope||b,[a]))},oa=function(a,b,c){var d=w(this);a instanceof M||(a=new e.events.Event(a,b,d));10<++X?e.defer(Y,0,null,
[a,c]):Y(a,c);--X;return a},pa=function(a,b,c){var d=b.length,f=a.length-1;if(f!==d)for(a=F.apply(a,[0]),a[d]=a[f],--f,--d;d>f;)a[d]=b[d],--d;return c.apply(this,a)};M.prototype={constructor:M,type:"",scope:null,_params:{},get:function(a){return this._params[a]},fire:function(a){return e.events.fire(this,a)}};e.events.fire=function(){var a=this;a===e.events&&(a=void 0);return pa.apply(a,[arguments,[0,{}],oa])};var p=function(a,b){this.id=++p.id;this.src=a;this.eventsHandler=b;p.map[this.id]=this},
qa=function(a){L.insertBefore(a,L.firstChild)},Z=function(a){e.events.fire.apply(q,a)},G=function(a,b){var c=new p(a,b),d=E.createElement("script");d.language="javascript";d.src=a;d.id=c.id;d.onload=d.onreadystatechange=p.onLoad;d.onerror=p.onError;void 0!==d.async&&(d.async=!0);setTimeout(qa,0,d)};p.prototype={id:0,src:"",eventsHandler:null,clean:function(a){var b=a.parentNode;a.onerror=a.onload=a.onreadystatechange=null;b&&b.removeChild(a);delete p.map[this.id]},check:function(a){var b=a.readyState;
if(!b||-1<["loaded","complete"].indexOf(b))this.clean(a),setTimeout(Z,0,["load",{url:this.src},this.eventsHandler])},failed:function(a){this.clean(a);setTimeout(Z,0,["error",{url:this.src},this.eventsHandler])}};p.id=0;p.map={};p.onLoad=function(){var a=p.map[this.id];a&&a.check(this)};p.onError=function(){var a=p.map[this.id];a&&a.failed(this)};m&&(e.web.include=G);var $=function(a,b,c){var d,f=a.length,e;for(e=0;e<f;++e)if(d=b.apply(this,[e,a[e],f]),void 0!==d)return d;return c},ra=function(a,b){var c=
a.length,d;for(d=0;d<c;++d)b.apply(this,[d,a[d],c])},aa=function(a,b,c){var d,f;for(f in a)if(a.hasOwnProperty(f)&&(d=b.apply(this,[f,a[f]]),void 0!==d))return d;return c},ba=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b.apply(this,[c,a[c]])},sa=function(a,b){this[0][a]=b},ta=function(a,b){var c=this[0],d=this[2];void 0!==c[a]?d(c,a,b):c[a]=b},ua={"boolean":function(a,b,c){return"string"===b?"yes"===a||"true"===a?!0:0!==parseInt(a,10):"number"===b?0!==a:c},number:function(a,b,c){return"string"===
b?parseFloat(a):c},string:function(a,b,c){e.interfaces.ignoreParameter(b);e.interfaces.ignoreParameter(c);return a instanceof Date?e.dateToComparableFormat(a):a.toString()},object:function(a,b,c){return c instanceof Date&&"string"===b?e.dateFromComparableFormat(a):c}},ca=function(a,b){var c=a,d;for(d in b)b.hasOwnProperty(d)&&-1<c.indexOf(d)&&(c=c.split(d).join(b[d]));return c},va={javascript:{"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r","\t":"\\t"},xml:{"&":"&amp;","<":"&lt;",">":"&gt;"},html:{"&":"&amp;",
"<":"&lt;",">":"&gt;","\u00e9":"&eacute;","\u00e8":"&egrave;","\u00ea":"&ecirc;","\u00e1":"&aacute;","\u00e0":"&agrave;"}},da=function(a,b){var c=va[b];void 0!==c&&(a=ca(a,c),"javascript"===b&&(a='"'+a+'"'));return a},N;N="browser"===n&&(window.HTMLCollection||window.NodeList)?function(a){return a instanceof Array||a instanceof window.HTMLCollection||a instanceof window.NodeList}:function(a){return a instanceof Array};e.isArrayLike=N;e.each=function(a,b,c){if(3>arguments.length)e.isArrayLike(a)?ra.apply(this,
arguments):ba.apply(this,arguments);else return e.isArrayLike(a)?$.apply(this,arguments):aa.apply(this,arguments)};e.extend=function(a,b,c){var d;void 0===c?d=sa:(e.ASSERT("function"===typeof c,"Expected function"),d=ta);ba.apply(arguments,[b,d]);return a};e.extend(e,{value:function(a,b,c){var d=typeof a;c||(c=typeof b);return c===d?a:"undefined"!==d&&a?ua[c](a,d,b):b},clone:function(a){return e.json.parse(e.json.stringify(a))},test:function(a,b){var c;if(a instanceof Array)for(c=a.length;0<c;){if(a[--c]===
b)return c}else for(c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c},set:function(a,b){e.ASSERT(a instanceof Array,"gpf.set must be used with an Array");for(var c=a.length;0<c;)if(a[--c]===b)return a;a.push(b);return a},clear:function(a,b){var c;if(a instanceof Array)for(c=a.length;0<c;){if(a[--c]===b){a.splice(c,1);break}}else for(c in a)if(a.hasOwnProperty(c)&&a[c]===b)break;return a},xor:function(a,b){return a&&!b||!a&&b},exit:function(a){void 0===a&&(a=0);z(a)}});l&&(e.node.buffer2JsArray=function(a){var b=
[],c=a.length,d;for(d=0;d<c;++d)b.push(a.readUInt8(d));return b});var ea=function(a){this._pending=[];this._done=[];!0!==a?this._alike=W:this._haveDifferentPrototypes=W};ea.prototype={_pending:[],_done:[],_stack:function(a,b){var c=this._done,d,f;for(d=c.indexOf(a);-1<d;){f=d%2?c[d-1]:c[d+1];if(f===b)return;d=c.indexOf(a,d+1)}c=this._pending;c.push(a);c.push(b)},_haveDifferentPrototypes:function(a,b){return a.prototype!==b.prototype},explore:function(){for(var a=this._pending,b,c,d=this._done,f,e;0!==
a.length;){c=a.pop();b=a.pop();if(this._haveDifferentPrototypes(b,c))return!1;d.push(b,c);f=0;for(e in b)if(b.hasOwnProperty(e)&&(++f,!this.like(b,c)))return!1;for(e in c)c.hasOwnProperty(e)&&--f;if(0!==f)return!1}return!0},_downcast:function(a){if("object"===typeof a){if(a instanceof String)return a.toString();if(a instanceof Number)return a.valueOf();if(a instanceof Boolean)return!!a}return a},_alike:function(a,b){return this._downcast(a)===this._downcast(b)},like:function(a,b){if(a===b)return!0;
if(typeof a!==typeof b)return this._alike(a,b);if(null===a||null===b||"object"!==typeof a)return!1;this._stack(a,b);return!0}};e.like=function(a,b,c){c=new ea(c);return c.like(a,b)&&c.explore()};e.Callback=function(a,b){e.ASSERT(a,"Handler expected");this._handler=a;b&&(this._scope=w(b))};e.extend(e.Callback.prototype,{_handler:A,_scope:null,handler:function(){return this._handler},scope:function(){return this._scope},call:function(){return this.apply(arguments[0],F.apply(arguments,[1]))},apply:function(a,
b){var c=w(a||this._scope);return this._handler.apply(c,b||[])}});e.extend(e.Callback,{resolveScope:w,buildParamArray:function(a,b){var c,d,f;if(b)for(c=b.length,d=Array(a+c),f=0;f<c;++f)d[a]=b[f],++a;else d=Array(a);return d},doApply:function(a,b,c){for(var d=arguments.length,f=3,e=0;f<d;)c[e]=arguments[f],++f,++e;return a.apply(b,c)},bind:function(a,b,c){e.ASSERT("string"===typeof b,"Expected method name");e.ASSERT("function"===typeof a[b],"Only methods can be bound");var d=b+":boundToThis",f;f=
a[d];void 0===f&&(f=!0===c?function(){return a[b].apply(a,arguments)}:a[b].bind(a),a[d]=f);return f}});e.events.EventDispatcherImpl={_eventDispatcherListeners:null,addEventListener:function(a,b,c){var d=this._eventDispatcherListeners;d||(d=this._eventDispatcherListeners={});c||(c=!1);void 0===d[a]&&(d[a]=[]);c?d[a].unshift(b):d[a].push(b);return this},removeEventListener:function(a,b){var c=this._eventDispatcherListeners,d;c&&(c=c[a],void 0!==c&&(d=c.indexOf(b),-1!==d&&c.splice(d,1)));return this},
_dispatchEvent:function(a,b){var c,d,f,h;if(!this._eventDispatcherListeners)return this;a instanceof e.events.Event?(c=a,d=a.type):d=a;f=this._eventDispatcherListeners[d];if(void 0===f)return this;c||(c=new e.events.Event(d,b,this));d=f.length;for(h=0;h<d;++h)e.events.fire.apply(this,[c,f[h]]);return this}};var wa={application:{javascript:"js"},image:{gif:0,jpeg:"jpg,jpeg",png:0},text:{css:0,html:"htm,html",plain:"txt,text,log"}},y=null,B=null,fa=function(a,b){var c,d,f,e,g,k;for(c in b)if(b.hasOwnProperty(c))if(d=
a?a+"/"+c:c,e=b[c],0===e)f="."+c,B[f]=d,void 0===y[d]&&(y[d]=f);else if("string"===typeof e)for(e=e.split(","),g=e.length,k=0;k<g;++k)f="."+e[k],B[f]=d,void 0===y[d]&&(y[d]=f);else fa(d,e)},ga=function(){null===B&&(B={},y={},fa("",wa))};e.web.getMimeType=function(a){ga();a=B[a.toLowerCase()];void 0===a&&(a="application/octet-stream");return a};e.web.getFileExtension=function(a){ga();a=y[a.toLowerCase()];void 0===a&&(a=".bin");return a};"use strict";var C=function(a,b,c){"string"===typeof a&&(a=x(a));
N(c)||(c=[]);return function(){a.apply(w(b),c)}},H=[],xa=function(a,b){return a._dt-b._dt};e.runAsyncQueue=A;"browser"===n?(C=function(a){a[0].apply(w(a[1]),a[2])},l=function(a,b,c,d){"string"===typeof a&&(a=x(a));b||(b=0);setTimeout(C,b,[a,c,d])}):"undefined"!==typeof setTimeout?l=function(a,b,c,d){b||(b=0);setTimeout(C(a,c,d),b)}:"wscript"===n?(l=function(a,b,c,d){a=C(a,c,d);b||(b=0);a._dt=new Date(new Date- -b);H.push(a);H.sort(xa)},e.runAsyncQueue=function(){for(var a;H.length;)a=H.shift(),a._dt>
new Date&&WScript.Sleep(a._dt-new Date),a()}):(console.warn("No implementation for gpf.defer"),l=function(a,b,c,d){C(a,c,d)()});e.defer=l;var O=function(a,b,c,d){var f=a.length,h=e.bin.isPow2(f),g,k=[],l;if(-1<h&&(void 0===c||32>=c*h))for(g=(1<<(void 0===c?32:c*h)-h)-1,f=(1<<h)-1;0!==b;)l=b&f,k.unshift(a.charAt(l)),b=b>>h&g;else for(;0!==b;)l=b%f,k.unshift(a.charAt(l)),b=(b-l)/f;if(void 0!==c)for(void 0===d&&(d=a.charAt(0));k.length<c;)k.unshift(d.charAt(k.length%d.length));else 0===k.length&&(k=
[a.charAt(0)]);return k.join("")},P=function(a,b,c){var d=a.length,f=0,e=0;for(void 0===c&&(c=a.charAt(0));e<b.length&&-1!==c.indexOf(b.charAt(e));)++e;for(;e<b.length;)f=d*f+a.indexOf(b.charAt(e++));return f};e.bin={pow2:function(a){return 1<<a},isPow2:function(a){if(0<a&&0===(a&a-1)){for(var b=0;1<a;)++b,a>>=1;return b}return-1},toBaseANY:O,fromBaseANY:P,toHexa:function(a,b,c){return O("0123456789ABCDEF",a,b,c)},fromHexa:function(a,b){return P("0123456789ABCDEF",a,b)},toBase64:function(a,b,c){return O("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
a,b,c)},fromBase64:function(a,b){return P("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a,b)},test:function(a,b){return(a&b)===b},clear:function(a,b){return a&~b}};var I;"undefined"===typeof JSON?(I=function(a){var b=typeof a;if("undefined"!==b&&"function"!==b){if("number"===b||"boolean"===b)return a.toString();if("string"===b)return da(a,"javascript");if(null===a)return"null";var c,d,f,b=a instanceof Array;c=[];for(d in a)"function"!==typeof a[d]&&(f=I(a[d]),b?c.push(f):c.push(da(d,
"javascript")+":"+f));a=b?"["+c.join(",")+"]":"{"+c.join(",")+"}";return a}},l=function(a){return x("return "+a)()}):(I=JSON.stringify,l=JSON.parse);e.json={stringify:I,parse:l};var Q=function(a){return a.split("*")},J=function(a){"!"===a.charAt(0)&&(this.negative=!0,a=a.substr(1));var b=a.indexOf("**");-1===b?this.start=a.split("/").map(Q):(0<b&&(e.ASSERT("/"===a.charAt(b-1),"** must be preceded by /"),this.start=a.substr(0,b-1).split("/").map(Q)),b<a.length-2&&(e.ASSERT("/"===a.charAt(b+2),"** must be followed by /"),
this.end=a.substr(b+3).split("/").map(Q).reverse()))},ha=function(a){return a instanceof J?a:new J(a)},ia=function(a){return a instanceof Array?a.map(ha):[ha(a)]},ya=function(a){var b=a.negative;return a.match(this.parts)?(this.result=!b,!1):b?(this.result=!0,!1):!0};J.prototype={constructor:J,negative:!1,start:null,end:null,_matchName:function(a,b){var c=a.length,d,f,e=0;for(d=0;d<c;++d)if(f=a[d])if(e=b.indexOf(f,e),-1===e||0===d&&0<e)return!1;return!f||e+f.length===b.length},match:function(a){var b=
a.length,c=0,d=b-1,f,e,g;if(this.start)for(f=this.start,e=f.length,g=0;g<e;++g)if(this._matchName(f[g],a[c])){if(++c>=b)return g===e-1&&!this.end}else return!1;if(this.end)for(f=this.end,e=f.length,g=0;g<e;++g)if(-1<d&&this._matchName(f[g],a[d])){if(d--<c)return!1}else return!1;return!0}};e.path={match:function(a,b){var c=b;D&&(c=c.toLowerCase().split("\\").join("/"));var d=c.split("/"),c=ia(a),d={parts:d};c.every(ya,d);return d.result||!1},compileMatchPattern:function(a){return ia(a)}};var m=e.Error=
function(){},za=function(a,b,c){var d=function(d){var h=new e.Error,g,k;e.setReadOnlyProperty(h,"code",a);e.setReadOnlyProperty(h,"name",b);if(d){g={};for(k in d)d.hasOwnProperty(k)&&(g["{"+k+"}"]=d[k].toString());d=ca(c,g)}else d=c;e.setReadOnlyProperty(h,"message",d);return h};e.setReadOnlyProperty(d,"CODE",a);e.setReadOnlyProperty(d,"NAME",b);e.setReadOnlyProperty(d,"MESSAGE",c);return d},Aa=0,l=function(a,b){var c,d;for(c in b)b.hasOwnProperty(c)&&(d=++Aa,e.Error["CODE_"+c.toUpperCase()]=d,e.Error[c]=
za(d,c,b[c]))};m.prototype={constructor:m,code:0,name:"Error",message:""};l("boot",{NotImplemented:"Not implemented",Abstract:"Abstract",AssertionFailed:"Assertion failed: {message}"});e.js={keywords:function(){return[].concat(na)}};l("csv",{CsvInvalid:"Invalid CSV syntax (bad quote sequence or missing end of file)"});var ja=function(a,b){for(var c=a.indexOf(b),d=!0;-1<c;){if(c===a.length-1){a=a.substr(0,c);d=!1;break}else if(a.charAt(c+1)===b)a=a.substr(0,c)+a.substr(c+1);else throw e.Error.CsvInvalid();
c=a.indexOf(b,c+1)}return[a,d]},Ba=function(a){var b=a.length-1;return"\r"===a.charAt(b)?a.substr(0,b):a};e.csv={parse:function(a,b){b=b||{};var c=a.split("\n").map(Ba),d=b.header||c.shift(),f;if(!(f=b.separator))a:{f=d;var h,g;for(h=0;4>h;++h)if(g=";,\t ".charAt(h),-1!==f.indexOf(g)){f=g;break a}f=";"}h=f;var k,l,m;g=[];d=d.split(h);for(f=d.length;c.length;){a:{k=c;l=h;m=b.quote||'"';for(var p=[],t=void 0,q=!1,r=void 0,n=void 0,u=void 0,s=void 0,u=void 0;k.length;){t=k.shift();t=t.split(l);q?(r=
!0,t.unshift(p.pop()),n=1):(n=0,r=!1);for(;n<t.length;)u=t[n],q?(s=[t[n-1]],r?s.push("\r\n"):s.push(l),u=ja(u,m),s.push(u[0]),q=u[1],t[n-1]=s.join(""),r=!1,t.splice(n,1)):(0===u.indexOf(m)&&(u=ja(u.substr(1),m),t[n]=u[0],q=u[1]),++n);p=p.concat(t);if(q){if(0===k.length)throw e.Error.CsvInvalid();}else{k=p;break a}}k=void 0}l={};for(m=0;m<f;++m)l[d[m]]=k[m];g.push(l)}return g}};var R=["public","protected","private","static"],S=!0,Ca=0,Da=function(){var a=arguments,b=function(){a[0].apply(this,[b,arguments])};
return b},Ea=function(a,b){return function(){var c=this._super,d;this._super=a;try{d=b.apply(this,arguments)}finally{void 0===c?delete this._super:this._super=c}return d}},G=function(a,b){a+=".";return function(c,d,f){void 0===f&&"object"===typeof d?(f=d,d=a+b):void 0===d&&(d=a+b);-1===c.indexOf(".")&&(c=a+c);return e.define(c,d,f)}},ka={},K=function(a,b,c){this._uid=++Ca;ka[this._uid]=this;this._Subs=[];"function"===typeof a?(this._name="anonymous",this._Constructor=a):(this._name=a,this._Super=
b,this._definition=c,this._build())},v=function(a){var b;b=a._gpf;void 0===b?(b=new K(a),e.setReadOnlyProperty(a,"_gpf",b.uid())):b=ka[b];return b},Fa=function(a,b){if(S){var c=v(a);c._defConstructor?c._defConstructor.apply(this,b):c._Super.apply(this,b)}};K.prototype={constructor:K,_uid:0,uid:function(){return this._uid},_name:"",name:function(){return this._name},nameOnly:function(){var a=this._name,b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)},_Super:Object,Super:function(){return this._Super},
_Subs:[],Subs:function(){return this._Subs},_attributes:null,attributes:function(){this._attributes||(this._attributes=new e.attributes.Map);return this._attributes},_Constructor:function(){},_defConstructor:null,Constructor:function(){return this._Constructor},_definition:null,addMember:function(a,b,c){var d=this._Constructor.prototype;e.ASSERT("constructor"!==a,"No constructor can be added");e.ASSERT(void 0===d[a],"No member can be overridden");void 0===c?c=0:"string"===typeof c&&(c=R.indexOf(c),
-1===c&&(c=0));this._addMember(a,b,c)},_addMember:function(a,b,c){var d=this._Constructor.prototype;3===c?e.setReadOnlyProperty(d.constructor,a,b):d[a]=b},_processMember:function(a,b){var c=this._definition[a],d="constructor"===a,f,h,g;f=typeof c;if(3===b)this._addMember(a,c,3);else{h=d?this._Super:this._Super.prototype[a];g=typeof h;if("undefined"!==g&&null!==h&&f!==g)throw e.Error.ClassMemberOverloadWithTypeChange();if(f="function"===f){if(g="undefined"!==g)a:{var k;g=c.toString().split("._super");
f=g.length;for(k=1;k<f;++k)if(-1==="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".indexOf(g[k].charAt(0))){g=!0;break a}g=!1}f=g}f&&(c=Ea(h,c));d?this._defConstructor=c:this._addMember(a,c,b)}},_processAttribute:function(a){var b,c=this._definition[a];a=a.substr(1,a.length-2);this._attributes||(this._attributes={});b=this._attributes[a];void 0===b&&(b=[]);this._attributes[a]=b.concat(c)},_processDefWithVisibility:function(a){var b=this._definition,c,d;d=R[a];this._definition=c=
b[d];try{for(d in c)if(c.hasOwnProperty(d))if("["===d.charAt(0)&&"]"===d.charAt(d.length-1))this._processAttribute(d);else{if("public"===d||"private"===d||"protected"===d||"static"===d)throw e.Error.ClassInvalidVisibility();this._processMember(d,a)}"wscript"===e.host()&&c.constructor!==Object&&this._processMember("constructor",a)}finally{this._definition=b}},_processDefinition:function(){var a=this._definition,b,c;for(b in a)a.hasOwnProperty(b)&&("["===b.charAt(0)&&"]"===b.charAt(b.length-1)?this._processAttribute(b):
(c=R.indexOf(b),-1===c?(c="_"===b.charAt(0)?1:0,this._processMember(b,c)):this._processDefWithVisibility(c)));"wscript"===e.host()&&a.constructor!==Object&&this._processMember("constructor",0)},_processAttributes:function(){var a=this._attributes,b,c,d;if(a)for(d in delete this._attributes,b=this._Constructor,c=b.prototype,a)a.hasOwnProperty(d)&&(d in c||"Class"===d?e.attributes.add(b,d,a[d]):console.error("gpf.define: Invalid attribute name '"+d+"'"))},_build:function(){var a,b;a=this._name;a=a.substr(a.lastIndexOf(".")+
1);b=Da.toString();var c,d;c=b.indexOf("{")+1;d=b.lastIndexOf("}")-1;b=b.substr(c,d-c+1);a=b.replace("function","function "+a);this._Constructor=a=x(a)(Fa);e.setReadOnlyProperty(a,"_gpf",this._uid);S=!1;b=new this._Super;S=!0;a.prototype=b;b.constructor=a;v(this._Super).Subs().push(a);this._processDefinition();this._processAttributes()}};e.define=function(a,b,c){var d,f;"string"===typeof b?b=e.context(b):"object"===typeof b&&(c=b,b=void 0);void 0===b&&(b=Object);-1<a.indexOf(".")&&(d=a.split("."),
f=d.pop(),d=e.context(d));a=(new K(a,b,c||{})).Constructor();void 0!==d&&(d[f]=a);return a};var r=e.attributes={},T=0,la=function(a,b){b="$"+b;e[b]=function(){var c=x("return function "+b+"(args) {this.constructor.apply(this, args);};")();c.prototype=a.prototype;return function(){return new c(arguments)}}()},Ga=G("gpf.attributes","Attribute"),m=function(a,b,c){var d="$"===a.charAt(0),e;d?(a=a.substr(1),e=a+"Attribute"):e=a;b=Ga(e,b,c);d&&la(b,a);return b};m("Attribute",{"protected":{_member:"",_alterPrototype:function(a){}},
"public":{member:function(){return this._member}}});m("$Alias",{"private":{_name:""},"protected":{_alterPrototype:function(a){la(a.constructor,this._name)}},"public":{constructor:function(a){this._name=a}}});e.define("gpf.attributes.Array",{"private":{_array:[]},"public":{constructor:function(){this._array=[]},length:function(){return this._array.length},get:function(a){var b=this._array;return void 0===a?Array.prototype.slice.call(b,0):0===b.length?void 0:-1===a?b[b.length-1]:-1>a||a>b.length-1?
void 0:b[a]},has:function(a){e.ASSERT("function"===typeof a,"Expected a class parameter");e.ASSERT(a.prototype instanceof r.Attribute,"Expected an Attribute-like class parameter");var b,c=this._array,d=c.length,f;for(b=0;b<d;++b)if(f=c[b],f instanceof a)return f;return null},filter:function(a){e.ASSERT("function"===typeof a,"Expected a class parameter");e.ASSERT(a.prototype instanceof r.Attribute,"Expected an Attribute-like class parameter");var b,c=this._array,d=c.length,f,h=new r.Array,g=h._array;
for(b=0;b<d;++b)f=c[b],f instanceof a&&g.push(f);return h},each:function(a){return $(this._array,a,void 0)}}});e.define("gpf.attributes.Map",{"private":{_members:{},_count:0,_copyTo:function(a,b,c){var d=this._members,e,h,g,k;if(this._count)for(e in d)if(d.hasOwnProperty(e))for(h=d[e]._array,g=0;g<h.length;++g)k=h[g],b&&!b(e,k,c)||a.add(e,k)},_filterCallback:function(a,b,c){return b instanceof c}},"public":{constructor:function(a){this._members={};this._count=0;void 0!==a&&this.fillFromObject(a)},
count:function(){return this._count},add:function(a,b){var c=this._members[a];void 0===c&&(c=this._members[a]=new r.Array);c._array.push(b);++this._count},fillFromObject:function(a){a=v(a.constructor);return this.fillFromClassDef(a)},fillFromClassDef:function(a){for(var b;a;)if((b=a.attributes())&&b._copyTo(this),a=a.Super(),a!==Object)a=v(a);else break;return this._count},filter:function(a){e.ASSERT("function"===typeof a,"Expected a class parameter");e.ASSERT(a.prototype instanceof r.Attribute,"Expected an Attribute-like class parameter");
var b=new r.Map;this._copyTo(b,this._filterCallback,a);return b},member:function(a){a=this._members[a];void 0!==a&&a instanceof r.Array||(0===T&&(T=new r.Array),a=T);return a},members:function(){var a=this._members,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b},each:function(a){return aa(this._members,a,void 0)},addTo:function(a){var b=this._members,c;for(c in b)b.hasOwnProperty(c)&&r.add(a,c,b[c])}}});r.add=function(a,b,c){var d,e,h,g;d=v(a).attributes();e=c.length;for(h=0;h<e;++h)g=
c[h],g._member=b,d.add(b,g),g._alterPrototype(a.prototype)};var Ha=function(){return this._MEMBER_},Ia=function(){var a=this._MEMBER_;0<arguments.length&&(this._MEMBER_=arguments[0]);return a},U=m("ClassAttribute");m("$ClassProperty",U,{"private":{_writeAllowed:!1,_publicName:void 0,_visibility:void 0},"protected":{_alterPrototype:function(a){var b=this._member,c=this._publicName;a=v(a.constructor);var d,e,h;c||(c=b.substr(1));this._writeAllowed?(d=["value"],e=Ia.toString()):(d=[],e=Ha.toString());
e=e.split("_MEMBER_").join(b);b=e.indexOf("{")+1;h=e.lastIndexOf("}")-1;e=e.substr(b,h-b+1);a.addMember(c,x(d,e),this._visibility)}},"public":{constructor:function(a,b,c){a&&(this._writeAllowed=!0);"string"===typeof b&&(this._publicName=b);"string"===typeof c&&(this._visibility=c)}}});m("$ClassEventHandler",U,{});m("$ClassExtension",U,{"private":{_ofClass:A,_publicName:""},"public":{constructor:function(a,b){this._ofClass=a;"string"===typeof b&&(this._publicName=b)}}});l("interfaces",{InterfaceExpected:"Expected interface not implemented: {name}"});
e.interfaces={isImplementedBy:function(a,b){var c,d,e,h;a instanceof Function&&(a=a.prototype);for(c in b.prototype)if("constructor"!==c&&"extend"!==c&&(d=b.prototype[c],e=a[c],h=typeof e,typeof d!==h||"function"===h&&d.length!==e.length))return!1;return!0},query:function(a,b,c){var d=null;if(e.interfaces.isImplementedBy(a,b))return a;e.interfaces.isImplementedBy(a,e.interfaces.IUnknown)&&(d=a.queryInterface(b));void 0===c&&(c=!0);if(null===d&&c)throw e.Error.InterfaceExpected({name:v(b).name()});
return d}};l=G("gpf.interfaces","Interface");l("Interface");l("IEventDispatcher",{addEventListener:function(a,b,c){return this},removeEventListener:function(a,b){return this}});l("IUnknown",{queryInterface:function(a){return null}});m("$InterfaceImplement",{"private":{"[_interfaceDefinition]":[e.$ClassProperty(!1,"which")],_interfaceDefinition:A,"[_builder]":[e.$ClassProperty(!1,"how")],_builder:null},"protected":{_alterPrototype:function(a){var b=this._interfaceDefinition.prototype,c=v(this._interfaceDefinition),
d,f;f=new e.attributes.Map;f.fillFromClassDef(c);f.addTo(a.constructor);if(this._builder)void 0!==a.queryInterface?s!==a.queryInterface&&(a.queryInterface=ma(a.queryInterface)):(a.queryInterface=s,e.attributes.add(a.constructor,"Class",[e.$InterfaceImplement(e.interfaces.IUnknown)]));else for(d in b)d in a||(a[d]=b[d])}},"public":{constructor:function(a,b){this._interfaceDefinition=a;b&&(this._builder=b)}}})});
