!function(e,t){"use strict";if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else if("undefined"!=typeof module&&module.exports)t(module.exports);else{e===undefined&&(e=Function("return this;")());var n={};t(n),e.gpf=n}}(this,function(s){"use strict";function h(){}var r,i,o,a,n,u,e="browser",t="nashorn",c="nodejs",f="phantomjs",l="rhino",p="unknown",d="wscript",_=p,m=Function,v=new m("return this")();function g(t){return{log:function(e){t("    "+e)},info:function(e){t("[?] "+e)},warn:function(e){t("/!\\ "+e)},error:function(e){t("(X) "+e)}}}function y(){"\\"===String(java.lang.System.getProperty("file.separator")),v.console=g(print),function(e){java.lang.System.exit(e)}}"undefined"!=typeof WScript?_=d:"undefined"!=typeof print&&"undefined"!=typeof java?_="undefined"==typeof readFile?t:l:"undefined"!=typeof phantom&&phantom.version&&!document.currentScript?(_=f,v=window):"undefined"!=typeof module&&module.exports?(_=c,v=global):"undefined"!=typeof window&&(_=e,v=window),s.version=function(){return"0.2.6"},e===_&&(function(e){window.location="https://arnaudbuchholz.github.io/gpf/exit.html?"+e},window,document),s.node={},c===_&&(n=require("path"),i=require("fs"),o=require("http"),a=require("https"),u=require("url"),"\\"===n.sep),f===_&&("\\"===require("fs").separator,function(e){phantom.exit(e)},window,document,i=require("fs")),s.java={},s.rhino=s.java,l===_&&y(),t===_&&y(),s.wscript={},d===_&&(!0,r=new ActiveXObject("Scripting.FileSystemObject"),v.console=g(function(e){WScript.Echo(e)})),s.hosts={browser:e,nashorn:t,nodejs:c,phantomjs:f,rhino:l,unknown:p,wscript:d},s.host=function(){return _};var b,w=Array.isArray;function E(e){return w(e)||!!(t=e)&&Math.floor(t.length)===t.length;var t}function x(e,t,n){var r,i=e.length;for(r=0;r<i;++r)t.call(n,e[r],r,e)}function S(e,t,n){for(var r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function P(e,t,n){var r,i,o=e.length;for(i=0;i<o&&!r;++i)r=t.call(n,e[i],i,e);return r}s.isArrayLike=E,b=d===_?function(t,n,r){S(t,n,r),["constructor","toString"].forEach(function(e){t.hasOwnProperty(e)&&n.call(r,t[e],e,t)})}:S,s.forEach=function(e,t,n){E(e)?x(e,t,n):b(e,t,n)};var O=!0;function j(e,t){var n;e||(n=t,O&&console.warn("ASSERTION FAILED: "+n),s.Error.assertionFailed({message:t}))}s.assert=function(e,t){undefined===t&&(e=!(t="Assertion with no message")),j(e,t)},s.asserts=function(e){b(e,j)},s.preventAssertWarnings=function(e){O=!e};var I=/\/\/.*$|\/\*(?:[^\*]*|\*[^\/]*)\*\//gm;function N(e,t){return r=t,0===(n=e).length?m(r):((i=[].concat(n)).push(r),m.apply(null,i));var n,r,i}function T(e,t){return undefined===t&&(t=e,e=[]),N(e,t)}function C(e,t){var n=e;return b(t,function(e,t){n=n.split(t).join(e)}),n}s.web={};var k={};function D(e,t){return n=C(e,k[t]),"javascript"===t?'"'+n+'"':n;var n}function R(n,e){b(e,function(e,t){n[t]===undefined&&(n[t]=e)})}function A(e,t){var n,r,i,o,a=t.on;n=a,(r=t.methods)&&R(n.prototype,r),i=a,(o=t.statics)&&R(i,o)}function $(e,t){v[e]||(v[e]=t)}function F(e,t){return undefined!==t?e.bind(t):e}function M(e,t){for(var n=e.length,r=0;r<n;)e.hasOwnProperty(r)&&t(e[r],r,e),++r}function q(e,t,n){for(var r=e.length;n<r;){if(e.hasOwnProperty(n)&&!0!==t(e[n],n,e))return!1;++n}return!0}function B(e,t){return q(e,t,0)}function U(e){return 0===e?[]:new Array(e).join(" ").split(" ").map(function(e,t){return"p"+t})}function W(e){var r,i,t=U(e);return T(t,(i=["var C = this, l = arguments.length;","if (0 === l) { return new C();}"],(r=t).forEach(function(e,t){var n=t+1;i.push("if ("+n+" === l) { return new C("+r.slice(0,n).join(", ")+");}")}),i.join("\n")))}k.javascript={"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r","\t":"\\t"},k.xml={"&":"&amp;","<":"&lt;",">":"&gt;"},A(0,{on:Array,methods:{every:function(e){return B(this,F(e,arguments[1]))},filter:function(r){var i=[];return r=F(r,arguments[1]),M(this,function(e,t,n){r(e,t,n)&&i.push(e)}),i},forEach:function(e){M(this,F(e,arguments[1]))},indexOf:function(n){var r=-1;return q(this,function(e,t){return e!==n||(r=t,!1)},arguments[1]||0),r},map:function(r){var i=new Array(this.length);return r=F(r,arguments[1]),M(this,function(e,t,n){i[t]=r(e,t,n)}),i},some:function(r){return r=F(r,arguments[1]),!B(this,function(e,t,n){return!r(e,t,n)})},reduce:function(e){var t,n=arguments[1],r=this.length,i=0;for(t=undefined===n?this[i++]:n;i<r;++i)t=e(t,this[i],i,this);return t}},statics:{from:function(e){var t,n,r=(n=[],"string"==typeof(t=e)?function(e,t){var n,r=t.length;for(n=0;n<r;++n)e.push(t.charAt(n))}(n,t):x(t,function(e){n.push(e)},0),n),i=arguments[1];return"function"==typeof i&&(r=r.map(i,arguments[2])),r},isArray:function(e){return"[object Array]"==={}.toString.call(e)}}}),w=Array.isArray;var L=W(10);function V(e){return e<10?"0"+e:e}function H(e){return e.getUTCFullYear()+"-"+V(e.getUTCMonth()+1)+"-"+V(e.getUTCDate())+"T"+V(e.getUTCHours())+":"+V(e.getUTCMinutes())+":"+V(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}A(0,{on:Date,methods:{toISOString:function(){return H(this)}},statics:{now:function(){return(new Date).getTime()}}});var z=/^([0-9][0-9][0-9][0-9])\-([0-9][0-9])\-([0-9][0-9])(?:T([0-9][0-9])\:([0-9][0-9])\:([0-9][0-9])(?:\.([0-9][0-9][0-9])Z)?)?$/;var G=v.Date;function Z(){var e,t,n=function(e){if("string"==typeof e)return z.lastIndex=0,function(e){var t;if(e)return--(t=function(e){var t,n,r,i=[],o=e.length;for(t=1;t<o;++t)n=i,(r=e[t])?n.push(parseInt(r,10)):n.push(0);return i}(e))[1],function(e){if((n=e)[1]<12&&n[2]<32&&(t=e)[3]<24&&t[4]<60&&t[5]<60)return e;var t,n}(t)}(z.exec(e))}(arguments[0]);return n?new G(G.UTC.apply(G.UTC,n)):(e=G,(t=arguments).length>L.length&&(L=W(t.length)),L.apply(e,t))}!function(){var e,t;x(["prototype","UTC","parse","now"],function(e){Z[e]=G[e]});try{e=H(new Date("2003-01-22T22:45:34.075Z")),t=H(new Date("2003-01-22"))}catch(e_){}"2003-01-22T22:45:34.075Z"===e&&"2003-01-22T00:00:00.000Z"===t||(v.Date=Z)}();var Q,J=Array.prototype.slice;function Y(e,t){this[t]=e}function X(e,t,n){var r=!0;function i(t){return function(e){r&&(r=!1,t(e))}}try{e(i(t),i(n))}catch(e_){r&&(r=!1,n(e_))}}function K(){var t=this;t._handlers.forEach(function(e){e.process(t)}),t._handlers=[]}function ee(e){this._state=!1,this._value=e,K.call(this)}A(0,{on:Function,methods:{bind:function(e){var t=J.call(arguments,1);return T(["thisArg","prependArgs","_gpfArrayPrototypeSlice"],"var me = this;\nreturn function ("+U(Math.max(this.length-t.length,0)).join(", ")+") {\n   var args = _gpfArrayPrototypeSlice.call(arguments, 0);\n    return me.apply(thisArg, prependArgs.concat(args));\n};").call(this,e,t,J)}}}),"functionName"!==T("return function functionName () {};")().name?Function.prototype.compatibleName=function(){var e=h.toString.call(this),t=e.indexOf("function"),n=e.indexOf("(",t);return e.substr(t+9,n-t-9).replace(I,"").trim()}:Function.prototype.compatibleName=function(){return this.name},A(0,{on:Object,statics:{assign:function(t,e){return[].slice.call(arguments,1).forEach(function(e){b(e,Y,t)}),t},create:function(){function n(){}return function(e){n.prototype=e;var t=new n;return t.constructor=n,t}}(),getPrototypeOf:function(e){return e.__proto__?e.__proto__:e.constructor.prototype},keys:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},values:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(e[t]);return n}}}),A(0,{on:String,methods:{trim:(Q=/^[\s\ufeff\xa0]+|[\s\ufeff\xa0]+$/g,function(){return this.replace(Q,"")})}});var te=s.Promise=function(t){X(t,function e(t){var n=this;try{if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if("function"==typeof r)return void X(r.bind(t),e.bind(n),ee.bind(n))}n._state=!0,n._value=t,K.call(n)}catch(e_){ee.call(n,e_)}}.bind(this),ee.bind(this))};function ne(){}ne.prototype={onFulfilled:null,onRejected:null,resolve:null,reject:null,process:function(r){var i=this;if(null===r._state)return r.hasOwnProperty("_handlers")||(r._handlers=[]),void r._handlers.push(i);setTimeout(function(){var e,t;if(null!==(e=r._state?i.onFulfilled:i.onRejected)){try{t=e(r._value)}catch(e_){return void i.reject(e_)}i.resolve(t)}else r._state?i.resolve(r._value):i.reject(r._value)},0)}},te.prototype={_state:null,_value:null,_handlers:[],then:function(r,i){var o=this;return new te(function(e,t){var n=new ne;undefined!==r&&(n.onFulfilled=r),undefined!==i&&(n.onRejected=i),n.resolve=e,n.reject=t,n.process(o)})},"catch":function(e){return this.then(null,e)}},te.resolve=function(t){return new te(function(e){e(t)})},te.reject=function(n){return new te(function(e,t){t(n)})},te.all=function(s){return 0===s.length?te.resolve([]):new te(function(i,o){var a=s.length;s.forEach(function t(e,n){try{if(e&&e instanceof te)return void e.then(function(e){t(e,n)},o);s[n]=e,0==--a&&i(s)}catch(e_){o(e_)}})})},te.race=function(e){return new te(function(t,n){e.forEach(function(e){e.then(t,n)})})},$("Promise",te);var re={};function ie(e){java.lang.Thread.sleep(e)}re[d]=function(e){WScript.Sleep(e)},re[l]=ie,re[t]=ie;var oe,ae=[],se=0,ue=re[_]||h;function ce(e,t){return e.dt===t.dt?e.id-t.id:e.dt-t.dt}function fe(e){return e.toString()}function le(e,t){return t?"\n"+t+e.join(",\n"+t)+"\n":e.join(",")}function he(e,t,n){return null===e?"null":(r=t,a=[],o=(i=n)?": ":":",b(e,function(e,t){var n=r(t,e);n=oe[typeof n](e,r,i),undefined!==n&&a.push(D(t,"javascript")+o+n)}),"{"+le(a,i)+"}");var r,i,o,a}function pe(e,t){if(undefined!==e)return e[t]}function de(e,t){var n=e[t];return undefined===n&&(n=e[t]={}),n}function _e(e,t){var n,r,i;return r=t?de:pe,"gpf"===(n=e)[0]?(i=s,n=n.slice(1)):i=v,n.reduce(r,i)}s.handleTimeout=function(){for(var e,t,n=ae;n.length;){for(e=n.shift(),t=(new Date).getTime();e.dt>t;)ue(e.dt-t),t=(new Date).getTime();e.cb()}},$("setTimeout",function(e,t){var n={id:++se,dt:(new Date).getTime()+t,cb:e};return ae.push(n),ae.sort(ce),se}),$("clearTimeout",function(n){var r;ae.every(function(e,t){return e.id!==n||(r=t,!1)})||ae.splice(r,1)}),oe={undefined:h,"function":h,number:fe,"boolean":fe,string:function(e){return D(e,"javascript")},object:function(e,t,n){return w(e)?(r=t,i=n,o=[],x(e,function(e,t){var n=r(t.toString(),e);n=undefined===n?"null":oe[typeof n](n,r,i),o.push(n)}),"["+le(o,i)+"]"):he(e,t,n);var r,i,o}},$("JSON",{parse:function(e,t){var r=T("return "+e)();return t?function n(r,e,i){return"object"==typeof r&&b(r,function(e,t){r[t]=n(e,t,i)}),i(e,r)}(r,"",t):r},stringify:function(e,t,n){return oe[typeof e](e,w(i=t)?function(e,t){if(-1!==i.indexOf(e))return t}:"function"==typeof(o=i)?o:function(e,t){return t},"number"==typeof(r=n)?new Array(Math.min(r,10)+1).join(" "):r||"");var r,i,o}}),s.context=function(e){return undefined===e?v:_e(e.split("."))},k.html=Object.assign({},k.xml,{"\xe0":"&agrave;","\xe1":"&aacute;","\xe8":"&egrave;","\xe9":"&eacute;","\xea":"&ecirc;"});var me=s.Error=function(){};function ve(e,t,n){var r=function(e,t,n){function r(e){this._buildMessage(e)}var i;return r.prototype=new me,Object.assign(r.prototype,{code:e,name:t,message:n}),r.prototype.constructor=r,me[(i=t,i.charAt(0).toUpperCase()+i.substr(1))]=r,function(e){throw new r(e)}}(e,t,n);return r.CODE=e,r.NAME=t,r.MESSAGE=n,r}me.prototype=new Error,Object.assign(me.prototype,{constructor:me,code:0,name:"Error",message:"",_buildMessage:function(e){var n;e&&(n={},b(e,function(e,t){n["{"+t+"}"]=e.toString()}),this.message=C(this.message,n))}});var ge=0;function ye(e,t){b(t,function(e,t){var n=++ge;s.Error["CODE_"+t.toUpperCase()]=n,s.Error[t]=ve(n,t,e)})}function be(e){return e.trim()}function we(e,t){var n,r,i,o,a,s=h.toString.call(e).replace(I,"");n=s,r=t,e.length&&(r.parameters=/\(\s*(\w+(?:\s*,\s*\w+)*)\s*\)/.exec(n)[1].split(",").map(be)),i=s,o=t,(a=be(/{((?:.*\r?\n)*.*)}/.exec(i)[1]))&&(o.body=a)}function Ee(e){var t,n,r={};return t=r,(n=e.compatibleName())&&(t.name=n),we(e,r),r}function xe(e,t){return n="function"+((c=a=e).name?" "+c.name:"")+"("+((u=a).parameters?u.parameters.join(", "):"")+') {\n\t"use strict"\n'+((s=a).body?s.body.toString():"")+"\n}",r=t||{},i=Object.keys(r),o=i.map(function(e){return r[e]}),T(i,"return "+n).apply(null,o);var n,r,i,o,a,s,u,c}ye(0,{notImplemented:"Not implemented",assertionFailed:"Assertion failed: {message}",invalidParameter:"Invalid parameter"}),ye(0,{invalidEntityType:"Invalid entity type"});var Se={};function Pe(e){var t,n,r,i,o=(n=e,b(Se,function(e,t){n["$"+t]&&(r=e)}),r);return o||(i=Se[e.$type],undefined===i&&s.Error.invalidEntityType(),o=i),(t=new o(e)).check(),t}function Oe(e,t){return e.exec(t)}function je(e,t){for(var n,r,i=[],o=(r=t,(n=e).lastIndex=0,Oe(n,r));o;)i.push(o),o=Oe(e,t);return i}function Ie(e){this._initialDefinition=e}function Ne(e){return xe({parameters:U(e),body:"_throw_();"},{_throw_:s.Error.abstractMethod})}function Te(e,t){"$"===t.charAt(0)?this._check$Property(t.substr(1),e):this._checkProperty(t,e)}Ie.prototype={constructor:Ie,_initialDefinition:{}},ye(0,{abstractMethod:"Abstract method"}),ye(0,{invalidEntity$Property:"Invalid entity $ property",missingEntityName:"Missing entity name",invalidEntityNamespace:"Invalid entity namespace"}),Object.assign(Ie.prototype,{_type:"",_allowed$Properties:"type,name,namespace".split(","),_check$Property:function(e,t){var n;e!==this._type&&(n=e,-1===this._allowed$Properties.indexOf(n)&&s.Error.invalidEntity$Property())},_throwInvalidProperty:Ne(0),_reMemberName:/.*/,_checkMemberName:function(e){this._reMemberName.exec(e)||this._throwInvalidProperty()},_reservedNames:"super,class,public,private,protected,static,mixin".split(","),_checkReservedMemberName:function(e){-1!==this._reservedNames.indexOf(e)&&this._throwInvalidProperty()},_checkMemberValue:T(["name","value"]," "),_checkProperty:function(e,t){this._checkMemberName(e),this._checkReservedMemberName(e),this._checkMemberValue(e,t)},_checkProperties:function(){b(this._initialDefinition,Te,this)},_name:"",_readName:function(){var e=this._initialDefinition;this._name=e["$"+this._type]||e.$name},_checkNameIsNotEmpty:function(){this._name||s.Error.missingEntityName()},_throwInvalidName:Ne(0),_reName:/.*/,_checkName:function(){this._reName.exec(this._name)||this._throwInvalidName()},_namespace:"",_extractRelativeNamespaceFromName:function(){var e=/(.*)\.([^\.]+)$/.exec(this._name);if(e)return this._name=e[2],e[1]},_readNamespace:function(){var e=[this._initialDefinition.$namespace,this._extractRelativeNamespaceFromName()].filter(function(e){return e});0<e.length&&(this._namespace=e.join("."))},_checkNamespace:function(){/^(:?[a-z_$][a-zA-Z0-9]+(:?\.[a-z_$][a-zA-Z0-9]+)*)?$/.exec(this._namespace)||s.Error.invalidEntityNamespace()},check:function(){this._checkProperties(),this._readName(),this._checkNameIsNotEmpty(),this._readNamespace(),this._checkName(),this._checkNamespace()}});var Ce=[];function ke(t){var e=P(Ce,function(e){if(e.getInstanceBuilder()===t)return e});return e||(e=P([].concat(Ce).reverse(),function(e){if(t.prototype instanceof e.getInstanceBuilder())return e})),e}function De(e){Ie.call(this,e)}function Re(e){return xe({name:(t=e)._name,parameters:Ee(t._resolvedConstructor).parameters,body:"if (!(this instanceof _classDef_._instanceBuilder)) gpf.Error.classConstructorFunction();\n_classDef_._resolvedConstructor.apply(this, arguments);"},{gpf:s,_classDef_:e});var t}function Ae(){s.Error.invalidClassSuper()}function $e(e){return"function"!=typeof e&&(e=Ae),(n=Ee(t=e)).body="return _superMethod_.apply(this, arguments);",xe(n,{_superMethod_:t});var t,n}function Fe(e,t,n){return"function"!=typeof n&&s.Error.invalidClassSuperMember(),r=e,i=t,(a=Ee(o=n)).body="return _superMethod_.apply(this === _$super_ ? _that_ : this, arguments);",xe(a,{_that_:r,_$super_:i,_superMethod_:o});var r,i,o,a}Object.assign(Ie.prototype,{_instanceBuilder:null,getInstanceBuilder:function(){return this._instanceBuilder||this._setInstanceBuilder(this._build()),this._instanceBuilder},_setInstanceBuilder:function(e){this._namespace&&(_e(this._namespace.split("."),!0)[this._name]=e),this._instanceBuilder=e,Ce.push(this)},_build:h}),De.prototype=Object.create(Ie.prototype),Object.assign(De.prototype,{constructor:De,_type:"class"}),Se["class"]=De,ye(0,{invalidClassName:"Invalid class name",invalidClassProperty:"Invalid class property",invalidClassExtend:"Invalid class extend",invalidClassConstructor:"Invalid class constructor",invalidClassOverride:"Invalid class override"}),Object.assign(De.prototype,{_allowed$Properties:Ie.prototype._allowed$Properties.concat(["extend"]),_throwInvalidProperty:s.Error.invalidClassProperty,_reMemberName:/^[a-z_][a-zA-Z0-9]*$/,_checkConstructorMember:function(e){"function"!=typeof e&&s.Error.invalidClassConstructor()},_checkOverridenMember:function(e,t){typeof e!=typeof t&&s.Error.invalidClassOverride()},_checkIfOverriddenMember:function(e,t){var n=this._extend.prototype[e];undefined!==n&&this._checkOverridenMember(t,n)},_checkMemberValue:function(e,t){"constructor"===e?this._checkConstructorMember(t):this._checkIfOverriddenMember(e,t)},_reName:/^[A-Z_$][a-zA-Z0-9]*$/,_throwInvalidName:s.Error.invalidClassName,_extend:Object,_extendDefinition:undefined,_readExtend:function(){var e,t="string"==typeof(e=this._initialDefinition.$extend)?_e(e.split(".")):e;t&&(this._extend=t,this._extendDefinition=ke(t))},_checkExtendIsNotAnInterface:function(){-1!==h.toString.call(this._extend).indexOf("interfaceConstructorFunction")&&s.Error.invalidClassExtend()},_checkExtend:function(){"function"!=typeof this._extend&&s.Error.invalidClassExtend(),this._checkExtendIsNotAnInterface()},check:function(){this._readExtend(),this._checkExtend(),Ie.prototype.check.call(this)}}),ye(0,{"classConstructorFunction":"This is a class constructor function, use with new"}),Object.assign(De.prototype,{_resolvedConstructor:h}),ye(0,{invalidClassSuper:"Invalid class super",invalidClassSuperMember:"Invalid class super member"});var Me=/\.\$super\.(\w+)\b/g;function qe(e){Ie.call(this,e)}function Be(e){return xe({name:e._name,body:"gpf.Error.interfaceConstructorFunction();"},{gpf:s,_classDef_:e})}function Ue(e){return Pe(e).getInstanceBuilder()}function We(e,i){var o=!0;return b(e.prototype,function(e,t){var n,r;"constructor"!==t&&(n=e,("function"!=typeof(r=i[t])||n.length!==r.length)&&(o=!1))}),o}function Le(e,t){return We(e,t)?t:function(e,t){if(We(s.interfaces.IUnknown,t))return n=e,t.queryInterface(n);var n}(e,t)}function Ve(e){return"string"==typeof e?_e(e.split(".")):e}Object.assign(De.prototype,{_get$Super:function(t,e,n){var r=this._extend.prototype,i=$e(r[e]);return n.forEach(function(e){i[e]=Fe(t,i,r[e])}),i},_superifiedBody:'var _super_;\nif (this.hasOwnProperty("$super")) {\n    _super_ = this.$super;\n}\nthis.$super = _classDef_._get$Super(this, _methodName_, _superMembers_);\ntry{\n    var _result_ = _method_.apply(this, arguments);\n} finally {\n    if (undefined === _super_) {\n        delete this.$super;\n    } else {\n        this.$super = _super_;\n    }\n}\nreturn _result_;',_getSuperifiedContext:function(e,t,n){return{_method_:e,_methodName_:t,_superMembers_:n,_classDef_:this}},_createSuperified:function(e,t,n){var r=Ee(e);return r.body=this._superifiedBody,xe(r,this._getSuperifiedContext(e,t,n))},_superify:function(e,t){return /\.\$super\b/.exec(e)?this._createSuperified(e,t,je(Me,e).map(function(e){return e[1]})):e}}),Object.assign(De.prototype,{_build:function(){var e,t;return this._resolveConstructor(),e=Re(this),t=Object.create(this._extend.prototype),(e.prototype=t).constructor=e,this._buildPrototype(t),e},_addMethodToPrototype:function(e,t,n){e[t]=this._superify(n,t)},_addMemberToPrototype:function(e,t,n){"function"==typeof n?this._addMethodToPrototype(e,t,n):e[t]=n},_buildPrototype:function(n){b(this._initialDefinition,function(e,t){"$"!==t.charAt(0)&&"constructor"!==t&&this._addMemberToPrototype(n,t,e)},this)},_setResolvedConstructorToInherited:function(){this._extend!==Object&&(this._resolvedConstructor=this._extend)},_resolveConstructor:function(){this._initialDefinition.hasOwnProperty("constructor")?this._resolvedConstructor=this._superify(this._initialDefinition.constructor,"constructor"):this._setResolvedConstructorToInherited()}}),qe.prototype=Object.create(Ie.prototype),Object.assign(qe.prototype,{constructor:qe,_type:"interface"}),Se["interface"]=qe,ye(0,{invalidInterfaceName:"Invalid interface name",invalidInterfaceProperty:"Invalid interface property"}),Object.assign(qe.prototype,{_throwInvalidProperty:s.Error.invalidInterfaceProperty,_reMemberName:/^[a-z][a-zA-Z0-9]*$/,_reservedNames:Ie.prototype._reservedNames.concat("constructor"),_checkMemberValue:function(e,t){"function"!=typeof t&&s.Error.invalidInterfaceProperty()},_reName:/^I[a-zA-Z0-9]*$/,_throwInvalidName:s.Error.invalidInterfaceName}),ye(0,{"interfaceConstructorFunction":"This is an interface constructor function, do not invoke"}),Object.assign(qe.prototype,{_build:function(){var e,t;return delete(t=(e=Be(this)).prototype).constructor,this._buildPrototype(t),e},_buildPrototype:function(n){b(this._initialDefinition,function(e,t){"$"!==t.charAt(0)&&(n[t]=e)},this)}}),s.define=Ue,ye(0,{interfaceExpected:"Expected interface not implemented: {name}"});var He;s.interfaces={isImplementedBy:function(e,t){return!!t&&We(Ve(e),(n=t)instanceof Function?n.prototype:n);var n},query:function(e,t){return Le(Ve(e),t)}};function ze(e,t){var n={$interface:"gpf.interfaces.I"+e};return Object.keys(t).forEach(function(e){n[e]=Ne(t[e])}),Ue(n)}function Ge(e,t){var n,r,i,o,a;return!1===e.ascending?(n="b"+t,r="a"+t):(n="a"+t,r="b"+t),"if("+n+"!=="+r+")return "+(i=e.type,o=n,a=r,"string"===i?o+".localeCompare("+a+")":o+"-"+a)+";"}function Ze(e){return T(["a","b"],"var "+(t=e).map(function(e,t){return"a"+t+"=a."+e.property+",b"+t+"=b."+e.property}).join(",")+";"+t.map(Ge).join("")+"return 0;");var t}function Qe(t,n){return function(e){return"("+e[t].map(He).join(n)+")"}}ze("Unknown",{"queryInterface":1}),s.createSortFunction=function(e){return w(e)||(e=[e]),Ze(e)};var Je={property:function(e){return"i."+e.property},eq:Qe("eq","==="),ne:Qe("ne","!=="),lt:Qe("lt","<"),lte:Qe("lte","<="),gt:Qe("gt",">"),gte:Qe("gte",">="),not:function(e){return"!"+He(e.not)},like:function(e){var t,n="/"+(t=e).regexp+"/.exec("+He(t.like)+")";return e.group?"("+n+"||[])["+e.group+"]":n},or:Qe("or","||"),and:Qe("and","&&"),undefined:function(e){return JSON.stringify(e)}},Ye=Object.keys(Je);He=function(e){var t=function(e){if("object"==typeof e)return Object.keys(e).filter(function(e){return-1<Ye.indexOf(e)})[0]}(e);return(0,Je[t])(e)},s.createFilterFunction=function(e){return T(["i"],"return "+He(e))};var Xe=ze("ReadableStream",{"read":1}),Ke=ze("WritableStream",{"write":1});function et(e,t,n){return e||s.Error.interfaceExpected({name:n}),r=n,(i=Le(t,e))||s.Error.interfaceExpected({name:r}),i;var r,i}function tt(e){return et(e,Xe,"gpf.interfaces.IReadableStream")}function nt(e){return et(e,Ke,"gpf.interfaces.IWritableStream")}ze("Enumerator",{"reset":0,"moveNext":0,"getCurrent":0}),ze("FileStorage",{"getInfo":1,"openTextStream":2,"close":1,"explore":1,"createDirectory":1,"deleteFile":1,"deleteDirectory":1}),ye(0,{readInProgress:"A read operation is already in progress",writeInProgress:"A write operation is already in progress",invalidStreamState:"Stream is in an invalid state"}),s.stream={};var rt="gpf.stream#progress",it=rt+"/read",ot=rt+"/write";function at(e){e.prototype[it]=!1,e.prototype[ot]=!1}function st(e){e[it]=!1}function ut(e){e[ot]=!1}function ct(i){return function(e){var t,n=this,r=nt(e);return(t=n)[it]&&s.Error.readInProgress(),t[it]=!0,i.call(n,r).then(function(e){return st(n),Promise.resolve(e)},function(e){return st(n),Promise.reject(e)})}}function ft(r){return function(e){var t,n=this;return(t=n)[ot]&&s.Error.writeInProgress(),t[ot]=!0,r.call(n,e).then(function(e){return ut(n),Promise.resolve(e)},function(e){return ut(n),Promise.reject(e)})}}var lt=Ue({$class:"gpf.stream.ReadableString",constructor:function(e){this._buffer=e},read:ct(function(e){return e.write(this._buffer)}),_buffer:""}),ht=Ue({$class:"gpf.stream.WritableString",constructor:function(){this._buffer=[]},write:ft(function(e){return this._buffer.push(e.toString()),Promise.resolve()}),toString:function(){return this._buffer.join("")},_buffer:[]});at(lt),at(ht),ye(0,{incompatibleStream:"Incompatible stream"});var pt={NOT_FOUND:0,DIRECTORY:1,FILE:2,UNKNOWN:3},dt=0,_t=1,mt=null;function vt(e,t){e===_&&(mt=new t)}function gt(e){e.length?e.pop():s.Error.unreachablePath()}function yt(e){var t,n,r=-1<(t=e).indexOf("\\")?t.toLowerCase().split("\\"):t.split("/");return(n=r)[n.length-1]||n.pop(),r}function bt(e){return yt(e).join("/")}function wt(e){return e?yt(e).pop():""}function Et(e){var t=wt(e),n=t.lastIndexOf(".");return-1===n?"":t.substr(n)}s.fs={types:{notFound:pt.NOT_FOUND,directory:pt.DIRECTORY,file:pt.FILE,unknown:pt.UNKNOWN},openFor:{reading:dt,appending:_t},getFileStorage:function(){return mt}},ye(0,{unreachablePath:"Unreachable path"});var xt={"":function(e){e.length=0,e.push("")},".":h,"..":function(e){gt(e)}};function St(e){var t=yt(e);return[].slice.call(arguments,1).forEach(function(n,e){x(yt(e),function(e){var t=xt[e];t?t(n):n.push(e)})}.bind(null,t)),t.join("/")}function Pt(e){return gt(e=yt(e)),e.join("/")}function Ot(e,t){var n,r=-1;return{reset:function(){return r=-1,Promise.resolve()},moveNext:function(){return++r,n=undefined,r<t.length?e.getInfo(t[r]).then(function(e){return n=e}):Promise.resolve()},getCurrent:function(){return n}}}var jt=Ue({$class:"gpf.node.BaseStream",constructor:function(e,t){this._stream=e,"function"==typeof t&&(this._close=t),e.on("error",this._onError.bind(this))},_close:h,close:function(){return this._close()},_stream:null,_invalid:!(s.path={join:St,parent:Pt,name:wt,nameOnly:function(e){var t=wt(e),n=t.lastIndexOf(".");return-1===n?t:t.substr(0,n)},extension:Et,relative:function(e,t){var n,r,i,o=yt(e),a=yt(t);for(i=a,(r=o).length*i.length&&function(e,t){for(;e[0]===t[0];)e.shift(),t.shift()}(r,i),n=o.length+1;--n;)a.unshift("..");return a.join("/")}}),_reject:s.Error.invalidStreamState,_checkIfValid:function(){this._invalid&&s.Error.invalidStreamState()},_onError:function(e){this._invalid=!0,this._reject(e)}}),It=Ue({$class:"gpf.node.ReadableStream",$extend:"gpf.node.BaseStream",read:ct(function(n){var r=this,i=r._stream;return new Promise(function(e,t){r._reject=t,r._checkIfValid(),i.on("data",r._onData.bind(r,n)).on("end",function(){r._invalid=!0,e()})})}),_onData:function(e,t){var n=this._stream;n.pause(),e.write(t).then(function(){n.resume()},this._reject)}}),Nt=Ue({$class:"gpf.node.WritableStream",$extend:"gpf.node.BaseStream",write:ft(function(n){var r=this,i=r._stream;return new Promise(function(e,t){if(r._reject=t,r._checkIfValid(),i.write(n))return e();i.once("drain",e)})})});function Tt(e,t){return new Promise(function(n,r){i[e].apply(i,t.concat([function(e,t){e?r(e):n(t)}]))})}function Ct(e,t){return Tt(e,[bt(t)])}function kt(e,t){return Tt("open",[bt(e),t.flags]).then(function(e){return new t.GpfStream(i[t.nodeStream]("",{fd:e,autoClose:!1}),Tt.bind(null,"close",[e]))})}function Dt(e){return e.isDirectory()?pt.DIRECTORY:e.isFile()?pt.FILE:pt.UNKNOWN}vt(c,Ue({$class:"gpf.node.FileStorage",getInfo:function(t){return t=bt(t),new Promise(function(e){i.exists(t,e)}).then(function(e){return e?Ct("stat",t).then(function(e){return{fileName:n.basename(t),filePath:bt(n.resolve(t)),size:e.size,createdDateTime:e.ctime,modifiedDateTime:e.mtime,type:Dt(e)}}):{type:pt.NOT_FOUND}})},openTextStream:function(e,t){return dt===t?kt(e,{flags:"r",GpfStream:It,nodeStream:"createReadStream"}):kt(e,{flags:"a",GpfStream:Nt,nodeStream:"createWriteStream"})},close:function(e){return e instanceof jt?e.close():Promise.reject(new s.Error.IncompatibleStream)},explore:function(t){var n=this;return Ct("readdir",t).then(function(e){return Ot(n,e.map(function(e){return St(t,e)}))})},createDirectory:Ct.bind(null,"mkdir"),deleteFile:Ct.bind(null,"unlink"),deleteDirectory:Ct.bind(null,"rmdir")}));var Rt=Ue({$class:"gpf.wscript.BaseStream",constructor:function(e){this._file=e},close:function(){return new Promise(function(e){this._file.Close(),e()}.bind(this))}}),At=Ue({$class:"gpf.wscript.ReadableStream",$extend:"gpf.wscript.BaseStream",read:ct(function(n){var r=this._file;return new Promise(function(t){return function e(){return n.write(r.Read(4096)).then(function(){if(!r.AtEndOfStream)return e()})}().then(t)})})}),$t=Ue({$class:"gpf.wscript.WritableStream",$extend:"gpf.wscript.BaseStream",write:ft(function(t){var n=this._file;return new Promise(function(e){n.Write(t),e()})})});function Ft(e,t){return{type:t,fileName:e.Name.toLowerCase(),filePath:bt(e.Path),size:e.Size,createdDateTime:new Date(e.DateCreated),modifiedDateTime:new Date(e.DateLastModified)}}function Mt(t,n){return new Promise(function(e){r[t](yt(n).join("\\"),!0),e()})}function qt(e){return r.FolderExists(e)?Ft(r.GetFolder(e),pt.DIRECTORY):(t=e,r.FileExists(t)?Ft(r.GetFile(t),pt.FILE):{type:pt.NOT_FOUND});var t}function Bt(e){for(var t=new Enumerator(e),n=[];!t.atEnd();t.moveNext())n.push(t.item().Path);return n}ye(0,{pathNotExplorable:"Path not explorable"}),vt(d,Ue({$class:"gpf.wscript.FileStorage",getInfo:function(e){return Promise.resolve(qt(yt(e).join("\\")))},openTextStream:function(t,n){return t=yt(t).join("\\"),new Promise(function(e){e(dt===n?new At(r.OpenTextFile(t,1,!1)):new $t(r.OpenTextFile(t,8,!0)))})},close:function(e){return e instanceof Rt?e.close():Promise.reject(new s.Error.IncompatibleStream)},explore:function(t){var n=this;return new Promise(function(e){e(Ot(n,function(e){var t;if(r.FolderExists(e))return Bt((t=r.GetFolder(e)).SubFolders).concat(Bt(t.Files));s.Error.pathNotExplorable()}(yt(t).join("\\"))))})},createDirectory:function(t,n){return new Promise(function(e){r[t](yt(n).join("\\")),e()})}.bind(null,"CreateFolder"),deleteFile:Mt.bind(null,"DeleteFile"),deleteDirectory:Mt.bind(null,"DeleteFolder")}));var Ut=Object.prototype.toString;function Wt(e){return e instanceof Object&&"[object Object]"===Ut.call(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}s.isLiteralObject=Wt,ye(0,{missingNodeName:"Missing node name",unknownNamespacePrefix:"Unknown namespace prefix",unableToUseNamespaceInString:"Unable to use namespace in string"});var Lt={"className":"class"},Vt={"svg":"http://www.w3.org/2000/svg","xlink":"http://www.w3.org/1999/xlink"};function Ht(e){var t,n,r=e.split(":");if(2===r.length)return{namespace:(t=r[0],n=Vt[t],undefined===n&&s.Error.unknownNamespacePrefix(),n),name:r[1]}}function zt(e){-1!==e.indexOf(":")&&s.Error.unableToUseNamespaceInString()}function Gt(e){return Lt[e]||e}function Zt(e,t){e.forEach(function(e){w(e)?Zt(e,t):t(e)})}var Qt=Ue({$class:"gpf.web.Tag",constructor:function(e,t,n){this._nodeName=e,this._attributes=t||{},this._children=n},_nodeName:"",_attributes:{},_children:[],_getAttributesAsString:function(){return Object.keys(this._attributes).map(function(e){return zt(e)," "+Gt(e)+'="'+D(this._attributes[e],"html")+'"'},this).join("")},_getChildrenAsString:function(){var t=[];return Zt(this._children,function(e){t.push(e.toString())}),t.join("")},_getClosingString:function(){return this._children.length?">"+this._getChildrenAsString()+"</"+this._nodeName+">":"/>"},toString:function(){return zt(this._nodeName),"<"+this._nodeName+this._getAttributesAsString()+this._getClosingString()},_createElement:function(e){var t=e.ownerDocument,n=Ht(this._nodeName);return n?t.createElementNS(n.namespace,n.name):t.createElement(this._nodeName)},_setAttributesTo:function(r){b(this._attributes,function(e,t){var n=Ht(t);n?r.setAttributeNS(n.namespace,Gt(n.name),e):r.setAttribute(Gt(t),e)})},_appendChildrenTo:function(t){var n=t.ownerDocument;Zt(this._children,function(e){e instanceof Qt?e.appendTo(t):t.appendChild(n.createTextNode(e.toString()))})},appendTo:function(e){var t=this._createElement(e);return this._setAttributesTo(t),this._appendChildrenTo(t),e.appendChild(t)}});s.web.createTagFunction=function(r){return r||s.Error.missingNodeName(),function(e){var t,n;return Wt(e)?(n=e,t=1):t=0,new Qt(r,n,[].slice.call(arguments,t))}},s.http={};var Jt={GET:"GET",POST:"POST",PUT:"PUT",OPTIONS:"OPTIONS",DELETE:"DELETE",HEAD:"HEAD"},Yt=/([^:\s]+)\s*: ?([^\r]*)/gm;function Xt(e){var t={};return x(je(Yt,e),function(e){t[e[1]]=e[2]}),t}function Kt(r){return function(t,n){n&&Object.keys(n).forEach(function(e){t[r](e,n[e])})}}function en(n){return function(e,t){t?e[n](t):e[n]()}}var tn;ze("Thenable",{"then":2});function nn(e){return s.interfaces.isImplementedBy(s.interfaces.IThenable,e)?e:Promise.resolve(e)}function rn(e,t){var n=tn;return e===_&&(tn=t),n}function on(n){return new Promise(function(e,t){tn(n,e,t)})}function an(e,t,n){return on("string"==typeof t?{method:e,url:t,data:n}:Object.assign({method:e},t))}s.promisify=nn,s.promisifyDefined=function(e){if(undefined!==e)return nn(e)},Object.assign(s.http,{methods:{get:Jt.GET,post:Jt.POST,put:Jt.PUT,options:Jt.OPTIONS,"delete":Jt.DELETE,head:Jt.HEAD},request:on,get:an.bind(s.http,Jt.GET),post:an.bind(s.http,Jt.POST),put:an.bind(s.http,Jt.PUT),options:an.bind(s.http,Jt.OPTIONS),"delete":an.bind(s.http,Jt.DELETE),head:an.bind(s.http,Jt.HEAD)});var sn=Kt("setRequestHeader"),un=en("send");function cn(e,t){var n,r,i,o,a=(n=e,(r=new XMLHttpRequest).open(n.method,n.url),r);sn(a,e.headers),o=function(){t({status:a.status,headers:Xt(a.getAllResponseHeaders()),responseText:a.responseText})},(i=a).onreadystatechange=function(){4===i.readyState&&o()},un(a,e.data)}function fn(e){var t=new ht;return tt(e).read(t).then(function(){return t.toString()})}function ln(e){var t,n,r=Object.assign(u.parse(e.url),e);return t=r,(n=e.data)&&(t.headers=Object.assign({"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(n)},t.headers)),r}function hn(e,t){var n=ln(e);return("https:"===n.protocol?a:o).request(n,function(e){!function(t,n){t.setEncoding("utf8");var r=new It(t);fn(r).then(function(e){r.close(),n({status:t.statusCode,headers:t.headers,responseText:e})})}(e,t)})}rn(e,cn),rn(f,cn),rn(c,function(e,t,n){var r,i,o=hn(e,t);o.on("error",n),r=o,(i=e.data)?r.write(i,"utf8",function(){r.end()}):r.end()});var pn=Kt("setRequestHeader"),dn=en("Send");rn(d,function(e,t){var n,r,i,o=(n=e,(r=new ActiveXObject("WinHttp.WinHttpRequest.5.1")).Open(n.method,n.url),r);pn(o,e.headers),dn(o,e.data),t({status:(i=o).Status,headers:Xt(i.GetAllResponseHeaders()),responseText:i.ResponseText})});var _n=Ue({$class:"gpf.java.BaseStream",constructor:function(e){this._stream=e},close:function(){return this._stream.close(),Promise.resolve()},_stream:null}),mn=Ue({$class:"gpf.java.ReadableStream",$extend:_n,_handleError:function(e){return e instanceof java.util.NoSuchElementException||0===e.message.indexOf("java.util.NoSuchElementException")?Promise.resolve():Promise.reject(e)},read:ct(function(e){try{var t=new java.util.Scanner(this._stream);return e.write(String(t.useDelimiter("\\A").next()))}catch(e_){return this._handleError(e_)}})}),vn=Ue({$class:"gpf.java.WritableStream",$extend:_n,constructor:function(e){this.$super(e),this._writer=new java.io.OutputStreamWriter(e)},write:ft(function(e){var t=this._writer;return t.write(e),t.flush(),Promise.resolve()}),close:function(){return this._writer.close(),this.$super()},_writer:null}),gn=Kt("setRequestProperty");function yn(i,o){var e,t;(e=i,t=new mn(function(e){try{return e.getInputStream()}catch(e_){return e.getErrorStream()}}(e)),fn(t).then(function(e){return t.close(),e})).then(function(e){var t,n,r;o({status:i.getResponseCode(),headers:(t=i,n={},r=t.getHeaderFields(),x(r.keySet().toArray(),function(e){n[String(e)]=String(r.get(e).get(0))}),n),responseText:e})})}function bn(e,t){var n=new java.net.URL(e.url).openConnection();n.setRequestMethod(e.method),gn(n,e.headers),function(e,t){if(t){e.setDoOutput(!0);var n=new vn(e.getOutputStream());return n.write(t).then(function(){n.close()})}return Promise.resolve()}(n,e.data).then(function(){yn(n,t)})}rn(l,bn),rn(t,bn);var wn={};function En(e){return t=wn[e.method],n=e,t.every(function(e){return(r=function(e,t){var n,r=e.url;if(r.lastIndex=0,n=r.exec(t.url))return e.response.apply(e,[t].concat([].slice.call(n,1)))}(e,n))===undefined}),r;var t,n,r}var xn,Sn=0;function Pn(){Object.keys(Jt).forEach(function(e){wn[e]=[]})}function On(){}Pn(),s.http.mock=function(e){var t,n=e.method;return t=n+"."+ ++Sn,wn[n].unshift(Object.assign({id:t},e)),t},s.http.mock.remove=function(t){var e=t.split(".")[0];wn[e]=wn[e].filter(function(e){return e.id!==t})},s.http.mock.reset=Pn,xn=rn(_,function(e,t,n){var r=En(e);undefined===r?xn(e,t,n):t(r)}),On.prototype={execute:h};var jn=new On,In=new On;jn.execute=function(e){e._readReject(e._readBuffer.shift())},In.execute=function(e){e._readResolve()};var Nn=Ue({$class:"gpf.stream.BufferedRead",constructor:function(){this._readBuffer=[]},_readBuffer:[],_readWriteToStream:null,_readResolve:null,_readReject:null,_readDataIsToken:function(e){return e instanceof On&&(e.execute(this),!0)},_readWriteToOutput:function(){var e=this,t=e._readBuffer.shift();return e._readDataIsToken(t)?Promise.resolve():e._readWriteToStream.write(t).then(function(){if(e._readBuffer.length)return e._readWriteToOutput();e._readNotWriting=!0})},_readNotWriting:!0,_readSafeWrite:function(){var t=this;t._readNotWriting&&(t._readNotWriting=!1,t._readWriteToOutput().then(undefined,function(e){t._readReject(e)}))},_readCheckIfData:function(){this._readBuffer.length&&this._readSafeWrite()},_readCheckIfOutput:function(){this._readWriteToStream&&this._readCheckIfData()},_appendToReadBuffer:function(e){return this._readBuffer=this._readBuffer.concat([].slice.call(arguments)),this._readCheckIfOutput(),this},_completeReadBuffer:function(){this._readBuffer.push(In),this._readCheckIfOutput()},_setReadError:function(e){this._readBuffer.push(jn,e),this._readCheckIfOutput()},read:ct(function(e){var n=this;return n._readWriteToStream=e,n._readCheckIfData(),new Promise(function(e,t){n._readResolve=e,n._readReject=t})})});at(Nn);var Tn=/\r\n/g,Cn=(Ue({$class:"gpf.stream.LineAdapter",$extend:Nn,constructor:function(){this.$super(),this._buffer=[]},write:ft(function(e){return this._buffer.push(e.toString()),this._process(),Promise.resolve()}),flush:function(){return this._buffer.length&&(this._buffer.push("\n"),this._process()),this._completeReadBuffer(),Promise.resolve()},_buffer:[],_consolidateLines:function(){return this._buffer.join("").replace(Tn,"\n").split("\n")},_pushBackLastLineIfNotEmpty:function(e){var t=e.pop();t.length&&this._buffer.push(t)},_process:function(){var t=this,e=t._consolidateLines();t._buffer.length=0,t._pushBackLastLineIfNotEmpty(e),x(e,function(e){t._appendToReadBuffer(e)})}}),ze("FlushableStream",{"flush":0})),kn={};function Dn(e,t){e===_&&(kn=t)}function Rn(e){return kn(e)}s.read=Rn,s.fs&&(s.fs.read=Rn),Dn(e,function(e){return on({method:Jt.GET,url:e}).then(function(e){if(2!==Math.floor(e.status/100))throw new Error(e.responseText);return e.responseText})}),Dn(t,function(e){var o=java.nio.file.Paths.get(e);return java.nio.file.Files.exists(o)?new Promise(function(e,t){var n=java.nio.file.Files.newInputStream(o),r=new mn(n),i=new ht;return r.read(i).then(function(){e(i.toString())})["catch"](t)}):Promise.reject(new Error("File not found"))}),Dn(c,function(e){return new Promise(function(n,r){i.readFile(e,function(e,t){e?r(e):n(t.toString())})})}),Dn(f,function(r){return new Promise(function(e,t){try{e(i.read(r))}catch(e_){t(new Error(e_))}})}),Dn(l,function(t){return new Promise(function(e){e(readFile(t))})}),Dn(d,function(n){return new Promise(function(e){var t=r.OpenTextFile(n,1,!1);e(t.ReadAll()),t.Close()})});var An={};function $n(e,t){return n={gpf:Object.create(s),promise:Promise.resolve(),_initialDefine:null},r=Hn(e,{base:Pt(t)}),n._initialDefine=r.define,r.define=function(){var e=this.gpf.require,t=this._initialDefine;return this.promise=t.apply(e,arguments),e.define=t,this.promise}.bind(n),n.gpf.require=r,n;var n,r}An[".json"]=function(e,t){return JSON.parse(t)},ye(0,{noCommonJSDynamicRequire:"Dynamic require not supported"});var Fn=/[^.]\brequire\b\s*\(\s*(?:['|"]([^"']+)['|"]|[^)]+)\s*\)/g;var Mn,qn=[null,function(e){return{dependencies:[],factory:e[0]}},function(e){return{dependencies:e[0],factory:e[1]}},function(e){return{dependencies:e[1],factory:e[2]}}];function Bn(e,t,n){var r={};return T(["gpf","define","module","require"],t)(e,function(e,t,n){var r=qn[arguments.length](arguments);this.require.define(r.dependencies,function(e){return e.length=r.dependencies.length,r.factory.apply(null,[].slice.call(e))})}.bind(e),r,function(e){return n[e]||s.Error.noCommonJSDynamicRequire()}),r.exports}function Un(e){return"clearCache"===e?-1:1}Mn=e===_?function(e,t){return"//# sourceURL="+location.origin+St(location.pathname,e)+"?gpf.require\n"+t}:function(e,t){return t},An[".js"]=function(n,r){var i=$n(this,n);return function(e,t){var n=je(Fn,t);return n.length?$n(this,e).gpf.require.define(n.map(function(e){return e[1]}).filter(function(e){return e}).reduce(function(e,t){return e[t]=t,e},{}),function(e){return e}):Promise.resolve({})}.call(this,n,r).then(function(e){var t=Bn(i.gpf,Mn(n,r),e);return undefined===t?i.promise:t})},ye(0,{invalidRequireConfigureOption:"Invalid configuration option"});var Wn={base:function(e){this.base=e},cache:function(t){x(Object.keys(t),function(e){this.cache[e]=Promise.resolve(t[e])},this)},clearCache:function(){this.cache={}}};function Ln(e){return St(this.base,e)}function Vn(r){var e;return this.cache[r]?this.cache[r]:(e=function(n){var r=this;return Rn(n).then(function(e){var t=An[Et(n).toLowerCase()];return t?t.call(r,n,e):e})}.call(this,r),(this.cache[r]=e)["catch"](function(e){var t,n;return t=e,n=r,Array.isArray(t.requires)||(t.requires=[]),t.requires.push(n),Promise.reject(e)}))}function Hn(e,t){var n=Object.create(e),r={};return r.define=function(t,i){var n=this,r=[],o=Object.keys(t);return x(o,function(e){r.push(Vn.call(n,Ln.call(n,t[e])))},n),Promise.all(r).then(function(n){var e,r;return"function"==typeof i?(r={},x(o,function(e,t){r[e]=n[t]}),e=i(r)):e=i,e})}.bind(n),r.resolve=Ln.bind(n),r.configure=function(t){var n=this;x(Object.keys(t).sort(function(e,t){return Un(e)-Un(t)}),function(e){(Wn[e]||s.Error.invalidRequireConfigureOption).call(n,t[e])},n)}.bind(n),t&&r.configure(t),r}s.require=Hn({base:"",cache:{}});var zn=Ue({$class:"gpf.stream.ReadableArray",constructor:function(e){this._buffer=e},read:ct(function(t){var n=this._buffer,r=0;return function e(){return n.length===r?Promise.resolve():t.write(n[r++]).then(e)}()}),_buffer:[]}),Gn=Ue({$class:"gpf.stream.WritableArray",constructor:function(){this._buffer=[]},write:ft(function(e){return this._buffer.push(e),Promise.resolve()}),toArray:function(){return this._buffer},_buffer:[]});at(zn),at(Gn);var Zn={flush:Promise.resolve.bind(Promise)};function Qn(e){return Le(Cn,e)||Zn}function Jn(e,t){var n,r=tt(e),i=nt(e),o=Qn(e),a=nt(t),s=Qn(t),u=!0,c=h;function f(){if(u)try{u=!1,r.read(a).then(function(){u=!0},function(e){c(n=e)})}catch(e_){n=e_}}function l(){if(n)return Promise.reject(n)}return f(),{flush:function(){return l()||o.flush().then(function(){return s.flush()})},write:function(e){return f(),l()||(n=i.write(e),new Promise(function(t,e){n.then(function(e){t(e),c=h},e),c=e}));var n}}}function Yn(e){return 1<e.length?function(e){for(var t=e.length-1,n=e[t];0<t;)n=Jn(e[--t],n);return n}(e):nt(e[0])}s.stream.pipe=function(e,t){var n=tt(e),r=Yn([].slice.call(arguments,1)),i=Qn(r);try{return n.read(r).then(function(){return i.flush()})}catch(e_){return Promise.reject(e_)}},k.regexp={"\\":"\\\\","-":"\\-","[":"\\[","]":"\\]","/":"\\/","{":"\\{","}":"\\}","(":"\\(",")":"\\)","*":"\\*","+":"\\+","?":"\\?",".":"\\.","^":"\\^","$":"\\$","|":"\\|"},ye(0,{invalidCSV:"Invalid CSV syntax (bad quote sequence or missing end of file)"}),s.stream.csv={};var Xn=";,\t ".split("");Ue({$class:"gpf.stream.csv.Parser",$extend:Nn,constructor:function(e){this._readParserOptions(e),this._header?this._parseHeader():this._write=this._writeHeader},_readParserOptions:function(t){var n=this;t&&x(["header","separator","quote","newLine"],function(e){t[e]&&(n["_"+e]=t[e])})},_header:"",_separator:"",_deduceSeparator:function(){var t=this._header;this._separator=P(Xn,function(e){if(-1!==t.indexOf(e))return e})||Xn[0]},_quote:'"',_newLine:"\n",_columns:[],_buildParsingHelpers:function(){this._unescapeDictionary={},this._unescapeDictionary[this._quote+this._quote]=this._quote,this._parser=new RegExp(C("^(?:([^QS][^S]*)|Q((?:[^Q]|QQ)+)Q)(?=$|S)",{Q:D(this._quote,"regexp"),S:D(this._separator,"regexp")}))},_parseHeader:function(){this._separator||this._deduceSeparator(),this._columns=this._header.split(this._separator),this._buildParsingHelpers(),this._write=this._writeContent},_writeHeader:function(e){this._header=e,this._parseHeader()},_values:[],_content:"",_unescapeQuoted:function(e){return C(e,this._unescapeDictionary)},_addValue:function(e){e[1]?this._values.push(e[1]):this._values.push(this._unescapeQuoted(e[2]))},_nextValue:function(e){return this._content=this._content.substr(e),0<this._content.length},_checkAfterValue:function(e){return this._content.charAt(e[0].length)?this._nextValue(e[0].length+1):(delete this._content,!1)},_extractValue:function(){var e=this._parser.exec(this._content);return!!e&&(this._addValue(e),this._checkAfterValue(e))},_checkForValue:function(){return this._content.charAt(0)===this._separator?(this._values.push(""),this._nextValue(1)):this._extractValue()},_parseValues:function(){for(;this._checkForValue(););},_parseContent:function(){if(this._parseValues(),!this._content)return this._values},_processContent:function(e){return this._content?this._content=this._content+this._newLine+e:(this._values=[],this._content=e),this._parseContent()},_getRecord:function(n){var r={};return x(this._columns,function(e,t){n[t]!==undefined&&(r[e]=n[t])}),r},_writeContent:function(e){var t=this._processContent(e);t&&this._appendToReadBuffer(this._getRecord(t))},write:ft(function(e){return this._write(e),Promise.resolve()}),flush:function(){if(this._content){var e=new s.Error.InvalidCSV;return this._setReadError(e),Promise.reject(e)}return this._completeReadBuffer(),Promise.resolve()}});s.attributes={};var Kn=Ue({$class:"gpf.attributes.Attribute"});ye(0,{unknownAttributesSpecification:"Unknown attributes specification",invalidAttributesSpecification:"Invalid attributes specification"});var er="attributes",tr=/^\[([^\]]+)\]$|./,nr=De.prototype._checkMemberName,rr=De.prototype._checkMemberValue,ir=De.prototype._check$Property;function or(e){return tr.exec(e)[1]}Object.assign(De.prototype,{_hasInheritedMember:function(e){return this._extend&&this._extend.prototype[e]!==undefined},_hasMember:function(e){return this._initialDefinition.hasOwnProperty(e)||this._hasInheritedMember(e)},_checkAttributeMemberExist:function(e){this._hasMember(e)||s.Error.unknownAttributesSpecification()},_checkMemberName:function(e){var t=or(e);t?(nr.call(this,t),this._checkAttributeMemberExist(t)):nr.call(this,e)},_checkAttributesSpecification:function(e){E(e)||s.Error.invalidAttributesSpecification(),x(e,function(e){e instanceof Kn||s.Error.invalidAttributesSpecification()})},_checkMemberValue:function(e,t){or(e)?this._checkAttributesSpecification(t):rr.call(this,e,t)},_check$Property:function(e,t){er===e?this._checkAttributesSpecification(t):ir.call(this,e,t)}}),De.prototype._allowed$Properties.push(er);var ar=De.prototype._addMemberToPrototype,sr=De.prototype._buildPrototype,ur="$"+er;Object.assign(De.prototype,{_attributes:{},_addAttributesFor:function(e,t){this._attributes[e]=t},_addMemberToPrototype:function(e,t,n){var r=or(t);r?this._addAttributesFor(r,n):ar.call(this,e,t,n)},_buildPrototype:function(e){var t=this._initialDefinition[ur];this._attributes={},t&&this._addAttributesFor(ur,t),sr.call(this,e)}}),Object.assign(De.prototype,{_collectAttributes:function(u,c){b(this._attributes,function(e,t){var n,r,i,o,a,s=(n=e,(r=c)?n.filter(function(e){return e instanceof r}):n);s.length&&(a=s,(i=u)[o=t]=(i[o]||[]).concat(a))}),this._extendDefinition&&this._extendDefinition._collectAttributes(u,c)},getAttributes:function(e){var t={};return this._collectAttributes(t,e),t}}),s.attributes.get=function(e,t){return"function"!=typeof e&&(e=e.constructor),n=t,(r=ke(e))?r.getAttributes(n):{};var n,r};var cr={},fr=Ue({$class:"gpf.stream.AbstractOperator",_dataInPromise:undefined,_dataInResolve:h,_dataOutResolve:h,_dataOutReject:h,_waitForData:function(){var t=this;return t._dataInPromise||(t._dataInPromise=new Promise(function(e){t._dataInResolve=e}).then(function(e){return delete t._dataInPromise,delete t._dataInResolve,e})),t._dataInPromise},_writeData:function(e){var n=this;return n._waitForData(),n._dataInResolve(e),new Promise(function(e,t){n._dataOutResolve=e,n._dataOutReject=t}).then(function(e){return delete n._dataOutResolve,delete n._dataOutReject,e},function(e){return delete n._dataOutResolve,delete n._dataOutReject,Promise.reject(e)})},read:ct(function(t){var n=this;return n._waitForData().then(function(e){return cr!==e?t.write(e).then(n._dataOutResolve,n._dataOutReject):(n._dataOutResolve(),Promise.resolve())})}),_process:Ne(1),write:ft(function(e){return this._process(e)}),flush:function(){return this._dataInPromise?this._writeData(cr):Promise.resolve()}});at(fr);Ue({$class:"gpf.stream.Filter",$extend:fr,constructor:function(e){this._filter=e},_process:function(e){return this._filter(e)?this._writeData(e):Promise.resolve()}}),Ue({$class:"gpf.stream.Map",$extend:fr,constructor:function(e){this._map=e},_process:function(e){return this._writeData(this._map(e))}})});