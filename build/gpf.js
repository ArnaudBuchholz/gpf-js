(function(e,m){"function"===typeof define&&define.amd?define(["exports"],m):"undefined"!==typeof exports?m(exports):"undefined"!==typeof module&&module.exports?m(module.exports):m(e.gpf={})})(this,function(e){var m,z=!1,p,w,r=function(a){return null===a||"object"!==typeof a?p:a},h=!1,q=!1,A,F,G=function(){};"undefined"!==typeof WScript?(m="wscript",z=!0,p=function(){return this}.apply(null,[]),w=function(a){WScript.Quit(a)},p.console={log:function(a){WScript.Echo("    "+a)},info:function(a){WScript.Echo("[?] "+
a)},warn:function(a){WScript.Echo("/!\\ "+a)},error:function(a){WScript.Echo("(X) "+a)}}):"undefined"!==typeof phantom&&phantom.version?(m="phantomjs",z="\\"===require("fs").separator,p=window,q=h=!0,w=phantom.exit):"undefined"!==typeof module&&module.exports?(m="nodejs",z="\\"===require("path").sep,p=global,h=!0,w=process.exit):("undefined"!==typeof window?(m="browser",p=window,q=!0):(m="unknown",p=this),w=G);h&&(e.node={});e.web={};q&&(A=document,F=A.getElementsByTagName("head")[0]||A.documentElement);
e.version=function(){return"0.1"};e.host=function(){return m};e.context=function(a){var b,c,d;if(void 0===a)return p;"string"===typeof a&&(a=a.split("."));b=a.length;c=0;"gpf"===a[0]?(d=e,++c):d=p;for(;c<b&&(d=d[a[c]],void 0!==d);++c);return d};e.loaded=function(a){a&&a();return!0};e.ASSERT=function(){};var B=Array.prototype.slice;void 0===Array.prototype.every&&(Array.prototype.every=function(a,b){var c=this.length,d;for(d=0;d<c;++d)if(!a.apply(b,[this[d],d,this]))return!1;return!0});void 0===Array.prototype.forEach&&
(Array.prototype.forEach=function(a,b){var c=this.length,d;for(d=0;d<c;++d)a.apply(b,[this[d],d,this])});void 0===Array.prototype.indexOf&&(Array.prototype.indexOf=function(a,b){var c,d=this.length;for(c=void 0!==b?b:0;c<d;){if(this[c]===a)return c;++c}return-1});void 0===Array.prototype.map&&(Array.prototype.map=function(a,b){var c=this.length,d=Array(c),f;for(f=0;f<c;++f)d[f]=a.apply(b,[this[f],f,this]);return d});void 0===Function.prototype.bind&&(Function.prototype.bind=function(a){var b=this,
c=B.apply(arguments,[1]);return function(){var d=B.apply(arguments,[0]);b.apply(a,c.concat(d))}});e.setReadOnlyProperty=void 0===Object.defineProperty?function(a,b,c){a[b]=c;return a}:function(a,b,c){Object.defineProperty(a,b,{enumerable:!0,configurable:!1,writable:!1,value:c});return a};var $=Function,N=function(){return!1},H=function(a){e.ASSERT("string"===typeof a&&a.length,"Source expected (or use _gpfEmptyFunc)");return new $(a)},aa="break case catch continue debugger default delete do else finally for function if in instanceof new return switch this throw try typeof var void while with".split(" ");
e.events={};var I=e.events.Event=function(a,b,c){e.setReadOnlyProperty(this,"type",a);e.setReadOnlyProperty(this,"scope",r(c));void 0!==b&&(this._params=b)},O=0,P=function(a,b){var c=a.scope;e.ASSERT(b,"Expected eventsHandler");"function"===typeof b._dispatchEvent?b._dispatchEvent(a):"function"===typeof b.apply?b.apply(c,[a]):(c=b[a.type],void 0===c&&(c=b["*"]),void 0!==c&&c.apply(b.scope||b,[a]))},ba=function(a,b,c){var d=r(this);a instanceof I||(a=new e.events.Event(a,b,d));10<++O?e.defer(P,0,null,
[a,c]):P(a,c);--O;return a},ca=function(a,b,c){var d=b.length,f=a.length-1;if(f!==d)for(a=B.apply(a,[0]),a[d]=a[f],--f,--d;d>f;)a[d]=b[d],--d;return c.apply(this,a)};I.prototype={constructor:I,type:"",scope:null,_params:{},get:function(a){return this._params[a]},fire:function(a){return e.events.fire(this,a)}};e.events.fire=function(){var a=this;a===e.events&&(a=void 0);return ca.apply(a,[arguments,[0,{}],ba])};var n=function(a,b){this.id=++n.id;this.src=a;this.eventsHandler=b;n.map[this.id]=this},
da=function(a){F.insertBefore(a,F.firstChild)},Q=function(a){e.events.fire.apply(p,a)},ea=function(a,b){var c=new n(a,b),d=A.createElement("script");d.language="javascript";d.src=a;d.id=c.id;d.onload=d.onreadystatechange=n.onLoad;d.onerror=n.onError;void 0!==d.async&&(d.async=!0);setTimeout(da,0,d)};n.prototype={id:0,src:"",eventsHandler:null,clean:function(a){var b=a.parentNode;a.onerror=a.onload=a.onreadystatechange=null;b&&b.removeChild(a);delete n.map[this.id]},check:function(a){var b=a.readyState;
if(!b||-1<["loaded","complete"].indexOf(b))this.clean(a),setTimeout(Q,0,["load",{url:this.src},this.eventsHandler])},failed:function(a){this.clean(a);setTimeout(Q,0,["error",{url:this.src},this.eventsHandler])}};n.id=0;n.map={};n.onLoad=function(){var a=n.map[this.id];a&&a.check(this)};n.onError=function(){var a=n.map[this.id];a&&a.failed(this)};q&&(e.web.include=ea);var fa=function(a,b,c){var d,f=a.length,e;for(e=0;e<f;++e)if(d=b.apply(this,[e,a[e]]),void 0!==d)return d;return c},ga=function(a,b){var c=
a.length,d;for(d=0;d<c;++d)b.apply(this,[d,a[d]])},ha=function(a,b,c){var d,f;for(f in a)if(a.hasOwnProperty(f)&&(d=b.apply(this,[f,a[f]]),void 0!==d))return d;return c},R=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b.apply(this,[c,a[c]])},ia=function(a,b){this[0][a]=b},ja=function(a,b){var c=this[0],d=this[2];void 0!==c[a]?d(c,a,b):c[a]=b},ka={"boolean":function(a,b,c){return"string"===b?"yes"===a||"true"===a?!0:0!==parseInt(a,10):"number"===b?0!==a:c},number:function(a,b,c){return"string"===
b?parseFloat(a):c},string:function(a,b,c){e.interfaces.ignoreParameter(b);e.interfaces.ignoreParameter(c);return a instanceof Date?e.dateToComparableFormat(a):a.toString()},object:function(a,b,c){return c instanceof Date&&"string"===b?e.dateFromComparableFormat(a):c}},S=function(a,b){var c=a,d;for(d in b)b.hasOwnProperty(d)&&-1<c.indexOf(d)&&(c=c.split(d).join(b[d]));return c},la={javascript:{"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r","\t":"\\t"},xml:{"&":"&amp;","<":"&lt;",">":"&gt;"},html:{"&":"&amp;",
"<":"&lt;",">":"&gt;","\u00e9":"&eacute;","\u00e8":"&egrave;","\u00ea":"&ecirc;","\u00e1":"&aacute;","\u00e0":"&agrave;"}},T=function(a,b){var c=la[b];void 0!==c&&(a=S(a,c),"javascript"===b&&(a='"'+a+'"'));return a},J;J="browser"===m&&(window.HTMLCollection||window.NodeList)?function(a){return a instanceof Array||a instanceof window.HTMLCollection||a instanceof window.NodeList}:function(a){return a instanceof Array};e.isArrayLike=J;e.each=function(a,b,c){if(void 0===c)e.isArrayLike(a)?ga.apply(this,
arguments):R.apply(this,arguments);else return e.isArrayLike(a)?fa.apply(this,arguments):ha.apply(this,arguments)};e.extend=function(a,b,c){var d;void 0===c?d=ia:(e.ASSERT("function"===typeof c,"Expected function"),d=ja);R.apply(arguments,[b,d]);return a};e.extend(e,{value:function(a,b,c){var d=typeof a;c||(c=typeof b);return c===d?a:"undefined"!==d&&a?ka[c](a,d,b):b},clone:function(a){return e.json.parse(e.json.stringify(a))},test:function(a,b){var c;if(a instanceof Array)for(c=a.length;0<c;){if(a[--c]===
b)return c}else for(c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c},set:function(a,b){e.ASSERT(a instanceof Array,"gpf.set must be used with an Array");for(var c=a.length;0<c;)if(a[--c]===b)return a;a.push(b);return a},clear:function(a,b){var c;if(a instanceof Array)for(c=a.length;0<c;){if(a[--c]===b){a.splice(c,1);break}}else for(c in a)if(a.hasOwnProperty(c)&&a[c]===b)break;return a},xor:function(a,b){return a&&!b||!a&&b},exit:function(a){void 0===a&&(a=0);w(a)}});h&&(e.node.buffer2JsArray=function(a){var b=
[],c=a.length,d;for(d=0;d<c;++d)b.push(a.readUInt8(d));return b});var U=function(a){this._pending=[];this._done=[];!0!==a?this._alike=N:this._haveDifferentPrototypes=N};U.prototype={_pending:[],_done:[],_stack:function(a,b){var c=this._done,d,f;for(d=c.indexOf(a);-1<d;){f=d%2?c[d-1]:c[d+1];if(f===b)return;d=c.indexOf(a,d+1)}c=this._pending;c.push(a);c.push(b)},_haveDifferentPrototypes:function(a,b){return a.prototype!==b.prototype},explore:function(){for(var a=this._pending,b,c,d=this._done,f,e;0!==
a.length;){c=a.pop();b=a.pop();if(this._haveDifferentPrototypes(b,c))return!1;d.push(b,c);f=0;for(e in b)if(b.hasOwnProperty(e)&&(++f,!this.like(b,c)))return!1;for(e in c)c.hasOwnProperty(e)&&--f;if(0!==f)return!1}return!0},_downcast:function(a){if("object"===typeof a){if(a instanceof String)return a.toString();if(a instanceof Number)return a.valueOf();if(a instanceof Boolean)return!!a}return a},_alike:function(a,b){return this._downcast(a)===this._downcast(b)},like:function(a,b){if(a===b)return!0;
if(typeof a!==typeof b)return this._alike(a,b);if(null===a||null===b||"object"!==typeof a)return!1;this._stack(a,b);return!0}};e.like=function(a,b,c){c=new U(c);return c.like(a,b)&&c.explore()};e.Callback=function(a,b){e.ASSERT(a,"Handler expected");this._handler=a;b&&(this._scope=r(b))};e.extend(e.Callback.prototype,{_handler:G,_scope:null,handler:function(){return this._handler},scope:function(){return this._scope},call:function(){return this.apply(arguments[0],B.apply(arguments,[1]))},apply:function(a,
b){var c=r(a||this._scope);return this._handler.apply(c,b||[])}});e.extend(e.Callback,{resolveScope:function(a){return r(a)},buildParamArray:function(a,b){var c,d,f;if(b)for(c=b.length,d=Array(a+c),f=0;f<c;++f)d[a]=b[f],++a;else d=Array(a);return d},doApply:function(a,b,c){for(var d=arguments.length,f=3,e=0;f<d;)c[e]=arguments[f],++f,++e;return a.apply(b,c)},bind:function(a,b,c){e.ASSERT("string"===typeof b,"Expected method name");e.ASSERT("function"===typeof a[b],"Only methods can be bound");var d=
b+":boundToThis",f;f=a[d];void 0===f&&(f=!0===c?function(){return a[b].apply(a,arguments)}:a[b].bind(a),a[d]=f);return f}});e.events.EventDispatcherImpl={_eventDispatcherListeners:null,addEventListener:function(a,b,c){var d=this._eventDispatcherListeners;d||(d=this._eventDispatcherListeners={});c||(c=!1);void 0===d[a]&&(d[a]=[]);c?d[a].unshift(b):d[a].push(b);return this},removeEventListener:function(a,b){var c=this._eventDispatcherListeners,d;c&&(c=c[a],void 0!==c&&(d=c.indexOf(b),-1!==d&&c.splice(d,
1)));return this},_dispatchEvent:function(a,b){var c,d,f,g;if(!this._eventDispatcherListeners)return this;a instanceof e.events.Event?(c=a,d=a.type):d=a;f=this._eventDispatcherListeners[d];if(void 0===f)return this;c||(c=new e.events.Event(d,b,this));d=f.length;for(g=0;g<d;++g)e.events.fire.apply(this,[c,f[g]]);return this}};var ma={application:{javascript:"js"},image:{gif:0,jpeg:"jpg,jpeg",png:0},text:{css:0,html:"htm,html",plain:"txt,text,log"}},v=null,x=null,V=function(a,b){var c,d,f,e,l,k;for(c in b)if(b.hasOwnProperty(c))if(d=
a?a+"/"+c:c,e=b[c],0===e)f="."+c,x[f]=d,void 0===v[d]&&(v[d]=f);else if("string"===typeof e)for(e=e.split(","),l=e.length,k=0;k<l;++k)f="."+e[k],x[f]=d,void 0===v[d]&&(v[d]=f);else V(d,e)},W=function(){null===x&&(x={},v={},V("",ma))};e.web.getMimeType=function(a){W();a=x[a.toLowerCase()];void 0===a&&(a="application/octet-stream");return a};e.web.getFileExtension=function(a){W();a=v[a.toLowerCase()];void 0===a&&(a=".bin");return a};"use strict";var y=function(a,b,c){"string"===typeof a&&(a=H(a));J(c)||
(c=[]);return function(){a.apply(r(b),c)}},C=[],na=function(a,b){return a._dt-b._dt};e.runAsyncQueue=G;"browser"===m?(y=function(a){a[0].apply(r(a[1]),a[2])},h=function(a,b,c,d){"string"===typeof a&&(a=H(a));b||(b=0);setTimeout(y,b,[a,c,d])}):"undefined"!==typeof setTimeout?h=function(a,b,c,d){b||(b=0);setTimeout(y(a,c,d),b)}:"wscript"===m?(h=function(a,b,c,d){a=y(a,c,d);b||(b=0);a._dt=new Date(new Date- -b);C.push(a);C.sort(na)},e.runAsyncQueue=function(){for(var a;C.length;)a=C.shift(),a._dt>new Date&&
WScript.Sleep(a._dt-new Date),a()}):(console.warn("No implementation for gpf.defer"),h=function(a,b,c,d){y(a,c,d)()});e.defer=h;var K=function(a,b,c,d){var f=a.length,g=e.bin.isPow2(f),l,k=[],h;if(-1<g&&(void 0===c||32>=c*g))for(l=(1<<(void 0===c?32:c*g)-g)-1,f=(1<<g)-1;0!==b;)h=b&f,k.unshift(a.charAt(h)),b=b>>g&l;else for(;0!==b;)h=b%f,k.unshift(a.charAt(h)),b=(b-h)/f;if(void 0!==c)for(void 0===d&&(d=a.charAt(0));k.length<c;)k.unshift(d.charAt(k.length%d.length));else 0===k.length&&(k=[a.charAt(0)]);
return k.join("")},L=function(a,b,c){var d=a.length,e=0,g=0;for(void 0===c&&(c=a.charAt(0));g<b.length&&-1!==c.indexOf(b.charAt(g));)++g;for(;g<b.length;)e=d*e+a.indexOf(b.charAt(g++));return e};e.bin={pow2:function(a){return 1<<a},isPow2:function(a){if(0<a&&0===(a&a-1)){for(var b=0;1<a;)++b,a>>=1;return b}return-1},toBaseANY:K,fromBaseANY:L,toHexa:function(a,b,c){return K("0123456789ABCDEF",a,b,c)},fromHexa:function(a,b){return L("0123456789ABCDEF",a,b)},toBase64:function(a,b,c){return K("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
a,b,c)},fromBase64:function(a,b){return L("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a,b)},test:function(a,b){return(a&b)===b},clear:function(a,b){return a&~b}};var D;"undefined"===typeof JSON?(D=function(a){var b=typeof a;if("undefined"!==b&&"function"!==b){if("number"===b||"boolean"===b)return a.toString();if("string"===b)return T(a,"javascript");if(null===a)return"null";var c,d,e,b=a instanceof Array;c=[];for(d in a)"function"!==typeof a[d]&&(e=D(a[d]),b?c.push(e):c.push(T(d,
"javascript")+":"+e));a=b?"["+c.join(",")+"]":"{"+c.join(",")+"}";return a}},h=function(a){return H("return "+a)()}):(D=JSON.stringify,h=JSON.parse);e.json={stringify:D,parse:h};var M=function(a){return a.split("*")},E=function(a){"!"===a.charAt(0)&&(this.negative=!0,a=a.substr(1));var b=a.indexOf("**");-1===b?this.start=a.split("/").map(M):(0<b&&(e.ASSERT("/"===a.charAt(b-1),"** must be preceded by /"),this.start=a.substr(0,b-1).split("/").map(M)),b<a.length-2&&(e.ASSERT("/"===a.charAt(b+2),"** must be followed by /"),
this.end=a.substr(b+3).split("/").map(M).reverse()))},X=function(a){return a instanceof E?a:new E(a)},Y=function(a){return a instanceof Array?a.map(X):[X(a)]},oa=function(a){var b=a.negative;return a.match(this.parts)?(this.result=!b,!1):b?(this.result=!0,!1):!0};E.prototype={constructor:E,negative:!1,start:null,end:null,_matchName:function(a,b){var c=a.length,d,e,g=0;for(d=0;d<c;++d)if(e=a[d])if(g=b.indexOf(e,g),-1===g||0===d&&0<g)return!1;return!e||g+e.length===b.length},match:function(a){var b=
a.length,c=0,d=b-1,e,g,l;if(this.start)for(e=this.start,g=e.length,l=0;l<g;++l)if(this._matchName(e[l],a[c])){if(++c>b)return!1}else return!1;if(this.end)for(e=this.end,g=e.length,l=0;l<g;++l)if(-1<d&&this._matchName(e[l],a[d])){if(d--<c)return!1}else return!1;return!0}};e.path={match:function(a,b){var c=b;z&&(c=c.toLowerCase().split("\\").join("/"));var d=c.split("/"),c=Y(a),d={parts:d};c.every(oa,d);return d.result||!1},compileMatchPattern:function(a){return Y(a)}};var h=e.Error=function(){},pa=
function(a,b,c){var d=function(d){var g=new e.Error,l,k;e.setReadOnlyProperty(g,"code",a);e.setReadOnlyProperty(g,"name",b);if(d){l={};for(k in d)d.hasOwnProperty(k)&&(l["{"+k+"}"]=d[k].toString());d=S(c,l)}else d=c;e.setReadOnlyProperty(g,"message",d);return g};e.setReadOnlyProperty(d,"CODE",a);e.setReadOnlyProperty(d,"NAME",b);e.setReadOnlyProperty(d,"MESSAGE",c);return d},qa=0,q=function(a,b){var c,d;for(c in b)b.hasOwnProperty(c)&&(d=++qa,e.Error["CODE_"+c.toUpperCase()]=d,e.Error[c]=pa(d,c,b[c]))};
h.prototype={constructor:h,code:0,name:"Error",message:""};q("boot",{NotImplemented:"Not implemented",Abstract:"Abstract",AssertionFailed:"Assertion failed: {message}"});e.js={keywords:function(){return[].concat(aa)}};q("csv",{CsvInvalid:"Invalid CSV syntax (bad quote sequence or missing end of file)"});var Z=function(a,b){for(var c=a.indexOf(b),d=!0;-1<c;){if(c===a.length-1){a=a.substr(0,c);d=!1;break}else if(a.charAt(c+1)===b)a=a.substr(0,c)+a.substr(c+1);else throw e.Error.CsvInvalid();c=a.indexOf(b,
c+1)}return[a,d]},ra=function(a){var b=a.length-1;return"\r"===a.charAt(b)?a.substr(0,b):a};e.csv={parse:function(a,b){b=b||{};var c=a.split("\n").map(ra),d=b.header||c.shift(),f;if(!(f=b.separator))a:{f=d;var g,l;for(g=0;4>g;++g)if(l=";,\t ".charAt(g),-1!==f.indexOf(l)){f=l;break a}f=";"}g=f;var k,h,m;l=[];d=d.split(g);for(f=d.length;c.length;){a:{k=c;h=g;m=b.quote||'"';for(var n=[],s=void 0,p=!1,r=void 0,u=void 0,t=void 0,q=void 0,t=void 0;k.length;){s=k.shift();s=s.split(h);p?(r=!0,s.unshift(n.pop()),
u=1):(u=0,r=!1);for(;u<s.length;)t=s[u],p?(q=[s[u-1]],r?q.push("\r\n"):q.push(h),t=Z(t,m),q.push(t[0]),p=t[1],s[u-1]=q.join(""),r=!1,s.splice(u,1)):(0===t.indexOf(m)&&(t=Z(t.substr(1),m),s[u]=t[0],p=t[1]),++u);n=n.concat(s);if(p){if(0===k.length)throw e.Error.CsvInvalid();}else{k=n;break a}}k=void 0}h={};for(m=0;m<f;++m)h[d[m]]=k[m];l.push(h)}return l}}});
