!function(e,t){"use strict";if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else if("undefined"!=typeof module&&module.exports)t(module.exports);else{e===undefined&&(e=Function("return this;")());var n={};t(n),e.gpf=n}}(this,function(e){"use strict";function t(){}var n,r,i,o,a,s,u="browser",c="nashorn",f="nodejs",l="phantomjs",h="rhino",p="unknown",d="wscript",_=p,m=Function,v=new m("return this")(),g={};function y(e){return{log:function(t){e("    "+t)},info:function(t){e("[?] "+t)},warn:function(t){e("/!\\ "+t)},error:function(t){e("(X) "+t)}}}function b(){v.console=y(print),function(e){java.lang.System.exit(e)}}function w(e){WScript.Echo(e)}"undefined"!=typeof WScript?_=d:"undefined"!=typeof print&&"undefined"!=typeof java?("\\"===String(java.lang.System.getProperty("file.separator")),_="undefined"==typeof readFile?c:h):"undefined"!=typeof phantom&&phantom.version&&!document.currentScript?(_=l,"\\"===require("fs").separator,v=window):"undefined"!=typeof module&&module.exports?(_=f,"\\"===(i=require("path")).sep,v=global):"undefined"!=typeof window&&(_=u,v=window),e.hosts={browser:u,nashorn:c,nodejs:f,phantomjs:l,rhino:h,unknown:p,wscript:d},e.host=function(){return _},e.version=function(){return"0.2.5"},g[u]=function(){(function(e){window.location="https://arnaudbuchholz.github.io/gpf/exit.html?"+(e||0)}),window,document},e.node={},g[f]=function(){r=require("fs"),o=require("http"),a=require("https"),s=require("url"),function(e){process.exit(e)}},g[l]=function(){(function(e){phantom.exit(e)}),window,document,r=require("fs")},e.java={},e.rhino=e.java,g[h]=b,g[c]=b,g[p]=t,e.wscript={},g[d]=function(){n=new ActiveXObject("Scripting.FileSystemObject"),v.console=y(w),function(e){WScript.Quit(e)}},g[_]();var E,x=Array.isArray;function S(e){return x(e)||!!(t=e)&&Math.floor(t.length)===t.length;var t}function P(e,t,n){var r,i=e.length;for(r=0;r<i;++r)t.call(n,e[r],r,e)}function O(e,t,n){for(var r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function j(e,t,n){var r,i,o=e.length;for(i=0;i<o&&!r;++i)r=t.call(n,e[i],i,e);return r}e.isArrayLike=S,E=d===_?function(e,t,n){O(e,t,n),["constructor","toString"].forEach(function(r){e.hasOwnProperty(r)&&t.call(n,e[r],r,e)})}:O,e.forEach=function(e,t,n){S(e)?P(e,t,n):E(e,t,n)};var I=!0;function N(t,n){var r;t||(r=n,I&&console.warn("ASSERTION FAILED: "+r),e.Error.assertionFailed({message:n}))}e.assert=function(e,t){undefined===t&&(t="Assertion with no message",e=!1),N(e,t)},e.asserts=function(e){E(e,N)},e.preventAssertWarnings=function(e){I=!e};var T=/\/\/.*$|\/\*(?:[^\*]*|\*[^\/]*)\*\//gm;function D(e,t){return r=t,0===(n=e).length?m(r):((i=[].concat(n)).push(r),m.apply(null,i));var n,r,i}function C(e,t){return undefined===t&&(t=e,e=[]),D(e,t)}function A(e,t){var n=e;return E(t,function(e,t){n=n.split(t).join(e)}),n}e.web={};var R={};function k(e,t){return n=A(e,R[t]),"javascript"===t?'"'+n+'"':n;var n}function $(e,t){E(t,function(t,n){e[n]===undefined&&(e[n]=t)})}function F(e,t){var n,r,i,o,a=t.on;n=a,(r=t.methods)&&$(n.prototype,r),i=a,(o=t.statics)&&$(i,o)}function M(e,t){v[e]||(v[e]=t)}function B(e,t){return undefined!==t?e.bind(t):e}function q(e,t){for(var n=e.length,r=0;r<n;)e.hasOwnProperty(r)&&t(e[r],r,e),++r}function W(e,t,n){for(var r=e.length;n<r;){if(e.hasOwnProperty(n)&&!0!==t(e[n],n,e))return!1;++n}return!0}function U(e,t){return W(e,t,0)}function L(e){return 0===e?[]:new Array(e).join(" ").split(" ").map(function(e,t){return"p"+t})}function V(e){var t,n,r=L(e);return C(r,(n=["var C = this, l = arguments.length;","if (0 === l) { return new C();}"],(t=r).forEach(function(e,r){var i=r+1;n.push("if ("+i+" === l) { return new C("+t.slice(0,i).join(", ")+");}")}),n.join("\n")))}R.javascript={"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r","\t":"\\t"},R.xml={"&":"&amp;","<":"&lt;",">":"&gt;"},F(0,{on:Array,methods:{every:function(e){return U(this,B(e,arguments[1]))},filter:function(e){var t=[];return e=B(e,arguments[1]),q(this,function(n,r,i){e(n,r,i)&&t.push(n)}),t},forEach:function(e){q(this,B(e,arguments[1]))},indexOf:function(e){var t=-1;return W(this,function(n,r){return n!==e||(t=r,!1)},arguments[1]||0),t},map:function(e){var t=new Array(this.length);return e=B(e,arguments[1]),q(this,function(n,r,i){t[r]=e(n,r,i)}),t},some:function(e){return e=B(e,arguments[1]),!U(this,function(t,n,r){return!e(t,n,r)})},reduce:function(e){var t,n=arguments[1],r=this.length,i=0;for(t=undefined===n?this[i++]:n;i<r;++i)t=e(t,this[i],i,this);return t}},statics:{from:function(e){var t,n,r=(n=[],"string"==typeof(t=e)?function(e,t){var n,r=t.length;for(n=0;n<r;++n)e.push(t.charAt(n))}(n,t):P(t,function(e){n.push(e)},0),n),i=arguments[1];return"function"==typeof i&&(r=r.map(i,arguments[2])),r},isArray:function(e){return"[object Array]"==={}.toString.call(e)}}}),x=Array.isArray;var G=V(10);function H(e){return 10>e?"0"+e:e}function z(e){return e.getUTCFullYear()+"-"+H(e.getUTCMonth()+1)+"-"+H(e.getUTCDate())+"T"+H(e.getUTCHours())+":"+H(e.getUTCMinutes())+":"+H(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}F(0,{on:Date,methods:{toISOString:function(){return z(this)}},statics:{now:function(){return(new Date).getTime()}}});var Z=/^([0-9][0-9][0-9][0-9])\-([0-9][0-9])\-([0-9][0-9])(?:T([0-9][0-9])\:([0-9][0-9])\:([0-9][0-9])(?:\.([0-9][0-9][0-9])Z)?)?$/;var Q=v.Date;function J(){var e,t,n=function(e){if("string"==typeof e)return Z.lastIndex=0,function(e){var t;if(e)return--(t=function(e){var t,n,r,i=[],o=e.length;for(t=1;t<o;++t)n=i,(r=e[t])?n.push(parseInt(r,10)):n.push(0);return i}(e))[1],function(e){if((n=e)[1]<12&&n[2]<32&&(t=e)[3]<24&&t[4]<60&&t[5]<60)return e;var t,n}(t)}(Z.exec(e))}(arguments[0]);return n?new Q(Q.UTC.apply(Q.UTC,n)):(e=Q,(t=arguments).length>G.length&&(G=V(t.length)),G.apply(e,t))}!function(){var e,t;P(["prototype","UTC","parse","now"],function(e){J[e]=Q[e]});try{e=z(new Date("2003-01-22T22:45:34.075Z")),t=z(new Date("2003-01-22"))}catch(e_){}"2003-01-22T22:45:34.075Z"===e&&"2003-01-22T00:00:00.000Z"===t||(v.Date=J)}();var Y,X=Array.prototype.slice;function K(e,t){this[t]=e}function ee(e,t,n){var r=!0;function i(e){return function(t){r&&(r=!1,e(t))}}try{e(i(t),i(n))}catch(e_){r&&(r=!1,n(e_))}}function te(){var e=this;e._handlers.forEach(function(t){t.process(e)}),e._handlers=[]}function ne(e){this._state=!1,this._value=e,te.call(this)}F(0,{on:Function,methods:{bind:function(e){var t=X.call(arguments,1);return C(["thisArg","prependArgs","_gpfArrayPrototypeSlice"],"var me = this;\nreturn function ("+L(Math.max(this.length-t.length,0)).join(", ")+") {\n   var args = _gpfArrayPrototypeSlice.call(arguments, 0);\n    return me.apply(thisArg, prependArgs.concat(args));\n};").call(this,e,t,X)}}}),"functionName"!==C("return function functionName () {};")().name?Function.prototype.compatibleName=function(){var e=t.toString.call(this),n=e.indexOf("function"),r=e.indexOf("(",n);return e.substr(n+9,r-n-9).replace(T,"").trim()}:Function.prototype.compatibleName=function(){return this.name},F(0,{on:Object,statics:{assign:function(e,t){return[].slice.call(arguments,1).forEach(function(t){E(t,K,e)}),e},create:function(){function e(){}return function(t){e.prototype=t;var n=new e;return n.constructor=e,n}}(),getPrototypeOf:function(e){return e.__proto__?e.__proto__:e.constructor.prototype},keys:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},values:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(e[t]);return n}}}),F(0,{on:String,methods:{trim:(Y=/^[\s\ufeff\xa0]+|[\s\ufeff\xa0]+$/g,function(){return this.replace(Y,"")})}});var re=e.Promise=function(e){ee(e,function t(e){var n=this;try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void ee(r.bind(e),t.bind(n),ne.bind(n))}n._state=!0,n._value=e,te.call(n)}catch(e_){ne.call(n,e_)}}.bind(this),ne.bind(this))};function ie(){}ie.prototype={onFulfilled:null,onRejected:null,resolve:null,reject:null,process:function(e){var t=this;if(null===e._state)return e.hasOwnProperty("_handlers")||(e._handlers=[]),void e._handlers.push(t);setTimeout(function(){var n,r;if(null!==(n=e._state?t.onFulfilled:t.onRejected)){try{r=n(e._value)}catch(e_){return void t.reject(e_)}t.resolve(r)}else e._state?t.resolve(e._value):t.reject(e._value)},0)}},re.prototype={_state:null,_value:null,_handlers:[],then:function(e,t){var n=this;return new re(function(r,i){var o=new ie;undefined!==e&&(o.onFulfilled=e),undefined!==t&&(o.onRejected=t),o.resolve=r,o.reject=i,o.process(n)})},"catch":function(e){return this.then(null,e)}},re.resolve=function(e){return new re(function(t){t(e)})},re.reject=function(e){return new re(function(t,n){n(e)})},re.all=function(e){return 0===e.length?re.resolve([]):new re(function(t,n){var r=e.length;e.forEach(function i(o,a){try{if(o&&o instanceof re)return void o.then(function(e){i(e,a)},n);e[a]=o,0==--r&&t(e)}catch(e_){n(e_)}})})},re.race=function(e){return new re(function(t,n){e.forEach(function(e){e.then(t,n)})})},M("Promise",re);var oe={};function ae(e){java.lang.Thread.sleep(e)}oe[d]=function(e){WScript.Sleep(e)},oe[h]=ae,oe[c]=ae;var se,ue=[],ce=0,fe=oe[_]||t;function le(e,t){return e.dt===t.dt?e.id-t.id:e.dt-t.dt}function he(e){return e.toString()}function pe(e,t){return t?"\n"+t+e.join(",\n"+t)+"\n":e.join(",")}function de(e,t,n){return null===e?"null":(r=t,a=[],o=(i=n)?": ":":",E(e,function(e,t){var n=r(t,e);n=se[typeof n](e,r,i),undefined!==n&&a.push(k(t,"javascript")+o+n)}),"{"+pe(a,i)+"}");var r,i,o,a}function _e(e,t){if(undefined!==e)return e[t]}function me(e,t){var n=e[t];return undefined===n&&(n=e[t]={}),n}function ve(t,n){var r,i,o;return i=n?me:_e,"gpf"===(r=t)[0]?(o=e,r=r.slice(1)):o=v,r.reduce(i,o)}e.handleTimeout=function(){for(var e,t,n=ue;n.length;){for(e=n.shift(),t=(new Date).getTime();e.dt>t;)fe(e.dt-t),t=(new Date).getTime();e.cb()}},M("setTimeout",function(e,t){var n={id:++ce,dt:(new Date).getTime()+t,cb:e};return ue.push(n),ue.sort(le),ce}),M("clearTimeout",function(e){var t;ue.every(function(n,r){return n.id!==e||(t=r,!1)})||ue.splice(t,1)}),se={undefined:t,"function":t,number:he,"boolean":he,string:function(e){return k(e,"javascript")},object:function(e,t,n){return x(e)?(r=t,i=n,o=[],P(e,function(e,t){var n=r(t.toString(),e);n=undefined===n?"null":se[typeof n](n,r,i),o.push(n)}),"["+pe(o,i)+"]"):de(e,t,n);var r,i,o}},M("JSON",{parse:function(e,t){var n=C("return "+e)();return t?function r(e,t,n){return"object"==typeof e&&E(e,function(t,i){e[i]=r(t,i,n)}),n(t,e)}(n,"",t):n},stringify:function(e,t,n){return se[typeof e](e,x(i=t)?function(e,t){if(-1!==i.indexOf(e))return t}:"function"==typeof(o=i)?o:function(e,t){return t},"number"==typeof(r=n)?new Array(Math.min(r,10)+1).join(" "):r||"");var r,i,o}}),e.context=function(e){return undefined===e?v:ve(e.split("."))},R.html=Object.assign({},R.xml,{"\xe0":"&agrave;","\xe1":"&aacute;","\xe8":"&egrave;","\xe9":"&eacute;","\xea":"&ecirc;"});var ge=e.Error=function(){};function ye(e,t,n){var r=function(e,t,n){function r(e){this._buildMessage(e)}var i;return r.prototype=new ge,Object.assign(r.prototype,{code:e,name:t,message:n}),r.prototype.constructor=r,ge[(i=t,i.charAt(0).toUpperCase()+i.substr(1))]=r,function(e){throw new r(e)}}(e,t,n);return r.CODE=e,r.NAME=t,r.MESSAGE=n,r}ge.prototype=new Error,Object.assign(ge.prototype,{constructor:ge,code:0,name:"Error",message:"",_buildMessage:function(e){var t;e&&(t={},E(e,function(e,n){t["{"+n+"}"]=e.toString()}),this.message=A(this.message,t))}});var be=0;function we(t,n){E(n,function(t,n){var r=++be;e.Error["CODE_"+n.toUpperCase()]=r,e.Error[n]=ye(r,n,t)})}function Ee(e){return e.trim()}function xe(e,n){var r,i,o,a,s,u=t.toString.call(e).replace(T,"");r=u,i=n,e.length&&(i.parameters=/\(\s*(\w+(?:\s*,\s*\w+)*)\s*\)/.exec(r)[1].split(",").map(Ee)),o=u,a=n,(s=Ee(/{((?:.*\r?\n)*.*)}/.exec(o)[1]))&&(a.body=s)}function Se(e){var t,n,r={};return t=r,(n=e.compatibleName())&&(t.name=n),xe(e,r),r}function Pe(e,t){return n="function"+((c=a=e).name?" "+c.name:"")+"("+((u=a).parameters?u.parameters.join(", "):"")+') {\n\t"use strict"\n'+((s=a).body?s.body.toString():"")+"\n}",r=t||{},i=Object.keys(r),o=i.map(function(e){return r[e]}),C(i,"return "+n).apply(null,o);var n,r,i,o,a,s,u,c}we(0,{notImplemented:"Not implemented",assertionFailed:"Assertion failed: {message}",invalidParameter:"Invalid parameter"}),we(0,{invalidEntityType:"Invalid entity type"});var Oe={};function je(t){var n,r,i,o,a=(r=t,E(Oe,function(e,t){r["$"+t]&&(i=e)}),i);return a||(o=Oe[t.$type],undefined===o&&e.Error.invalidEntityType(),a=o),(n=new a(t)).check(),n}function Ie(e,t){return e.exec(t)}function Ne(e,t){for(var n,r,i=[],o=(r=t,(n=e).lastIndex=0,Ie(n,r));o;)i.push(o),o=Ie(e,t);return i}function Te(e){this._initialDefinition=e}function De(t){return Pe({parameters:L(t),body:"_throw_();"},{_throw_:e.Error.abstractMethod})}function Ce(e,t){"$"===t.charAt(0)?this._check$Property(t.substr(1),e):this._checkProperty(t,e)}Te.prototype={constructor:Te,_initialDefinition:{}},we(0,{abstractMethod:"Abstract method"}),we(0,{invalidEntity$Property:"Invalid entity $ property",missingEntityName:"Missing entity name",invalidEntityNamespace:"Invalid entity namespace"}),Object.assign(Te.prototype,{_type:"",_allowed$Properties:"type,name,namespace".split(","),_check$Property:function(t,n){var r;t!==this._type&&(r=t,-1===this._allowed$Properties.indexOf(r)&&e.Error.invalidEntity$Property())},_throwInvalidProperty:De(0),_reMemberName:/.*/,_checkMemberName:function(e){this._reMemberName.exec(e)||this._throwInvalidProperty()},_reservedNames:"super,class,public,private,protected,static,mixin".split(","),_checkReservedMemberName:function(e){-1!==this._reservedNames.indexOf(e)&&this._throwInvalidProperty()},_checkMemberValue:C(["name","value"]," "),_checkProperty:function(e,t){this._checkMemberName(e),this._checkReservedMemberName(e),this._checkMemberValue(e,t)},_checkProperties:function(){E(this._initialDefinition,Ce,this)},_name:"",_readName:function(){var e=this._initialDefinition;this._name=e["$"+this._type]||e.$name},_checkNameIsNotEmpty:function(){this._name||e.Error.missingEntityName()},_throwInvalidName:De(0),_reName:/.*/,_checkName:function(){this._reName.exec(this._name)||this._throwInvalidName()},_namespace:"",_extractRelativeNamespaceFromName:function(){var e=/(.*)\.([^\.]+)$/.exec(this._name);if(e)return this._name=e[2],e[1]},_readNamespace:function(){var e=[this._initialDefinition.$namespace,this._extractRelativeNamespaceFromName()].filter(function(e){return e});e.length>0&&(this._namespace=e.join("."))},_checkNamespace:function(){/^(:?[a-z_$][a-zA-Z0-9]+(:?\.[a-z_$][a-zA-Z0-9]+)*)?$/.exec(this._namespace)||e.Error.invalidEntityNamespace()},check:function(){this._checkProperties(),this._readName(),this._checkNameIsNotEmpty(),this._readNamespace(),this._checkName(),this._checkNamespace()}});var Ae=[];function Re(e){var t=j(Ae,function(t){if(t.getInstanceBuilder()===e)return t});return t||(t=j([].concat(Ae).reverse(),function(t){if(e.prototype instanceof t.getInstanceBuilder())return t})),t}function ke(e){Te.call(this,e)}function $e(t){return Pe({name:(n=t)._name,parameters:Se(n._resolvedConstructor).parameters,body:"if (!(this instanceof _classDef_._instanceBuilder)) gpf.Error.classConstructorFunction();\n_classDef_._resolvedConstructor.apply(this, arguments);"},{gpf:e,_classDef_:t});var n}function Fe(){e.Error.invalidClassSuper()}function Me(e){return"function"!=typeof e&&(e=Fe),(n=Se(t=e)).body="return _superMethod_.apply(this, arguments);",Pe(n,{_superMethod_:t});var t,n}function Be(t,n,r){return"function"!=typeof r&&e.Error.invalidClassSuperMember(),i=t,o=n,(s=Se(a=r)).body="return _superMethod_.apply(this === _$super_ ? _that_ : this, arguments);",Pe(s,{_that_:i,_$super_:o,_superMethod_:a});var i,o,a,s}Object.assign(Te.prototype,{_instanceBuilder:null,getInstanceBuilder:function(){return this._instanceBuilder||this._setInstanceBuilder(this._build()),this._instanceBuilder},_setInstanceBuilder:function(e){this._namespace&&(ve(this._namespace.split("."),!0)[this._name]=e),this._instanceBuilder=e,Ae.push(this)},_build:t}),ke.prototype=Object.create(Te.prototype),Object.assign(ke.prototype,{constructor:ke,_type:"class"}),Oe["class"]=ke,we(0,{invalidClassName:"Invalid class name",invalidClassProperty:"Invalid class property",invalidClassExtend:"Invalid class extend",invalidClassConstructor:"Invalid class constructor",invalidClassOverride:"Invalid class override"}),Object.assign(ke.prototype,{_allowed$Properties:Te.prototype._allowed$Properties.concat(["extend"]),_throwInvalidProperty:e.Error.invalidClassProperty,_reMemberName:/^[a-z_][a-zA-Z0-9]*$/,_checkConstructorMember:function(t){"function"!=typeof t&&e.Error.invalidClassConstructor()},_checkOverridenMember:function(t,n){typeof t!=typeof n&&e.Error.invalidClassOverride()},_checkIfOverriddenMember:function(e,t){var n=this._extend.prototype[e];undefined!==n&&this._checkOverridenMember(t,n)},_checkMemberValue:function(e,t){"constructor"===e?this._checkConstructorMember(t):this._checkIfOverriddenMember(e,t)},_reName:/^[A-Z_$][a-zA-Z0-9]*$/,_throwInvalidName:e.Error.invalidClassName,_extend:Object,_extendDefinition:undefined,_readExtend:function(){var e,t="string"==typeof(e=this._initialDefinition.$extend)?ve(e.split(".")):e;t&&(this._extend=t,this._extendDefinition=Re(t))},_checkExtendIsNotAnInterface:function(){-1!==t.toString.call(this._extend).indexOf("interfaceConstructorFunction")&&e.Error.invalidClassExtend()},_checkExtend:function(){"function"!=typeof this._extend&&e.Error.invalidClassExtend(),this._checkExtendIsNotAnInterface()},check:function(){this._readExtend(),this._checkExtend(),Te.prototype.check.call(this)}}),we(0,{"classConstructorFunction":"This is a class constructor function, use with new"}),Object.assign(ke.prototype,{_resolvedConstructor:t}),we(0,{invalidClassSuper:"Invalid class super",invalidClassSuperMember:"Invalid class super member"});var qe=/\.\$super\.(\w+)\b/g;function We(e){Te.call(this,e)}function Ue(t){return Pe({name:t._name,body:"gpf.Error.interfaceConstructorFunction();"},{gpf:e,_classDef_:t})}function Le(e){return je(e).getInstanceBuilder()}function Ve(e,t){var n=!0;return E(e.prototype,function(e,r){var i,o;"constructor"!==r&&(i=e,("function"!=typeof(o=t[r])||i.length!==o.length)&&(n=!1))}),n}function Ge(t,n){return Ve(t,n)?n:function(t,n){if(Ve(e.interfaces.IUnknown,n))return r=t,n.queryInterface(r);var r}(t,n)}function He(e){return"string"==typeof e?ve(e.split(".")):e}Object.assign(ke.prototype,{_get$Super:function(e,t,n){var r=this._extend.prototype,i=Me(r[t]);return n.forEach(function(t){i[t]=Be(e,i,r[t])}),i},_superifiedBody:'var _super_;\nif (this.hasOwnProperty("$super")) {\n    _super_ = this.$super;\n}\nthis.$super = _classDef_._get$Super(this, _methodName_, _superMembers_);\ntry{\n    var _result_ = _method_.apply(this, arguments);\n} finally {\n    if (undefined === _super_) {\n        delete this.$super;\n    } else {\n        this.$super = _super_;\n    }\n}\nreturn _result_;',_getSuperifiedContext:function(e,t,n){return{_method_:e,_methodName_:t,_superMembers_:n,_classDef_:this}},_createSuperified:function(e,t,n){var r=Se(e);return r.body=this._superifiedBody,Pe(r,this._getSuperifiedContext(e,t,n))},_superify:function(e,t){return /\.\$super\b/.exec(e)?this._createSuperified(e,t,Ne(qe,e).map(function(e){return e[1]})):e}}),Object.assign(ke.prototype,{_build:function(){var e,t;return this._resolveConstructor(),e=$e(this),t=Object.create(this._extend.prototype),e.prototype=t,t.constructor=e,this._buildPrototype(t),e},_addMethodToPrototype:function(e,t,n){e[t]=this._superify(n,t)},_addMemberToPrototype:function(e,t,n){"function"==typeof n?this._addMethodToPrototype(e,t,n):e[t]=n},_buildPrototype:function(e){E(this._initialDefinition,function(t,n){"$"!==n.charAt(0)&&"constructor"!==n&&this._addMemberToPrototype(e,n,t)},this)},_setResolvedConstructorToInherited:function(){this._extend!==Object&&(this._resolvedConstructor=this._extend)},_resolveConstructor:function(){this._initialDefinition.hasOwnProperty("constructor")?this._resolvedConstructor=this._superify(this._initialDefinition.constructor,"constructor"):this._setResolvedConstructorToInherited()}}),We.prototype=Object.create(Te.prototype),Object.assign(We.prototype,{constructor:We,_type:"interface"}),Oe["interface"]=We,we(0,{invalidInterfaceName:"Invalid interface name",invalidInterfaceProperty:"Invalid interface property"}),Object.assign(We.prototype,{_throwInvalidProperty:e.Error.invalidInterfaceProperty,_reMemberName:/^[a-z][a-zA-Z0-9]*$/,_reservedNames:Te.prototype._reservedNames.concat("constructor"),_checkMemberValue:function(t,n){"function"!=typeof n&&e.Error.invalidInterfaceProperty()},_reName:/^I[a-zA-Z0-9]*$/,_throwInvalidName:e.Error.invalidInterfaceName}),we(0,{"interfaceConstructorFunction":"This is an interface constructor function, do not invoke"}),Object.assign(We.prototype,{_build:function(){var e,t;return delete(t=(e=Ue(this)).prototype).constructor,this._buildPrototype(t),e},_buildPrototype:function(e){E(this._initialDefinition,function(t,n){"$"!==n.charAt(0)&&(e[n]=t)},this)}}),e.define=Le,we(0,{interfaceExpected:"Expected interface not implemented: {name}"});var ze;e.interfaces={isImplementedBy:function(e,t){return!!t&&Ve(He(e),(n=t)instanceof Function?n.prototype:n);var n},query:function(e,t){return Ge(He(e),t)}};function Ze(e,t){var n={$interface:"gpf.interfaces.I"+e};return Object.keys(t).forEach(function(e){n[e]=De(t[e])}),Le(n)}function Qe(e,t){var n,r,i,o,a;return!1===e.ascending?(n="b"+t,r="a"+t):(n="a"+t,r="b"+t),"if("+n+"!=="+r+")return "+(i=e.type,o=n,a=r,"string"===i?o+".localeCompare("+a+")":o+"-"+a)+";"}function Je(e){return C(["a","b"],"var "+(t=e).map(function(e,t){return"a"+t+"=a."+e.property+",b"+t+"=b."+e.property}).join(",")+";"+t.map(Qe).join("")+"return 0;");var t}function Ye(e,t){return function(n){return"("+n[e].map(ze).join(t)+")"}}Ze("Unknown",{"queryInterface":1}),e.createSortFunction=function(e){return x(e)||(e=[e]),Je(e)};var Xe={property:function(e){return"i."+e.property},eq:Ye("eq","==="),ne:Ye("ne","!=="),lt:Ye("lt","<"),lte:Ye("lte","<="),gt:Ye("gt",">"),gte:Ye("gte",">="),not:function(e){return"!"+ze(e.not)},like:function(e){var t,n="/"+(t=e).regexp+"/.exec("+ze(t.like)+")";return e.group?"("+n+"||[])["+e.group+"]":n},or:Ye("or","||"),and:Ye("and","&&"),undefined:function(e){return JSON.stringify(e)}},Ke=Object.keys(Xe);ze=function(e){var t=function(e){if("object"==typeof e)return Object.keys(e).filter(function(e){return-1<Ke.indexOf(e)})[0]}(e);return(0,Xe[t])(e)},e.createFilterFunction=function(e){return C(["i"],"return "+ze(e))};var et=Ze("ReadableStream",{"read":1}),tt=Ze("WritableStream",{"write":1});function nt(t,n,r){return t||e.Error.interfaceExpected({name:r}),i=r,(o=Ge(n,t))||e.Error.interfaceExpected({name:i}),o;var i,o}function rt(e){return nt(e,et,"gpf.interfaces.IReadableStream")}function it(e){return nt(e,tt,"gpf.interfaces.IWritableStream")}Ze("Enumerator",{"reset":0,"moveNext":0,"getCurrent":0}),Ze("FileStorage",{"getInfo":1,"openTextStream":2,"close":1,"explore":1,"createDirectory":1,"deleteFile":1,"deleteDirectory":1}),we(0,{readInProgress:"A read operation is already in progress",writeInProgress:"A write operation is already in progress",invalidStreamState:"Stream is in an invalid state"}),e.stream={};var ot="gpf.stream#progress",at=ot+"/read",st=ot+"/write";function ut(e){e.prototype[at]=!1,e.prototype[st]=!1}function ct(e){e[at]=!1}function ft(e){e[st]=!1}function lt(t){return function(n){var r,i=this,o=it(n);return(r=i)[at]&&e.Error.readInProgress(),r[at]=!0,t.call(i,o).then(function(e){return ct(i),Promise.resolve(e)},function(e){return ct(i),Promise.reject(e)})}}function ht(t){return function(n){var r,i=this;return(r=i)[st]&&e.Error.writeInProgress(),r[st]=!0,t.call(i,n).then(function(e){return ft(i),Promise.resolve(e)},function(e){return ft(i),Promise.reject(e)})}}var pt=Le({$class:"gpf.stream.ReadableString",constructor:function(e){this._buffer=e},read:lt(function(e){return e.write(this._buffer)}),_buffer:""}),dt=Le({$class:"gpf.stream.WritableString",constructor:function(){this._buffer=[]},write:ht(function(e){return this._buffer.push(e.toString()),Promise.resolve()}),toString:function(){return this._buffer.join("")},_buffer:[]});ut(pt),ut(dt),we(0,{incompatibleStream:"Incompatible stream"});var _t={NOT_FOUND:0,DIRECTORY:1,FILE:2,UNKNOWN:3},mt={READING:0,APPENDING:1},vt={},gt={};function yt(e){var t=vt[_],n=new dt;return t.openTextStream(e,mt.READING).then(function(e){return e.read(n)}).then(function(){return n.toString()})}function bt(e){return gt[_](e)}function wt(t){t.length?t.pop():e.Error.unreachablePath()}function Et(e){var t,n,r=-1<(t=e).indexOf("\\")?t.toLowerCase().split("\\"):t.split("/");return(n=r)[n.length-1]||n.pop(),r}function xt(e){return Et(e).join("/")}function St(e){return e?Et(e).pop():""}function Pt(e){var t=St(e),n=t.lastIndexOf(".");return-1===n?"":t.substr(n)}function Ot(e){var t=Et(e);return[].slice.call(arguments,1).forEach(function(e,t){Et(t).forEach(function(t){".."===t?wt(e):e.push(t)})}.bind(null,t)),t.join("/")}function jt(e){return wt(e=Et(e)),e.join("/")}function It(e,t){var n,r=-1;return{reset:function(){return r=-1,Promise.resolve()},moveNext:function(){return++r,n=undefined,r<t.length?e.getInfo(t[r]).then(function(e){return n=e}):Promise.resolve()},getCurrent:function(){return n}}}e.fs={types:{notFound:_t.NOT_FOUND,directory:_t.DIRECTORY,file:_t.FILE,unknown:_t.UNKNOWN},openFor:{reading:mt.READING,appending:mt.APPENDING},getFileStorage:function(){return vt[_]||null},read:bt},we(0,{unreachablePath:"Unreachable path"}),e.path={join:Ot,parent:jt,name:St,nameOnly:function(e){var t=St(e),n=t.lastIndexOf(".");return-1===n?t:t.substr(0,n)},extension:Pt,relative:function(e,t){var n,r,i,o=Et(e),a=Et(t);for(i=a,(r=o).length*i.length&&function(e,t){for(;e[0]===t[0];)e.shift(),t.shift()}(r,i),n=o.length+1;--n;)a.unshift("..");return a.join("/")}};var Nt=Le({$class:"gpf.node.BaseStream",constructor:function(e,t){this._stream=e,"function"==typeof t&&(this._close=t),e.on("error",this._onError.bind(this))},_close:t,close:function(){return this._close()},_stream:null,_invalid:!1,_reject:e.Error.invalidStreamState,_checkIfValid:function(){this._invalid&&e.Error.invalidStreamState()},_onError:function(e){this._invalid=!0,this._reject(e)}}),Tt=Le({$class:"gpf.node.ReadableStream",$extend:"gpf.node.BaseStream",read:lt(function(e){var t=this,n=t._stream;return new Promise(function(r,i){t._reject=i,t._checkIfValid(),n.on("data",t._onData.bind(t,e)).on("end",function(){t._invalid=!0,r()})})}),_onData:function(e,t){var n=this._stream;n.pause(),e.write(t).then(function(){n.resume()},this._reject)}}),Dt=Le({$class:"gpf.node.WritableStream",$extend:"gpf.node.BaseStream",write:ht(function(e){var t=this,n=t._stream;return new Promise(function(r,i){if(t._reject=i,t._checkIfValid(),n.write(e))return r();n.once("drain",r)})})});function Ct(e,t){return new Promise(function(n,i){r[e].apply(r,t.concat([function(e,t){e?i(e):n(t)}]))})}function At(e,t){return Ct(e,[xt(t)])}function Rt(e,t){return Ct("open",[xt(e),t.flags]).then(function(e){return new t.GpfStream(r[t.nodeStream]("",{fd:e,autoClose:!1}),Ct.bind(null,"close",[e]))})}function kt(e){return e.isDirectory()?_t.DIRECTORY:e.isFile()?_t.FILE:_t.UNKNOWN}var $t=Le({$class:"gpf.node.FileStorage",getInfo:function(e){return e=xt(e),new Promise(function(t){r.exists(e,t)}).then(function(t){return t?At("stat",e).then(function(t){return{fileName:i.basename(e),filePath:xt(i.resolve(e)),size:t.size,createdDateTime:t.ctime,modifiedDateTime:t.mtime,type:kt(t)}}):{type:_t.NOT_FOUND}})},openTextStream:function(e,t){return mt.READING===t?Rt(e,{flags:"r",GpfStream:Tt,nodeStream:"createReadStream"}):Rt(e,{flags:"a",GpfStream:Dt,nodeStream:"createWriteStream"})},close:function(t){return t instanceof Nt?t.close():Promise.reject(new e.Error.IncompatibleStream)},explore:function(e){var t=this;return At("readdir",e).then(function(n){return It(t,n.map(function(t){return Ot(e,t)}))})},createDirectory:At.bind(null,"mkdir"),deleteFile:At.bind(null,"unlink"),deleteDirectory:At.bind(null,"rmdir")});vt[f]=new $t,gt[f]=yt;var Ft=Le({$class:"gpf.wscript.BaseStream",constructor:function(e){this._file=e},close:function(){return new Promise(function(e){this._file.Close(),e()}.bind(this))}}),Mt=Le({$class:"gpf.wscript.ReadableStream",$extend:"gpf.wscript.BaseStream",read:lt(function(e){var t=this._file;return new Promise(function(n){return function r(){return e.write(t.Read(4096)).then(function(){if(!t.AtEndOfStream)return r()})}().then(n)})})}),Bt=Le({$class:"gpf.wscript.WritableStream",$extend:"gpf.wscript.BaseStream",write:ht(function(e){var t=this._file;return new Promise(function(n){t.Write(e),n()})})});function qt(e,t){return{type:t,fileName:e.Name.toLowerCase(),filePath:xt(e.Path),size:e.Size,createdDateTime:new Date(e.DateCreated),modifiedDateTime:new Date(e.DateLastModified)}}function Wt(e,t){return new Promise(function(r){n[e](Et(t).join("\\"),!0),r()})}function Ut(e){return n.FolderExists(e)?qt(n.GetFolder(e),_t.DIRECTORY):(t=e,n.FileExists(t)?qt(n.GetFile(t),_t.FILE):{type:_t.NOT_FOUND});var t}function Lt(e){for(var t=new Enumerator(e),n=[];!t.atEnd();t.moveNext())n.push(t.item().Path);return n}we(0,{pathNotExplorable:"Path not explorable"});var Vt=Le({$class:"gpf.wscript.FileStorage",getInfo:function(e){return Promise.resolve(Ut(Et(e).join("\\")))},openTextStream:function(e,t){return e=Et(e).join("\\"),new Promise(function(r){r(mt.READING===t?new Mt(n.OpenTextFile(e,1,!1)):new Bt(n.OpenTextFile(e,8,!0)))})},close:function(t){return t instanceof Ft?t.close():Promise.reject(new e.Error.IncompatibleStream)},explore:function(t){var r=this;return new Promise(function(i){i(It(r,function(t){var r;if(n.FolderExists(t))return Lt((r=n.GetFolder(t)).SubFolders).concat(Lt(r.Files));e.Error.pathNotExplorable()}(Et(t).join("\\"))))})},createDirectory:function(e,t){return new Promise(function(r){n[e](Et(t).join("\\")),r()})}.bind(null,"CreateFolder"),deleteFile:Wt.bind(null,"DeleteFile"),deleteDirectory:Wt.bind(null,"DeleteFolder")});vt[d]=new Vt,gt[d]=yt,gt[u]=e.Error.notImplemented,gt[h]=function(e){return new Promise(function(t){t(readFile(e))})},gt[l]=function(e){return new Promise(function(t,n){try{t(r.read(e))}catch(e_){n(new Error(e_))}})};var Gt=Object.prototype.toString;function Ht(e){return e instanceof Object&&"[object Object]"===Gt.call(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}e.isLiteralObject=Ht,we(0,{missingNodeName:"Missing node name",unknownNamespacePrefix:"Unknown namespace prefix",unableToUseNamespaceInString:"Unable to use namespace in string"});var zt={"className":"class"},Zt={"svg":"http://www.w3.org/2000/svg","xlink":"http://www.w3.org/1999/xlink"};function Qt(t){var n,r,i=t.split(":");if(2===i.length)return{namespace:(n=i[0],r=Zt[n],undefined===r&&e.Error.unknownNamespacePrefix(),r),name:i[1]}}function Jt(t){-1!==t.indexOf(":")&&e.Error.unableToUseNamespaceInString()}function Yt(e){return zt[e]||e}function Xt(e,t){e.forEach(function(e){x(e)?Xt(e,t):t(e)})}var Kt=Le({$class:"gpf.web.Tag",constructor:function(e,t,n){this._nodeName=e,this._attributes=t||{},this._children=n},_nodeName:"",_attributes:{},_children:[],_getAttributesAsString:function(){return Object.keys(this._attributes).map(function(e){return Jt(e)," "+Yt(e)+'="'+k(this._attributes[e],"html")+'"'},this).join("")},_getChildrenAsString:function(){var e=[];return Xt(this._children,function(t){e.push(t.toString())}),e.join("")},_getClosingString:function(){return this._children.length?">"+this._getChildrenAsString()+"</"+this._nodeName+">":"/>"},toString:function(){return Jt(this._nodeName),"<"+this._nodeName+this._getAttributesAsString()+this._getClosingString()},_createElement:function(e){var t=e.ownerDocument,n=Qt(this._nodeName);return n?t.createElementNS(n.namespace,n.name):t.createElement(this._nodeName)},_setAttributesTo:function(e){E(this._attributes,function(t,n){var r=Qt(n);r?e.setAttributeNS(r.namespace,Yt(r.name),t):e.setAttribute(Yt(n),t)})},_appendChildrenTo:function(e){var t=e.ownerDocument;Xt(this._children,function(n){n instanceof Kt?n.appendTo(e):e.appendChild(t.createTextNode(n.toString()))})},appendTo:function(e){var t=this._createElement(e);return this._setAttributesTo(t),this._appendChildrenTo(t),e.appendChild(t)}});e.web.createTagFunction=function(t){return t||e.Error.missingNodeName(),function(e){var n,r;return Ht(e)?(r=e,n=1):n=0,new Kt(t,r,[].slice.call(arguments,n))}},e.http={};var en={GET:"GET",POST:"POST",PUT:"PUT",OPTIONS:"OPTIONS",DELETE:"DELETE",HEAD:"HEAD"},tn=/([^:\s]+)\s*: ?([^\r]*)/gm;function nn(e){var t={};return P(Ne(tn,e),function(e){t[e[1]]=e[2]}),t}function rn(e){return function(t,n){n&&Object.keys(n).forEach(function(r){t[e](r,n[r])})}}function on(e){return function(t,n){n?t[e](n):t[e]()}}Ze("Thenable",{"then":2});function an(t){return e.interfaces.isImplementedBy(e.interfaces.IThenable,t)?t:Promise.resolve(t)}function sn(e){if(undefined!==e)return an(e)}e.promisify=an,e.promisifyDefined=sn;var un={};function cn(e,t){return j(e,function(e){var t,n=e.url;if(n.lastIndex=0,t=n.exec(this.url))return sn(e.response.apply(null,[this].concat([].slice.call(t,1))))}.bind(t))}var fn=0;function ln(){Object.keys(en).forEach(function(e){un[e]=[]})}ln(),e.http.mock=function(e){var t,n=e.method;return t=n+"."+ ++fn,un[n].unshift(Object.assign({method:n,id:t},e)),t},e.http.mock.remove=function(e){var t=e.split(".")[0];un[t]=un[t].filter(function(t){return t.id!==e})},e.http.mock.reset=ln;var hn={};function pn(e){return cn(un[(t=e).method],t)||new Promise(function(t,n){hn[_](e,t,n)});var t}function dn(e,t,n){return pn("string"==typeof t?{method:e,url:t,data:n}:Object.assign({method:e},t))}Object.assign(e.http,{methods:{get:en.GET,post:en.POST,put:en.PUT,options:en.OPTIONS,"delete":en.DELETE,head:en.HEAD},request:pn,get:dn.bind(e.http,en.GET),post:dn.bind(e.http,en.POST),put:dn.bind(e.http,en.PUT),options:dn.bind(e.http,en.OPTIONS),"delete":dn.bind(e.http,en.DELETE),head:dn.bind(e.http,en.HEAD)});var _n=rn("setRequestHeader"),mn=on("send");function vn(e){var t=new dt;return rt(e).read(t).then(function(){return t.toString()})}function gn(e){var t,n,r=Object.assign(s.parse(e.url),e);return t=r,(n=e.data)&&(t.headers=Object.assign({"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(n)},t.headers)),r}function yn(e,t){var n=gn(e);return("https:"===n.protocol?a:o).request(n,function(e){!function(e,t){e.setEncoding("utf8");var n=new Tt(e);vn(n).then(function(r){n.close(),t({status:e.statusCode,headers:e.headers,responseText:r})})}(e,t)})}hn[u]=hn[l]=function(e,t){var n,r,i,o,a=(n=e,(r=new XMLHttpRequest).open(n.method,n.url),r);_n(a,e.headers),o=function(){t({status:a.status,headers:nn(a.getAllResponseHeaders()),responseText:a.responseText})},(i=a).onreadystatechange=function(){4===i.readyState&&o()},mn(a,e.data)},hn[f]=function(e,t,n){var r,i,o=yn(e,t);o.on("error",n),r=o,(i=e.data)?r.write(i,"utf8",function(){r.end()}):r.end()};var bn=rn("setRequestHeader"),wn=on("Send");hn[d]=function(e,t){var n,r,i,o=(n=e,(r=new ActiveXObject("WinHttp.WinHttpRequest.5.1")).Open(n.method,n.url),r);bn(o,e.headers),wn(o,e.data),t({status:(i=o).Status,headers:nn(i.GetAllResponseHeaders()),responseText:i.ResponseText})};var En=Le({$class:"gpf.java.BaseStream",constructor:function(e){this._stream=e},close:function(){return this._stream.close(),Promise.resolve()},_stream:null}),xn=Le({$class:"gpf.java.ReadableStream",$extend:En,_handleError:function(e){return e instanceof java.util.NoSuchElementException||0===e.message.indexOf("java.util.NoSuchElementException")?Promise.resolve():Promise.reject(e)},read:lt(function(e){try{var t=new java.util.Scanner(this._stream);return e.write(String(t.useDelimiter("\\A").next()))}catch(e_){return this._handleError(e_)}})}),Sn=Le({$class:"gpf.java.WritableStream",$extend:En,constructor:function(e){this.$super(e),this._writer=new java.io.OutputStreamWriter(e)},write:ht(function(e){var t=this._writer;return t.write(e),t.flush(),Promise.resolve()}),close:function(){return this._writer.close(),this.$super()},_writer:null});gt[c]=function(e){var t=java.nio.file.Paths.get(e);return java.nio.file.Files.exists(t)?new Promise(function(e,n){var r=java.nio.file.Files.newInputStream(t),i=new xn(r),o=new dt;return i.read(o).then(function(){e(o.toString())})["catch"](n)}):Promise.reject(new Error("File not found"))};var Pn=rn("setRequestProperty");function On(e,t){var n,r;(n=e,r=new xn(function(e){try{return e.getInputStream()}catch(e_){return e.getErrorStream()}}(n)),vn(r).then(function(e){return r.close(),e})).then(function(n){var r,i,o;t({status:e.getResponseCode(),headers:(r=e,i={},o=r.getHeaderFields(),P(o.keySet().toArray(),function(e){i[String(e)]=String(o.get(e).get(0))}),i),responseText:n})})}function jn(e,t){var n=new java.net.URL(e.url).openConnection();n.setRequestMethod(e.method),Pn(n,e.headers),function(e,t){if(t){e.setDoOutput(!0);var n=new Sn(e.getOutputStream());return n.write(t).then(function(){n.close()})}return Promise.resolve()}(n,e.data).then(function(){On(n,t)})}function In(){}hn[h]=jn,hn[c]=jn,In.prototype={execute:t};var Nn=new In,Tn=new In;Nn.execute=function(e){e._readReject(e._readBuffer.shift())},Tn.execute=function(e){e._readResolve()};var Dn=Le({$class:"gpf.stream.BufferedRead",constructor:function(){this._readBuffer=[]},_readBuffer:[],_readWriteToStream:null,_readResolve:null,_readReject:null,_readDataIsToken:function(e){return e instanceof In&&(e.execute(this),!0)},_readWriteToOutput:function(){var e=this,t=e._readBuffer.shift();return e._readDataIsToken(t)?Promise.resolve():e._readWriteToStream.write(t).then(function(){if(e._readBuffer.length)return e._readWriteToOutput();e._readNotWriting=!0})},_readNotWriting:!0,_readSafeWrite:function(){var e=this;e._readNotWriting&&(e._readNotWriting=!1,e._readWriteToOutput().then(undefined,function(t){e._readReject(t)}))},_readCheckIfData:function(){this._readBuffer.length&&this._readSafeWrite()},_readCheckIfOutput:function(){this._readWriteToStream&&this._readCheckIfData()},_appendToReadBuffer:function(e){return this._readBuffer=this._readBuffer.concat([].slice.call(arguments)),this._readCheckIfOutput(),this},_completeReadBuffer:function(){this._readBuffer.push(Tn),this._readCheckIfOutput()},_setReadError:function(e){this._readBuffer.push(Nn,e),this._readCheckIfOutput()},read:lt(function(e){var t=this;return t._readWriteToStream=e,t._readCheckIfData(),new Promise(function(e,n){t._readResolve=e,t._readReject=n})})});ut(Dn);var Cn,An=/\r\n/g,Rn=(Le({$class:"gpf.stream.LineAdapter",$extend:Dn,constructor:function(){this.$super(),this._buffer=[]},write:ht(function(e){return this._buffer.push(e.toString()),this._process(),Promise.resolve()}),flush:function(){return this._buffer.length&&(this._buffer.push("\n"),this._process()),this._completeReadBuffer(),Promise.resolve()},_buffer:[],_consolidateLines:function(){return this._buffer.join("").replace(An,"\n").split("\n")},_pushBackLastLineIfNotEmpty:function(e){var t=e.pop();t.length&&this._buffer.push(t)},_process:function(){var e=this,t=e._consolidateLines();e._buffer.length=0,e._pushBackLastLineIfNotEmpty(t),P(t,function(t){e._appendToReadBuffer(t)})}}),Ze("FlushableStream",{"flush":0}));Cn=_===u?function(e){return pn({method:en.GET,url:e}).then(function(e){return e.responseText})}:function(e){return bt(Ot(".",e))};var kn={};function $n(t,n){return r={gpf:Object.create(e),promise:Promise.resolve(),_initialDefine:null},i=Vn(t,{base:jt(n)}),r._initialDefine=i.define,i.define=function(){var e=this.gpf.require,t=this._initialDefine;return this.promise=t.apply(e,arguments),e.define=t,this.promise}.bind(r),r.gpf.require=i,r;var r,i}kn[".json"]=function(e,t){return JSON.parse(t)},we(0,{noCommonJSDynamicRequire:"Dynamic require not supported"});var Fn=/[^.]\brequire\b\s*\(\s*(?:['|"]([^"']+)['|"]|[^)]+)\s*\)/g;var Mn=[null,function(e){return{dependencies:[],factory:e[0]}},function(e){return{dependencies:e[0],factory:e[1]}},function(e){return{dependencies:e[1],factory:e[2]}}];function Bn(t,n,r){var i={};return C(["gpf","define","module","require"],n)(t,function(e,t,n){var r=Mn[arguments.length](arguments);this.require.define(r.dependencies,function(e){return e.length=r.dependencies.length,r.factory.apply(null,[].slice.call(e))})}.bind(t),i,function(t){return r[t]||e.Error.noCommonJSDynamicRequire()}),i.exports}function qn(e){return"clearCache"===e?-1:1}kn[".js"]=function(e,t){var n=$n(this,e);return function(e,t){var n=Ne(Fn,t);return n.length?$n(this,e).gpf.require.define(n.map(function(e){return e[1]}).filter(function(e){return e}).reduce(function(e,t){return e[t]=t,e},{}),function(e){return e}):Promise.resolve({})}.call(this,e,t).then(function(e){var r=Bn(n.gpf,t,e);return undefined===r?n.promise:r})},we(0,{invalidRequireConfigureOption:"Invalid configuration option"});var Wn={base:function(e){this.base=e},cache:function(e){P(Object.keys(e),function(t){this.cache[t]=an(e[t])},this)},clearCache:function(){this.cache={}}};function Un(e){return Ot(this.base,e)}function Ln(e){var t;return this.cache[e]?this.cache[e]:(t=function(e){var t=this;return Cn(e).then(function(n){var r=kn[Pt(e).toLowerCase()];return r?r.call(t,e,n):n})}.call(this,e),this.cache[e]=t,t)}function Vn(t,n){var r=Object.create(t),i={};return i.define=function(e,t){var n=this,r=[],i=Object.keys(e);return P(i,function(t){r.push(Ln.call(n,Un.call(n,e[t])))},n),Promise.all(r).then(function(e){var n,r;return"function"==typeof t?(r={},P(i,function(t,n){r[t]=e[n]}),n=t(r)):n=t,n})}.bind(r),i.resolve=Un.bind(r),i.configure=function(t){var n=this;P(Object.keys(t).sort(function(e,t){return qn(e)-qn(t)}),function(r){(Wn[r]||e.Error.invalidRequireConfigureOption).call(n,t[r])},n)}.bind(r),n&&i.configure(n),i}e.require=Vn({base:"",cache:{}});var Gn=Le({$class:"gpf.stream.ReadableArray",constructor:function(e){this._buffer=e},read:lt(function(e){var t=this._buffer,n=0;return function r(){return t.length===n?Promise.resolve():e.write(t[n++]).then(r)}()}),_buffer:[]}),Hn=Le({$class:"gpf.stream.WritableArray",constructor:function(){this._buffer=[]},write:ht(function(e){return this._buffer.push(e),Promise.resolve()}),toArray:function(){return this._buffer},_buffer:[]});ut(Gn),ut(Hn);var zn={flush:Promise.resolve.bind(Promise)};function Zn(e){return Ge(Rn,e)||zn}function Qn(e,n){var r,i=rt(e),o=it(e),a=Zn(e),s=it(n),u=Zn(n),c=!0,f=t;function l(){if(c)try{c=!1,i.read(s).then(function(){c=!0},function(e){r=e,f(e)})}catch(e_){r=e_}}function h(){if(r)return Promise.reject(r)}return l(),{flush:function(){return h()||a.flush().then(function(){return u.flush()})},write:function(e){return l(),h()||(n=o.write(e),new Promise(function(e,r){n.then(function(n){e(n),f=t},r),f=r}));var n}}}function Jn(e){return e.length>1?function(e){for(var t=e.length-1,n=e[t];t>0;)n=Qn(e[--t],n);return n}(e):it(e[0])}e.stream.pipe=function(e,t){var n=rt(e),r=Jn([].slice.call(arguments,1)),i=Zn(r);try{return n.read(r).then(function(){return i.flush()})}catch(e_){return Promise.reject(e_)}},R.regexp={"\\":"\\\\","-":"\\-","[":"\\[","]":"\\]","/":"\\/","{":"\\{","}":"\\}","(":"\\(",")":"\\)","*":"\\*","+":"\\+","?":"\\?",".":"\\.","^":"\\^","$":"\\$","|":"\\|"},we(0,{invalidCSV:"Invalid CSV syntax (bad quote sequence or missing end of file)"}),e.stream.csv={};var Yn=";,\t ".split("");Le({$class:"gpf.stream.csv.Parser",$extend:Dn,constructor:function(e){this._readParserOptions(e),this._header?this._parseHeader():this._write=this._writeHeader},_readParserOptions:function(e){var t=this;e&&P(["header","separator","quote","newLine"],function(n){e[n]&&(t["_"+n]=e[n])})},_header:"",_separator:"",_deduceSeparator:function(){var e=this._header;this._separator=j(Yn,function(t){if(-1!==e.indexOf(t))return t})||Yn[0]},_quote:'"',_newLine:"\n",_columns:[],_buildParsingHelpers:function(){this._unescapeDictionary={},this._unescapeDictionary[this._quote+this._quote]=this._quote,this._parser=new RegExp(A("^(?:([^QS][^S]*)|Q((?:[^Q]|QQ)+)Q)(?=$|S)",{Q:k(this._quote,"regexp"),S:k(this._separator,"regexp")}))},_parseHeader:function(){this._separator||this._deduceSeparator(),this._columns=this._header.split(this._separator),this._buildParsingHelpers(),this._write=this._writeContent},_writeHeader:function(e){this._header=e,this._parseHeader()},_values:[],_content:"",_unescapeQuoted:function(e){return A(e,this._unescapeDictionary)},_addValue:function(e){e[1]?this._values.push(e[1]):this._values.push(this._unescapeQuoted(e[2]))},_nextValue:function(e){return this._content=this._content.substr(e),this._content.length>0},_checkAfterValue:function(e){return this._content.charAt(e[0].length)?this._nextValue(e[0].length+1):(delete this._content,!1)},_extractValue:function(){var e=this._parser.exec(this._content);return!!e&&(this._addValue(e),this._checkAfterValue(e))},_checkForValue:function(){return this._content.charAt(0)===this._separator?(this._values.push(""),this._nextValue(1)):this._extractValue()},_parseValues:function(){for(;this._checkForValue(););},_parseContent:function(){if(this._parseValues(),!this._content)return this._values},_processContent:function(e){return this._content?this._content=this._content+this._newLine+e:(this._values=[],this._content=e),this._parseContent()},_getRecord:function(e){var t={};return P(this._columns,function(n,r){e[r]!==undefined&&(t[n]=e[r])}),t},_writeContent:function(e){var t=this._processContent(e);t&&this._appendToReadBuffer(this._getRecord(t))},write:ht(function(e){return this._write(e),Promise.resolve()}),flush:function(){if(this._content){var t=new e.Error.InvalidCSV;return this._setReadError(t),Promise.reject(t)}return this._completeReadBuffer(),Promise.resolve()}});e.attributes={};var Xn=Le({$class:"gpf.attributes.Attribute"});we(0,{unknownAttributesSpecification:"Unknown attributes specification",invalidAttributesSpecification:"Invalid attributes specification"});var Kn="attributes",er=/^\[([^\]]+)\]$|./,tr=ke.prototype._checkMemberName,nr=ke.prototype._checkMemberValue,rr=ke.prototype._check$Property;function ir(e){return er.exec(e)[1]}Object.assign(ke.prototype,{_hasInheritedMember:function(e){return this._extend&&this._extend.prototype[e]!==undefined},_hasMember:function(e){return this._initialDefinition.hasOwnProperty(e)||this._hasInheritedMember(e)},_checkAttributeMemberExist:function(t){this._hasMember(t)||e.Error.unknownAttributesSpecification()},_checkMemberName:function(e){var t=ir(e);t?(tr.call(this,t),this._checkAttributeMemberExist(t)):tr.call(this,e)},_checkAttributesSpecification:function(t){S(t)||e.Error.invalidAttributesSpecification(),P(t,function(t){t instanceof Xn||e.Error.invalidAttributesSpecification()})},_checkMemberValue:function(e,t){ir(e)?this._checkAttributesSpecification(t):nr.call(this,e,t)},_check$Property:function(e,t){Kn===e?this._checkAttributesSpecification(t):rr.call(this,e,t)}}),ke.prototype._allowed$Properties.push(Kn);var or=ke.prototype._addMemberToPrototype,ar=ke.prototype._buildPrototype,sr="$"+Kn;Object.assign(ke.prototype,{_attributes:{},_addAttributesFor:function(e,t){this._attributes[e]=t},_addMemberToPrototype:function(e,t,n){var r=ir(t);r?this._addAttributesFor(r,n):or.call(this,e,t,n)},_buildPrototype:function(e){var t=this._initialDefinition[sr];this._attributes={},t&&this._addAttributesFor(sr,t),ar.call(this,e)}}),Object.assign(ke.prototype,{_collectAttributes:function(e,t){E(this._attributes,function(n,r){var i,o,a,s,u,c=(i=n,(o=t)?i.filter(function(e){return e instanceof o}):i);c.length&&(u=c,(a=e)[s=r]=(a[s]||[]).concat(u))}),this._extendDefinition&&this._extendDefinition._collectAttributes(e,t)},getAttributes:function(e){var t={};return this._collectAttributes(t,e),t}}),e.attributes.get=function(e,t){return"function"!=typeof e&&(e=e.constructor),n=t,(r=Re(e))?r.getAttributes(n):{};var n,r};var ur={},cr=Le({$class:"gpf.stream.AbstractOperator",_dataInPromise:undefined,_dataInResolve:t,_dataOutResolve:t,_dataOutReject:t,_waitForData:function(){var e=this;return e._dataInPromise||(e._dataInPromise=new Promise(function(t){e._dataInResolve=t}).then(function(t){return delete e._dataInPromise,delete e._dataInResolve,t})),e._dataInPromise},_writeData:function(e){var t=this;return t._waitForData(),t._dataInResolve(e),new Promise(function(e,n){t._dataOutResolve=e,t._dataOutReject=n}).then(function(e){return delete t._dataOutResolve,delete t._dataOutReject,e},function(e){return delete t._dataOutResolve,delete t._dataOutReject,Promise.reject(e)})},read:lt(function(e){var t=this;return t._waitForData().then(function(n){return ur!==n?e.write(n).then(t._dataOutResolve,t._dataOutReject):(t._dataOutResolve(),Promise.resolve())})}),_process:De(1),write:ht(function(e){return this._process(e)}),flush:function(){return this._dataInPromise?this._writeData(ur):Promise.resolve()}});ut(cr);Le({$class:"gpf.stream.Filter",$extend:cr,constructor:function(e){this._filter=e},_process:function(e){return this._filter(e)?this._writeData(e):Promise.resolve()}}),Le({$class:"gpf.stream.Map",$extend:cr,constructor:function(e){this._map=e},_process:function(e){return this._writeData(this._map(e))}})});