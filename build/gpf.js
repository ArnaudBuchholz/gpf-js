!function(a,b){"use strict";if("function"==typeof define&&define.amd)define(["exports"],b);else if("undefined"!=typeof exports)b(exports);else if("undefined"!=typeof module&&module.exports)b(module.exports);else{var c={};b(c),a.gpf=c}}(this,function(a){"use strict";function b(){}function c(a,b,c){var d,e=a.length;for(d=0;d<e;++d)b.call(c,a[d],d,a)}function d(a,b,c){for(var d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)}function e(a,b,c){d(a,b,c),["constructor","toString"].forEach(function(d){a.hasOwnProperty(d)&&b.call(c,a[d],d,a)})}function f(a){_b&&console.warn("ASSERTION FAILED: "+a)}function g(b,c){b||(f(c),a.Error.assertionFailed({message:c}))}function h(a,b){void 0===b&&(b="Assertion with no message",a=!1),g(a,b)}function i(a){$b(a,g)}function j(a,b){var c;return 0===a.length?ac(b):(c=[].concat(a),c.push(b),ac.apply(null,c))}function k(a,b){return j(a,b)}function l(a,b){return void 0===b&&(b=a,a=[]),k(a,b)}function m(a){return a.charAt(0).toUpperCase()+a.substr(1)}function n(a,b){var c=a;return $b(b,function(a,b){c=c.split(b).join(a)}),c}function o(a,b){return"javascript"===b?'"'+a+'"':a}function p(a,b){return o(n(a,bc[b]),b)}function q(a,b){$b(b,function(b,c){void 0===a[c]&&(a[c]=b)})}function r(a,b){b&&q(a.prototype,b)}function s(a,b){b&&q(a,b)}function t(a,b){var c=b.on;r(c,b.methods),s(c,b.statics)}function u(a,b){return void 0!==b?a.bind(b):a}function v(a,b){for(var c=a.length,d=0;d<c;)a.hasOwnProperty(d)&&b(a[d],d,a),++d}function w(a,b,c){for(var d=a.length;c<d;){if(a.hasOwnProperty(c)&&!0!==b(a[c],c,a))return!1;++c}return!0}function x(a,b){return w(a,b,0)}function y(a,b){var c,d=b.length;for(c=0;c<d;++c)a.push(b.charAt(c))}function z(a){var b=[];return"string"==typeof a?y(b,a):c(a,function(a){b.push(a)},0),b}function A(a){var b=z(a),c=arguments[1];return"function"==typeof c&&(b=b.map(c,arguments[2])),b}function B(a){return 0===a?[]:new Array(a).join(" ").split(" ").map(function(a,b){return"p"+b})}function C(a){var b=["var C = this, l = arguments.length;","if (0 === l) { return new C();}"];return a.forEach(function(c,d){var e=d+1;b.push("if ("+e+" === l) { return new C("+a.slice(0,e).join(", ")+");}")}),b.join("\r\n")}function D(a){var b=B(a);return l(b,C(b))}function E(a,b){return b.length>cc.length&&(cc=D(b.length)),cc.apply(a,b)}function F(a){return 10>a?"0"+a:a}function G(a){if(a[1]<12&&a[2]<32&&a[3]<24&&a[4]<60&&a[5]<60)return a}function H(a,b){b?a.push(parseInt(b,10)):a.push(0)}function I(a){var b,c=[],d=a.length;for(b=1;b<d;++b)H(c,a[b]);return c}function J(a){var b;if(a)return b=I(a),--b[1],G(b)}function K(a){if("string"==typeof a)return dc.lastIndex=0,J(dc.exec(a))}function L(){var a=arguments[0],b=K(a);return b?new ec(ec.UTC.apply(ec.UTC,b)):E(ec,arguments)}function M(){var a,b,c=["prototype","UTC","parse","now"],d=c.length;for(a=0;a<d;++a)b=c[a],L[b]=ec[b]}function N(){M();var a=!1;try{var b=new Date("2003-01-22T22:45:34.075Z"),c=new Date("2003-01-22");a=2003===b.getUTCFullYear()&&0===b.getUTCMonth()&&22===b.getUTCDate()&&22===b.getUTCHours()&&45===b.getUTCMinutes()&&34===b.getUTCSeconds()&&75===b.getUTCMilliseconds()&&2003===c.getUTCFullYear()&&0===c.getUTCMonth()&&22===c.getUTCDate()}catch(e_){}a||(Xb.Date=L)}function O(a){return"var me = this;\nreturn function ("+B(a).join(", ")+") {\n   var args = _gpfArrayPrototypeSlice.call(arguments, 0);\n    return me.apply(thisArg, prependArgs.concat(args));\n};"}function P(){var a=b.toString.call(this),c=a.indexOf("function"),d=a.indexOf("(",c);return a.substr(c+9,d-c-9).replace(gc,"").trim()}function Q(a,b){this[b]=a}function R(a,b,c){function d(a){return function(b){e&&(e=!1,a(b))}}var e=!0;try{a(d(b),d(c))}catch(e_){e&&(e=!1,c(e_))}}function S(){var a=this;a._handlers.forEach(function(b){b.process(a)}),a._handlers=[]}function T(a){var b=this;b._state=!1,b._value=a,S.call(b)}function U(a){var b=this;try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void R(c.bind(a),U.bind(b),T.bind(b))}b._state=!0,b._value=a,S.call(b)}catch(e_){T.call(b,e_)}}function V(){}function W(a,b){return a.dt-b.dt}function X(a,b){var c={id:++jc,dt:new Date((new Date).getTime()+b),cb:a};return ic.push(c),ic.sort(W),jc}function Y(a){var b;ic.every(function(c,d){return c.id!==a||(b=d,!1)})||ic.splice(b,1)}function Z(){for(var a,b,c=ic;c.length;)a=c.shift(),b=new Date,a.dt>b&&kc(a.dt-b),a.cb()}function $(a){return function(b,c){"function"!=typeof b&&a(ba(b),c)}}function _(a){var b,d;return b=a instanceof Array,d=[],b?(c(a,$(function(a){d.push(a)})),"["+d.join(",")+"]"):($b(a,$(function(a,b){d.push(p(b,"javascript")+":"+a)})),"{"+d.join(",")+"}")}function aa(a){return a.toString()}function ba(a){return nc[typeof a](a)}function ca(a){return l("return "+a)()}function da(a,b){if(void 0!==a)return a[b]}function ea(a,b){var c=a[b];return void 0===c&&(c=a[b]={}),c}function fa(b,c){var d;return"gpf"===b[0]?(d=a,b=b.slice(1)):d=Xb,b.reduce(c,d)}function ga(a,b){var c;return c=b?ea:da,fa(a,c)}function ha(a,b,c){function d(a){this._buildMessage(a)}return d.prototype=new oc,Object.assign(d.prototype,{code:a,name:b,message:c}),d.prototype.constructor=d,oc[m(b)]=d,function(a){throw new d(a)}}function ia(a,b,c){var d=ha(a,b,c);return d.CODE=a,d.NAME=b,d.MESSAGE=c,d}function ja(b,c){$b(c,function(b,c){var d=++pc;a.Error["CODE_"+c.toUpperCase()]=d,a.Error[c]=ia(d,c,b)})}function ka(a){return a.trim()}function la(a,b){var c=a.compatibleName();c&&(b.name=c)}function ma(a,b,c){a.length&&(c.parameters=/\(\s*(\w+(?:\s*,\s*\w+)*)\s*\)/.exec(b)[1].split(",").map(ka))}function na(a,b){var c=ka(/{((?:.*\n)*.*)}/.exec(a)[1]);c&&(b.body=c)}function oa(a,c){var d=b.toString.call(a).replace(gc,"");ma(a,d,c),na(d,c)}function pa(a){var b={};return la(a,b),oa(a,b),b}function qa(a){return a.name?" "+a.name:""}function ra(a){return a.parameters?a.parameters.join(", "):""}function sa(a){return a.body?a.body.toString():""}function ta(a){return"function"+qa(a)+"("+ra(a)+') {\n\t"use strict"\n'+sa(a)+"\n}"}function ua(a,b){var c=Object.keys(b),d=c.map(function(a){return b[a]});return l(c,"return "+a).apply(null,d)}function va(a,b){return ua(ta(a),b||{})}function wa(a){var b;return $b(qc,function(c,d){a["$"+d]&&(b=c)}),b}function xa(b){var c=qc[b.$type];return void 0===c&&a.Error.invalidEntityType(),c}function ya(a){var b,c=wa(a);return c||(c=xa(a)),b=new c(a),b.check(),b}function za(a){this._initialDefinition=a}function Aa(b){return va({parameters:B(b),body:"_throw_();"},{_throw_:a.Error.abstractMethod})}function Ba(b,c){-1===c.indexOf(b)&&a.Error.invalidEntity$Property()}function Ca(a,b){"$"===b.charAt(0)?this._check$Property(b.substr(1),a):this._checkProperty(b,a)}function Da(a){za.call(this,a)}function Ea(a){return"string"==typeof a?ga(a.split(".")):a}function Fa(a){var b=a._name;return{name:b,parameters:pa(a._resolvedConstructor).parameters,body:"if (!(this instanceof _classDef_._instanceBuilder)) gpf.Error.classConstructorFunction();\n_classDef_._resolvedConstructor.apply(this, arguments);"}}function Ga(b){return{gpf:a,_classDef_:b}}function Ha(a){return va(Fa(a),Ga(a))}function Ia(){a.Error.invalidClassSuper()}function Ja(a){var b=pa(a);return b.body="return _superMethod_.apply(this, arguments);",va(b,{_superMethod_:a})}function Ka(a){return"function"!=typeof a&&(a=Ia),Ja(a)}function La(a,b,c){var d=pa(c);return d.body="return _superMethod_.apply(this === _$super_ ? _that_ : this, arguments);",va(d,{_that_:a,_$super_:b,_superMethod_:c})}function Ma(b,c,d){return"function"!=typeof d&&a.Error.invalidClassSuperMember(),La(b,c,d)}function Na(a){for(var b=/\.\$super\.(\w+)\b/g,c=b.exec(a),d=[];c;)d.push(c[1]),c=b.exec(a);return d}function Oa(a){za.call(this,a)}function Pa(a){var b=a._name;return{name:b,body:"gpf.Error.interfaceConstructorFunction();"}}function Qa(b){return{gpf:a,_classDef_:b}}function Ra(a){return va(Pa(a),Qa(a))}function Sa(a){var b=ya(a);return b.getInstanceBuilder()}function Ta(a,b){return"function"!=typeof b||a.length!==b.length}function Ua(a,b){var c=!0;return $b(a.prototype,function(a,d){Ta(a,b[d])&&(c=!1)}),c}function Va(a,b){var c=b.queryInterface(a);return c}function Wa(b,c){if(Ua(a.interfaces.IUnknown,c))return Va(b,c)}function Xa(a,b){return Ua(a,b)?b:Wa(a,b)}function Ya(a){return"string"==typeof a?ga(a.split(".")):a}function Za(a){return a instanceof Function?a.prototype:a}function $a(a,b){var c={$interface:"gpf.interfaces.I"+a};return Object.keys(b).forEach(function(a){c[a]=Aa(b[a])}),Sa(c)}function _a(a){return"var "+a.map(function(a,b){return"a"+b+"=a."+a.property+",b"+b+"=b."+a.property}).join(",")+";"}function ab(a,b,c){return"string"===a?b+".localeCompare("+c+")":b+"-"+c}function bb(a,b){var c,d;return a.ascending===!1?(c="b"+b,d="a"+b):(c="a"+b,d="b"+b),"if("+c+"!=="+d+")return "+ab(a.type,c,d)+";"}function cb(a){return _a(a)+a.map(bb).join("")+"return 0;"}function db(a){return l(["a","b"],cb(a))}function eb(a,b){return function(c){return"("+c[a].map(rc).join(b)+")"}}function fb(a){return"/"+a.regexp+"/.exec("+rc(a.like)+")"}function gb(a){if("object"==typeof a)return Object.keys(a).filter(function(a){return-1<tc.indexOf(a)})[0]}function hb(a){return"return "+rc(a)}function ib(b){var c=Xa(uc,b);return c||a.Error.interfaceExpected({name:"gpf.interfaces.IWritableStream"}),c}function jb(a){a.prototype[vc]=!1}function kb(b){return function(c){var d=this;d[vc]&&a.Error.readInProgress();var e=ib(c);return d[vc]=!0,b.call(d,e).then(function(a){return d[vc]=!1,Promise.resolve(a)},function(a){return d[vc]=!1,Promise.reject(a)})}}function lb(b){return function(c){var d=this;return d[vc]&&a.Error.writeInProgress(),d[vc]=!0,b.call(d,c).then(function(a){return d[vc]=!1,Promise.resolve(a)},function(a){return d[vc]=!1,Promise.reject(a)})}}function mb(a){Ac=a}function nb(a){return-1<a.indexOf("\\")?a.toLowerCase().split("\\"):a.split("/")}function ob(a){a[a.length-1]||a.pop()}function pb(b){b.length?b.pop():a.Error.unreachablePath()}function qb(a){var b=nb(a);return ob(b),b}function rb(a){return qb(a).join("/")}function sb(a){return a?qb(a).pop():""}function tb(a,b){qb(b).forEach(function(b){".."===b?pb(a):a.push(b)})}function ub(a){var b=qb(a);return[].slice.call(arguments,1).forEach(tb.bind(null,b)),b.join("/")}function vb(a,b){for(;a[0]===b[0];)a.shift(),b.shift()}function wb(a,b){a.length*b.length&&vb(a,b)}function xb(a,b){var c,d=qb(a),e=qb(b);for(wb(d,e),c=d.length+1;--c;)e.unshift("..");return e.join("/")}function yb(a,b){var c,d=-1;return{reset:function(){return d=-1,Promise.resolve()},moveNext:function(){return++d,c=void 0,d<b.length?a.getInfo(b[d]).then(function(a){return c=a}):Promise.resolve()},getCurrent:function(){return c}}}function zb(a,b){return new Promise(function(c,d){Rb[a].apply(Rb,b.concat([function(a,b){a?d(a):c(b)}]))})}function Ab(a,b){return zb(a,[rb(b)])}function Bb(a,b){return zb("open",[rb(a),b.flags]).then(function(a){return new b.GpfStream(Rb[b.nodeStream]("",{fd:a,autoClose:!1}),zb.bind(null,"close",[a]))})}function Cb(a){return Bb(a,{flags:"r",GpfStream:Cc,nodeStream:"createReadStream"})}function Db(a){return Bb(a,{flags:"a",GpfStream:Dc,nodeStream:"createWriteStream"})}function Eb(a){return a.isFile()?yc.FILE:yc.UNKNOWN}function Fb(a){return a.isDirectory()?yc.DIRECTORY:Eb(a)}function Gb(a,b){return{type:b,fileName:a.Name.toLowerCase(),filePath:rb(a.Path),size:a.Size,createdDateTime:new Date(a.DateCreated),modifiedDateTime:new Date(a.DateLastModified)}}function Hb(a,b){return new Promise(function(c){Qb[a](qb(b).join("\\")),c()})}function Ib(a,b){return new Promise(function(c){Qb[a](qb(b).join("\\"),!0),c()})}function Jb(a){return Qb.FileExists(a)?Gb(Qb.GetFile(a),yc.FILE):{type:yc.NOT_FOUND}}function Kb(a){return Qb.FolderExists(a)?Gb(Qb.GetFolder(a),yc.DIRECTORY):Jb(a)}function Lb(a){for(var b=new Enumerator(a),c=[];!b.atEnd();b.moveNext())c.push(b.item().Path);return c}function Mb(a){var b;return Qb.FolderExists(a)?(b=Qb.GetFolder(a),Lb(b.SubFolders).concat(Lb(b.Files))):[]}var Nb,Ob,Pb,Qb,Rb,Sb,Tb="0.1.9",Ub={BROWSER:"browser",NODEJS:"nodejs",PHANTOMJS:"phantomjs",RHINO:"rhino",UNKNOWN:"unknown",WSCRIPT:"wscript"},Vb=Ub.UNKNOWN,Wb=!1,Xb=this,Yb=b;"undefined"!=typeof WScript?(Vb=Ub.WSCRIPT,Wb=!0):"undefined"!=typeof print&&"undefined"!=typeof java?(Vb=Ub.RHINO,Wb=!1):"undefined"!=typeof phantom&&phantom.version?(Vb=Ub.PHANTOMJS,Wb="\\"===require("fs").separator,Xb=window):"undefined"!=typeof module&&module.exports?(Vb=Ub.NODEJS,Sb=require("path"),Wb="\\"===Sb.sep,Xb=global):"undefined"!=typeof window&&(Vb=Ub.BROWSER,Xb=window),a.hosts={browser:Ub.BROWSER,nodejs:Ub.NODEJS,phantomjs:Ub.PHANTOMJS,rhino:Ub.RHINO,unknown:Ub.UNKNOWN,wscript:Ub.WSCRIPT},a.host=function(){return Vb},a.version=function(){return Tb},Ub.BROWSER===Vb&&(Yb=function(a){window.location="https://arnaudbuchholz.github.io/gpf/exit.html?"+(a||0)},Nb=window,Ob=document,Pb=Ob.getElementsByTagName("head")[0]||Ob.documentElement),Ub.NODEJS===Vb&&(Yb=function(a){process.exit(a)},a.node={}),Ub.PHANTOMJS===Vb&&(Yb=function(a){phantom.exit(a)},Nb=window,Ob=document,Pb=Ob.getElementsByTagName("head")[0]||Ob.documentElement),Ub.RHINO===Vb&&(Xb.console={log:function(a){print("    "+a)},info:function(a){print("[?] "+a)},warn:function(a){print("/!\\ "+a)},error:function(a){print("(X) "+a)}},Yb=function(a){java.lang.System.exit(a)}),Ub.WSCRIPT===Vb&&(Xb.console={log:function(a){WScript.Echo("    "+a)},info:function(a){WScript.Echo("[?] "+a)},warn:function(a){WScript.Echo("/!\\ "+a)},error:function(a){WScript.Echo("(X) "+a)}},Yb=function(a){WScript.Quit(a)},a.wscript={});var Zb=function(a){return Array.isArray(a)};Ub.BROWSER===Vb&&(Nb.HTMLCollection||Nb.NodeList)&&(Zb=function(a){return Array.isArray(a)||a instanceof Nb.HTMLCollection||a instanceof Nb.NodeList}),a.isArrayLike=Zb;var $b;$b=Ub.WSCRIPT===Vb?e:d,a.forEach=function(a,b,d){return Zb(a)?void c(a,b,d):void $b(a,b,d)};var _b=!0;a.assert=h,a.asserts=i,a.preventAssertWarnings=function(a){_b=!a};var ac=Function;"break,case,class,catch,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,let,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield".split(",");a.web={};var bc={};bc.javascript={"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r","\t":"\\t"},bc.xml={"&":"&amp;","<":"&lt;",">":"&gt;"},t("Array",{on:Array,methods:{every:function(a){return x(this,u(a,arguments[1]))},filter:function(a){var b=[];return a=u(a,arguments[1]),v(this,function(c,d,e){a(c,d,e)&&b.push(c)}),b},forEach:function(a){v(this,u(a,arguments[1]))},indexOf:function(a){var b=-1;return w(this,function(c,d){return c!==a||(b=d,!1)},arguments[1]||0),b},map:function(a){var b=new Array(this.length);return a=u(a,arguments[1]),v(this,function(c,d,e){b[d]=a(c,d,e)}),b},some:function(a){return a=u(a,arguments[1]),!x(this,function(b,c,d){return!a(b,c,d)})},reduce:function(a){var b,c=arguments[1],d=this.length,e=0;for(b=void 0===c?this[e++]:c;e<d;++e)b=a(b,this[e],e,this);return b}},statics:{from:A,isArray:function(a){return"[object Array]"==={}.toString.call(a)}}});var cc=D(10);t("Date",{on:Date,methods:{toISOString:function(){return this.getUTCFullYear()+"-"+F(this.getUTCMonth()+1)+"-"+F(this.getUTCDate())+"T"+F(this.getUTCHours())+":"+F(this.getUTCMinutes())+":"+F(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}});var dc=/^([0-9][0-9][0-9][0-9])\-([0-9][0-9])\-([0-9][0-9])(?:T([0-9][0-9])\:([0-9][0-9])\:([0-9][0-9])(?:\.([0-9][0-9][0-9])Z)?)?$/,ec=Xb.Date;N();var fc=Array.prototype.slice;t("Function",{on:Function,methods:{bind:function(a){var b=this,c=fc.call(arguments,1),d=O(Math.max(this.length-c.length,0));return l(["thisArg","prependArgs","_gpfArrayPrototypeSlice"],d).call(b,a,c,fc)}}});var gc=/\/\/.*$|\/\*(?:[^\*]*|\*[^\/]*)\*\//gm;!function(){function a(){}return"functionName"!==a.name}()?Function.prototype.compatibleName=function(){return this.name}:Function.prototype.compatibleName=P,t("Object",{on:Object,statics:{assign:function(a,b){return[].slice.call(arguments,1).forEach(function(b){$b(b,Q,a)}),a},create:function(){function a(){}return function(b){a.prototype=b;var c=new a;return a.prototype=null,c.__proto__||(c.__proto__=b),c}}(),getPrototypeOf:function(a){return a.__proto__?a.__proto__:a.constructor.prototype},keys:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c},values:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}}}),t("String",{on:String,methods:{trim:function(){var a=/^[\s\ufeff\xa0]+|[\s\ufeff\xa0]+$/g;return function(){return this.replace(a,"")}}()}});var hc=a.Promise=function(a){R(a,U.bind(this),T.bind(this))};V.prototype={onFulfilled:null,onRejected:null,resolve:null,reject:null,process:function(a){var b=this;return null===a._state?(a.hasOwnProperty("_handlers")||(a._handlers=[]),void a._handlers.push(b)):void setTimeout(function(){var c,d;if(c=a._state?b.onFulfilled:b.onRejected,null===c)return void(a._state?b.resolve(a._value):b.reject(a._value));try{d=c(a._value)}catch(e_){return void b.reject(e_)}b.resolve(d)},0)}},hc.prototype={_state:null,_value:null,_handlers:[],then:function(a,b){var c=this;return new hc(function(d,e){var f=new V;void 0!==a&&(f.onFulfilled=a),void 0!==b&&(f.onRejected=b),f.resolve=d,f.reject=e,f.process(c)})},"catch":function(a){return this.then(null,a)}},hc.resolve=function(a){return new hc(function(b){b(a)})},hc.reject=function(a){return new hc(function(b,c){c(a)})},hc.all=function(a){return 0===a.length?hc.resolve([]):new hc(function(b,c){function d(f,g){try{if(f&&f instanceof hc)return void f.then(function(a){d(a,g)},c);a[g]=f,0===--e&&b(a)}catch(e_){c(e_)}}var e=a.length;a.forEach(d)})},hc.race=function(a){return new hc(function(b,c){a.forEach(function(a){a.then(b,c)})})},void 0===Xb.Promise&&(Xb.Promise=hc);var ic=[],jc=0,kc=b;a.handleTimeout=b,"undefined"==typeof setTimeout&&(Ub.WSCRIPT===Vb?kc=function(a){WScript.Sleep(a)}:Ub.RHINO===Vb?kc=java.lang.Thread.sleep:console.warn("No implementation for setTimeout"),Xb.setTimeout=X,Xb.clearTimeout=Y,a.handleTimeout=Z);var lc,mc,nc={undefined:b,"function":b,number:aa,"boolean":aa,string:function(a){return p(a,"javascript")},object:function(a){return null===a?"null":_(a)}};"undefined"==typeof JSON?(lc=ba,mc=ca,Xb.JSON={stringify:lc,parse:mc}):(lc=JSON.stringify,mc=JSON.parse),a.context=function(a){return void 0===a?Xb:ga(a.split("."))},a.extend=Object.assign,bc.html=Object.assign({},bc.xml,{"\xe0":"&agrave;","\xe1":"&aacute;","\xe8":"&egrave;","\xe9":"&eacute;","\xea":"&ecirc;"});var oc=a.Error=function(){};oc.prototype=new Error,Object.assign(oc.prototype,{constructor:oc,code:0,name:"Error",message:"",_buildMessage:function(a){var b;a&&(b={},$b(a,function(a,c){b["{"+c+"}"]=a.toString()}),this.message=n(this.message,b))}});var pc=0;ja("error",{notImplemented:"Not implemented",assertionFailed:"Assertion failed: {message}",invalidParameter:"Invalid parameter"}),ja("define/detect",{invalidEntityType:"Invalid entity type"});var qc={};za.prototype={constructor:za,_initialDefinition:{}},ja("abstract",{abstractMethod:"Abstract method"}),ja("define/check",{invalidEntity$Property:"Invalid entity $ property",missingEntityName:"Missing entity name",invalidEntityNamespace:"Invalid entity namespace"}),Object.assign(za.prototype,{_type:"",_allowed$Properties:"type,name,namespace".split(","),_check$Property:function(a,b){a!==this._type&&Ba(a,this._allowed$Properties)},_throwInvalidProperty:Aa(0),_reMemberName:/.*/,_checkMemberName:function(a){this._reMemberName.exec(a)||this._throwInvalidProperty()},_reservedNames:"super,class,public,private,protected,static,mixin".split(","),_checkReservedMemberName:function(a){-1!==this._reservedNames.indexOf(a)&&this._throwInvalidProperty()},_checkMemberValue:l(["name","value"]," "),_checkProperty:function(a,b){this._checkMemberName(a),this._checkReservedMemberName(a),this._checkMemberValue(a,b)},_checkProperties:function(){$b(this._initialDefinition,Ca,this)},_name:"",_readName:function(){var a=this._initialDefinition;this._name=a["$"+this._type]||a.$name},_checkNameIsNotEmpty:function(){this._name||a.Error.missingEntityName()},_throwInvalidName:Aa(0),_reName:/.*/,_checkName:function(){this._reName.exec(this._name)||this._throwInvalidName()},_namespace:"",_extractRelativeNamespaceFromName:function(){var a=/(.*)\.([^\.]+)$/.exec(this._name);if(a)return this._name=a[2],a[1]},_readNamespace:function(){var a=[this._initialDefinition.$namespace,this._extractRelativeNamespaceFromName()].filter(function(a){return a});a.length>0&&(this._namespace=a.join("."))},_checkNamespace:function(){/^(:?[a-z_$][a-zA-Z0-9]+(:?\.[a-z_$][a-zA-Z0-9]+)*)?$/.exec(this._namespace)||a.Error.invalidEntityNamespace()},check:function(){this._checkProperties(),this._readName(),this._checkNameIsNotEmpty(),this._readNamespace(),this._checkName(),this._checkNamespace()}}),Object.assign(za.prototype,{_instanceBuilder:null,getInstanceBuilder:function(){return this._instanceBuilder||this._setInstanceBuilder(this._build()),this._instanceBuilder},_setInstanceBuilder:function(a){this._namespace&&(ga(this._namespace.split("."),!0)[this._name]=a),this._instanceBuilder=a},_build:b}),Da.prototype=Object.create(za.prototype),Object.assign(Da.prototype,{constructor:Da,_type:"class"}),qc["class"]=Da,ja("define/class/check",{invalidClassName:"Invalid class name",invalidClassProperty:"Invalid class property",invalidClassExtend:"Invalid class extend",invalidClassConstructor:"Invalid class constructor",invalidClassOverride:"Invalid class override"}),Object.assign(Da.prototype,{_allowed$Properties:za.prototype._allowed$Properties.concat(["extend"]),_throwInvalidProperty:a.Error.invalidClassProperty,_reMemberName:/^[a-z_][a-zA-Z0-9]*$/,_checkConstructorMember:function(b){"function"!=typeof b&&a.Error.invalidClassConstructor()},_checkOverridenMember:function(b,c){typeof b!=typeof c&&a.Error.invalidClassOverride()},_checkIfOverriddenMember:function(a,b){var c=this._extend.prototype[a];void 0!==c&&this._checkOverridenMember(b,c)},_checkMemberValue:function(a,b){"constructor"===a?this._checkConstructorMember(b):this._checkIfOverriddenMember(a,b)},_reName:/^[A-Z_$][a-zA-Z0-9]*$/,_throwInvalidName:a.Error.invalidClassName,_extend:Object,_readExtend:function(){var a=Ea(this._initialDefinition.$extend);a&&(this._extend=a)},_checkExtendIsNotAnInterface:function(){-1!==b.toString.call(this._extend).indexOf("interfaceConstructorFunction")&&a.Error.invalidClassExtend()},_checkExtend:function(){"function"!=typeof this._extend&&a.Error.invalidClassExtend(),this._checkExtendIsNotAnInterface()},check:function(){this._readExtend(),this._checkExtend(),za.prototype.check.call(this)}}),ja("define/class/constructor",{"classConstructorFunction":"This is a class constructor function, use with new"}),Object.assign(Da.prototype,{_resolvedConstructor:b}),ja("define/class/super",{invalidClassSuper:"Invalid class super",invalidClassSuperMember:"Invalid class super member"}),Object.assign(Da.prototype,{_get$Super:function(a,b,c){var d=this._extend.prototype,e=Ka(d[b]);return c.forEach(function(b){e[b]=Ma(a,e,d[b])}),e},_superifiedBody:'var _super_;\nif (this.hasOwnProperty("$super")) {\n    _super_ = this.$super;\n}\nthis.$super = _classDef_._get$Super(this, _methodName_, _superMembers_);\ntry{\n    var _result_ = _method_.apply(this, arguments);\n} finally {\n    if (undefined === _super_) {\n        delete this.$super;\n    } else {\n        this.$super = _super_;\n    }\n}\nreturn _result_;',_getSuperifiedContext:function(a,b,c){return{_method_:a,_methodName_:b,_superMembers_:c,_classDef_:this}},_createSuperified:function(a,b,c){var d=pa(a);return d.body=this._superifiedBody,va(d,this._getSuperifiedContext(a,b,c))},_superify:function(a,b){return /\.\$super\b/.exec(a)?this._createSuperified(a,b,Na(a)):a}}),Object.assign(Da.prototype,{_build:function(){var a,b;return this._resolveConstructor(),a=Ha(this),b=Object.create(this._extend.prototype),a.prototype=b,b.constructor=a,this._buildPrototype(b),a},_addMethodToPrototype:function(a,b,c){a[b]=this._superify(c,b)},_addMemberToPrototype:function(a,b,c){"function"==typeof c?this._addMethodToPrototype(a,b,c):a[b]=c},_buildPrototype:function(a){$b(this._initialDefinition,function(b,c){"$"!==c.charAt(0)&&"constructor"!==c&&this._addMemberToPrototype(a,c,b)},this)},_setResolvedConstructorToInherited:function(){this._extend!==Object&&(this._resolvedConstructor=this._extend)},_resolveConstructor:function(){this._initialDefinition.hasOwnProperty("constructor")?this._resolvedConstructor=this._superify(this._initialDefinition.constructor,"constructor"):this._setResolvedConstructorToInherited()}}),Oa.prototype=Object.create(za.prototype),Object.assign(Oa.prototype,{constructor:Oa,_type:"interface"}),qc.interface=Oa,ja("define/interface/check",{invalidInterfaceName:"Invalid interface name",invalidInterfaceProperty:"Invalid interface property"}),Object.assign(Oa.prototype,{_throwInvalidProperty:a.Error.invalidInterfaceProperty,_reMemberName:/^[a-z][a-zA-Z0-9]*$/,_reservedNames:za.prototype._reservedNames.concat("constructor"),_checkMemberValue:function(b,c){"function"!=typeof c&&a.Error.invalidInterfaceProperty()},_reName:/^I[a-zA-Z0-9]*$/,_throwInvalidName:a.Error.invalidInterfaceName}),ja("define/interface/constructor",{"interfaceConstructorFunction":"This is an interface constructor function, do not invoke"}),Object.assign(Oa.prototype,{_build:function(){var a,b;return a=Ra(this),b=a.prototype,delete b.constructor,this._buildPrototype(b),a},_buildPrototype:function(a){$b(this._initialDefinition,function(b,c){"$"!==c.charAt(0)&&(a[c]=b)},this)}}),a.define=Sa,ja("interfaces",{interfaceExpected:"Expected interface not implemented: {name}"});a.interfaces={isImplementedBy:function(a,b){return!!b&&Ua(Ya(a),Za(b))},query:function(a,b){return Xa(Ya(a),b)}};$a("Unknown",{"queryInterface":1}),a.createSortFunction=function(a){return Array.isArray(a)||(a=[a]),db(a)};var rc,sc={property:function(a){return"i."+a.property},eq:eb("eq","==="),ne:eb("ne","!=="),lt:eb("lt","<"),lte:eb("lte","<="),gt:eb("gt",">"),gte:eb("gte",">="),not:function(a){return"!"+rc(a.not)},like:function(a){var b=fb(a);return a.group?"("+b+"||[])["+a.group+"]":b},or:eb("or","||"),and:eb("and","&&"),undefined:function(a){return JSON.stringify(a)}},tc=Object.keys(sc);rc=function(a){var b=gb(a),c=sc[b];return c(a)},a.createFilterFunction=function(a){return l(["i"],hb(a))};var uc=($a("ReadableStream",{"read":1}),$a("WritableStream",{"write":1}));$a("Enumerator",{"reset":0,"moveNext":0,"getCurrent":0}),$a("FileStorage",{"getInfo":1,"openTextStream":2,"close":1,"explore":1,"createDirectory":1,"deleteFile":1,"deleteDirectory":1}),ja("stream",{readInProgress:"A read operation is already in progress",writeInProgress:"A write operation is already in progress",invalidStreamState:"Stream is in an invalid state"}),a.stream={};var vc="gpf.stream#inProgress",wc=Sa({$class:"gpf.stream.ReadableString",constructor:function(a){this._buffer=a},read:kb(function(a){return a.write(this._buffer)}),_buffer:""}),xc=Sa({$class:"gpf.stream.WritableString",constructor:function(){this._buffer=[]},write:lb(function(a){return this._buffer.push(a.toString()),Promise.resolve()}),toString:function(){return this._buffer.join("")},_buffer:[]});jb(wc),jb(xc),ja("fs",{incompatibleStream:"Incompatible stream"});var yc={NOT_FOUND:0,DIRECTORY:1,FILE:2,UNKNOWN:3},zc={READING:0,APPENDING:1},Ac=null;if(a.fs={types:{notFound:yc.NOT_FOUND,directory:yc.DIRECTORY,file:yc.FILE,unknown:yc.UNKNOWN},openFor:{reading:zc.READING,appending:zc.APPENDING},getFileStorage:function(){return Ac}},ja("path",{unreachablePath:"Unreachable path"}),a.path={join:ub,parent:function(a){return a=qb(a),pb(a),a.join("/")},name:sb,nameOnly:function(a){var b=sb(a),c=b.lastIndexOf(".");return-1===c?b:b.substr(0,c)},extension:function(a){var b=sb(a),c=b.lastIndexOf(".");return-1===c?"":b.substr(c)},relative:xb},Ub.NODEJS===Vb)var Bc=Sa({$class:"gpf.node.BaseStream",constructor:function(a,b){this._stream=a,"function"==typeof b&&(this._close=b),a.on("error",this._onError.bind(this))},_close:b,close:function(){return this._close()},_stream:null,_invalid:!1,_reject:a.Error.invalidStreamState,_checkIfValid:function(){this._invalid&&a.Error.invalidStreamState()},_onError:function(a){this._invalid=!0,this._reject(a)}}),Cc=Sa({$class:"gpf.node.ReadableStream",$extend:"gpf.node.BaseStream",read:kb(function(a){var b=this,c=b._stream;return new Promise(function(d,e){b._reject=e,b._checkIfValid(),c.on("data",b._onData.bind(b,a)).on("end",function(){b._invalid=!0,d()})})}),_onData:function(a,b){var c=this,d=c._stream;d.pause(),a.write(b).then(function(){d.resume()},c._reject)}}),Dc=Sa({$class:"gpf.node.WritableStream",$extend:"gpf.node.BaseStream",write:lb(function(a){var b=this,c=b._stream;return new Promise(function(d,e){return b._reject=e,b._checkIfValid(),c.write(a)?d():void c.once("drain",d)})})});var Ec=Sa({$class:"gpf.node.FileStorage",constructor:function(){Rb||(Rb=require("fs"))},getInfo:function(a){return a=rb(a),new Promise(function(b){Rb.exists(a,b)}).then(function(b){return b?Ab("stat",a).then(function(b){return{fileName:Sb.basename(a),filePath:rb(Sb.resolve(a)),size:b.size,createdDateTime:b.ctime,modifiedDateTime:b.mtime,type:Fb(b)}}):{type:yc.NOT_FOUND}})},openTextStream:function(a,b){return zc.READING===b?Cb(a):Db(a)},close:function(b){return b instanceof Bc?b.close():Promise.reject(new a.Error.IncompatibleStream)},explore:function(a){var b=this;return Ab("readdir",a).then(function(c){return yb(b,c.map(function(b){return ub(a,b)}))})},createDirectory:Ab.bind(null,"mkdir"),deleteFile:Ab.bind(null,"unlink"),deleteDirectory:Ab.bind(null,"rmdir")});if(Ub.NODEJS===Vb&&mb(new Ec),Ub.WSCRIPT===Vb)var Fc=Sa({$class:"gpf.wscript.BaseStream",constructor:function(a){this._file=a},close:function(){return new Promise(function(a){this._file.Close(),a()}.bind(this))}}),Gc=Sa({$class:"gpf.wscript.ReadableStream",$extend:"gpf.wscript.BaseStream",read:kb(function(a){var b=this,c=b._file;return new Promise(function(b){function d(){return a.write(c.Read(4096)).then(function(){if(!c.AtEndOfStream)return d()})}return d().then(b)})})}),Hc=Sa({$class:"gpf.wscript.WritableStream",$extend:"gpf.wscript.BaseStream",write:lb(function(a){var b=this,c=b._file;return new Promise(function(b){c.Write(a),b()})})});var Ic=Sa({$class:"gpf.wscript.FileStorage",constructor:function(){Qb||(Qb=new ActiveXObject("Scripting.FileSystemObject"))},getInfo:function(a){return Promise.resolve(Kb(qb(a).join("\\")))},openTextStream:function(a,b){return a=qb(a).join("\\"),new Promise(function(c){var d;d=zc.READING===b?new Gc(Qb.OpenTextFile(a,1,!1)):new Hc(Qb.OpenTextFile(a,8,!0)),c(d)})},close:function(b){return b instanceof Fc?b.close():Promise.reject(new a.Error.IncompatibleStream)},explore:function(a){return Promise.resolve(yb(this,Mb(qb(a).join("\\"))))},createDirectory:Hb.bind(null,"CreateFolder"),deleteFile:Ib.bind(null,"DeleteFile"),deleteDirectory:Ib.bind(null,"DeleteFolder")});Ub.WSCRIPT===Vb&&mb(new Ic)});