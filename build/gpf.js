(function(e,l){if("function"===typeof define&&define.amd)define(["exports"],l);else if("undefined"!==typeof exports)l(exports);else if("undefined"!==typeof module&&module.exports)l(module.exports);else{var L={};l(L);e.gpf=L}})(this,function(e){function l(){}function L(a,b){if(void 0!==a)return a[b]}function hb(a,b){var c=a[b];void 0===c&&(c=a[b]={});return c}function M(a,b){var c,d;c=b?hb:L;"gpf"===a[0]?(d=e,a=a.slice(1)):d=k;return a.reduce(c,d)}function X(a,b){a=a.split(".");var c=a.pop(),d=M(a,
!0),f=!0,e;d[c]=function(){f&&(e=b(a),d[c]=e,f=!1);return e.apply(this,arguments)}}function ib(){var a=Function.prototype.toString.apply(this),b=a.indexOf("function"),c=a.indexOf("(",b);return a.substr(b+9,c-b-9).replace(xa,"").trim()}function ya(a,b,c){function d(a){return function(b){f&&(f=!1,a(b))}}var f=!0;try{a(d(b),d(c))}catch(e){f&&(f=!1,c(e))}}function za(){var a=this;a._handlers.forEach(function(b){b.process(a)});a._handlers=[]}function Y(a){this._state=!1;this._value=a;za.call(this)}function Aa(a){try{p(a!==
this,"A promise cannot be resolved with itself.");if(a&&("object"===typeof a||"function"===typeof a)){var b=a.then;if("function"===typeof b){ya(b.bind(a),Aa.bind(this),Y.bind(this));return}}this._state=!0;this._value=a;za.call(this)}catch(c){Y.apply(this,[c])}}function Ba(){}function Ca(){return!1}function y(a,b){var c;void 0===b&&(b=a,a=[]);p("string"===typeof b&&b.length,"Source expected (or use _gpfEmptyFunc)");if(0===a.length)return Da(b);c=[].concat(a);c.push(b);return Da.apply(null,c)}function Z(a,
b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function Ea(a){var b=typeof a;if("function"===b)return 1===a.length;if("object"!==b)return!1;a=a.dispatchEvent;return"function"===typeof a?1===a.length:!0}function Fa(a,b,c){var d=a.scope;"function"===typeof b.dispatchEvent?b=b.dispatchEvent.bind(b):"function"===typeof b?b=b.bind(d):(d=b[a.type]||b["*"]||l,b=d.bind(b.scope||b));b(a);void 0!==c&&c(a)}function h(a,b,c){var d=null===this||"object"!==typeof this?k:this;p(Ea(c),"Expected a valid event handler");
a instanceof E||(a=new e.events.Event(a,b,d));return new Promise(function(b){10<++Ga?setTimeout(Fa.bind(null,a,c,b),0):(Fa(a,c),b(a));--Ga})}function w(a,b,c){for(var d in a)a.hasOwnProperty(d)&&b.apply(c,[a[d],d,a])}function Ha(a){return a.charAt(0).toUpperCase()+a.substr(1)}function N(a,b){var c=a;w(b,function(a,b){c=c.split(b).join(a)});return c}function aa(a,b){a=N(a,jb[b]);"javascript"===b&&(a='"'+a+'"');return a}function kb(a,b){this[0][b]=a}function lb(a,b){var c=this[0],d=this[2];void 0===
c[b]?c[b]=a:d(c,b,a)}function H(a,b,c){var d;void 0===c?d=kb:(p("function"===typeof c,"Expected function"),d=lb);w(b,d,arguments);return a}function mb(a){return a.trim()}function Ia(a){this.parameters=[];void 0!==a&&this._extract(a)}function Ja(a){this._pending=[];this._done=[];!0===a?this._haveDifferentPrototypes=Ca:this._alike=Ca}function nb(a,b,c){return function(d){var f=new ba,e;f.code=a;f.name=b;d?(e={},w(d,function(a,b){e["{"+b+"}"]=a.toString()}),d=N(c,e)):d=c;f.message=d;return f}}function z(a,
b){var c,d;g(a);for(c in b)if(b.hasOwnProperty(c)){d=++ob;e.Error["CODE_"+c.toUpperCase()]=d;var f=e.Error,q=c,m=c,h=b[c],k=nb(d,m,h);k.CODE=d;k.NAME=m;k.MESSAGE=h;f[q]=k}}function Ka(a,b){O[b]=a;void 0===P[a]&&(P[a]=b)}function La(a,b){w(b,function(b,d){var f=a+d;0===b?Ka(f,"."+d):"string"===typeof b?b.split(",").forEach(function(a){Ka(f,"."+a)}):La(f+"/",b)})}function pb(a){a=O[a.toLowerCase()];void 0===a&&(a="application/octet-stream");return a}function qb(a){a=P[a.toLowerCase()];void 0===a&&(a=
".bin");return a}function Ma(){null===O&&(O={},P={},La("",rb))}function sb(a,b){return a.dt-b.dt}function tb(a,b){p("number"===typeof b,"Timeout is required");var c={id:++Na,dt:new Date((new Date).getTime()+b),cb:a};I.push(c);I.sort(sb);return Na}function ub(a){var b;I.every(function(c,d){return c.id===a?(b=d,!1):!0})||I.splice(b,1)}function vb(){for(var a=I,b,c;a.length;)b=a.shift(),c=new Date,b.dt>c&&ca(b.dt-c),b.cb()}function Oa(a,b,c){var d=c.length;c=c.pad;var f;f=e.bin.isPow2(a.length);if(-1<
f&&(void 0===d||32>=d*f)){var q=[],m,g,h;g=(1<<(void 0===d?32:d*f)-f)-1;for(m=(1<<f)-1;0!==b;)h=b&m,q.unshift(a.charAt(h)),b=b>>f&g;f=q}else{f=b;b=[];for(q=a.length;0!==f;)m=f%q,b.unshift(a.charAt(m)),f=(f-m)/q;f=b}if(void 0!==d)for(void 0===c&&(c=a.charAt(0));f.length<d;)f.unshift(c.charAt(f.length%c.length));else 0===f.length&&(f=[a.charAt(0)]);return f.join("")}function Pa(a,b,c){var d=a.length,f=0,e=0;for(void 0===c&&(c=a.charAt(0));e<b.length&&-1!==c.indexOf(b.charAt(e));)++e;for(;e<b.length;)f=
d*f+a.indexOf(b.charAt(e++));return f}function Qa(a){return a.toString()}function Ra(a){var b=wb[typeof a];if(void 0!==b)return b(a);if(null===a)return"null";var c,d,f,b=a instanceof Array;c=[];for(d in a)"function"!==typeof a[d]&&(f=Ra(a[d]),b?c.push(f):c.push(aa(d,"javascript")+":"+f));a=b?"["+c.join(",")+"]":"{"+c.join(",")+"}";return a}function xb(a){return y("return "+a)()}function B(a){if(-1<a.indexOf("/"))a=a.split("/");else if(-1<a.indexOf("\\"))a=a.toLowerCase().split("\\");else return[a];
a.length&&!a[a.length-1]&&a.pop();return a}function da(a){a=B(a);return a[a.length-1]}function ea(a){return a.split("*")}function Q(a){"!"===a.charAt(0)&&(this.negative=!0,a=a.substr(1));var b=a.indexOf("**");-1===b?this.start=a.split("/").map(ea):(0<b&&(p("/"===a.charAt(b-1),"** must be preceded by /"),this.start=a.substr(0,b-1).split("/").map(ea)),b<a.length-2&&(p("/"===a.charAt(b+2),"** must be followed by /"),this.end=a.substr(b+3).split("/").map(ea).reverse()))}function Sa(a){return a instanceof
Q?a:new Q(a)}function Ta(a){return a instanceof Array?a.map(Sa):[Sa(a)]}function yb(a){var b=a.negative;return a.match(this.parts)?(this.result=!b,!1):b?(this.result=!0,!1):!0}function zb(a){var b=a.length-1;return"\r"===a.charAt(b)?a.substr(0,b):a}function Ua(a,b){b=b||{};this._lines=a.split("\n").map(zb);var c=b.header||this._lines.shift(),d;if(!(d=b.separator))a:{var f;for(d=0;4>d;++d)if(f=";,\t ".charAt(d),-1!==c.indexOf(f)){d=f;break a}d=";"}this._separator=d;this._quote=b.quote||'"';this._columns=
c.split(this._separator)}function fa(a){return"constructor"===a?"constructor ":a}function R(a){return"constructor "===a?"constructor":a}function Ab(a){return function(){a.isConstructionAllowed()&&a._resolvedConstructor.apply(this,arguments)}}function Va(a){return!a.toString().split("._super").every(function(a){return-1!=="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".indexOf(a.charAt(0))})}function Wa(a,b){return function(){var c=this._super,d;this._super=a;try{d=b.apply(this,
arguments)}finally{void 0===c?delete this._super:this._super=c}return d}}function J(a,b,c){this._uid=++Bb;Xa[this._uid]=this;this._Subs=[];"function"===typeof a?(this._name=a.compatibleName()||"anonymous",this._Constructor=a):(this._name=a,this._Super=b,this._definition=c,this._build())}function r(a){var b;b=a[ga];void 0===b?(b=new J(a),a[ga]=b._uid):b=Xa[b];return b}function Ya(a,b,c){ha({"name is required (String)":"string"===typeof a,"base is required (String|Function)":"string"===typeof b||b instanceof
Function,"definition is required (Object)":"object"===typeof c});var d,f;-1<a.indexOf(".")&&(d=a.split("."),f=d.pop(),d=M(d,!0));"string"===typeof b&&(b=M(b.split(".")),p(b instanceof Function,"base must resolve to a function"));a=(new J(a,b,c))._Constructor;void 0!==d&&(d[f]=a);return a}function Cb(a,b){var c=this[b];void 0!==c&&(this[a]=c,delete this[b])}function C(a,b,c){w(Db,Cb,c);return Ya(a,b,c)}function Za(a,b){a+=".";b=a+b;return function(c,d,f){void 0===f&&"object"===typeof d&&(f=d,d=b);
-1===c.indexOf(".")&&(c=a+c);return C(c,d||b,f||{})}}function Eb(a,b){b="$"+b;e[b]=function(){var c=y("return function "+b+"(args) {this.constructor.apply(this, args);};")();c.prototype=a.prototype;return function(){return new c(arguments)}}()}function $a(a){return y(["idx"],"return this."+a+"[idx];")}function u(a,b,c){var d="$"===a.charAt(0),f;d?(a=a.substr(1),f=a+"Attribute"):f=a;b=Fb(f,b,c);d&&Eb(b,a);return b}function Gb(){return this._MEMBER_}function Hb(a){var b=this._MEMBER_;this._MEMBER_=
a;return b}function ab(a,b){var c,d,f,e;c=a.toString().split("_MEMBER_").join(b);f=c.indexOf("(")+1;e=c.indexOf(")",f)-1;d=c.substr(f,e-f+1).split(",").map(function(a){return a.trim()});f=c.indexOf("{")+1;e=c.lastIndexOf("}")-1;c=c.substr(f,e-f+1);return y(d,c)}function ia(a,b){var c,d,f,e;for(c in b.prototype)if("constructor"!==c&&(d=b.prototype[c],f=a[c],e=typeof f,typeof d!==e||"function"===e&&d.length!==f.length))return!1;return!0}function ja(a,b,c){var d=null;if(ia(a,b))return a;ia(a,e.interfaces.IUnknown)&&
(d=a.queryInterface(b));if(null===d&&(void 0===c||c))throw e.Error.interfaceExpected({name:r(b)._name});return d}function ka(a){var b;return(new e.attributes.Map(this)).getMemberAttributes("Class").filter(e.attributes.InterfaceImplementAttribute).every(function(c){b=c._builder;return c._interfaceDefinition!==a||!b})?null:"function"===typeof b?b(this):this[b]()}function Ib(a){return function(b){g(b);var c=ka.apply(this,arguments);null===c&&(c=a.apply(this,arguments));return c}}function bb(a){var b=
-1;return{reset:function(){b=-1},moveNext:function(c){var d;++b;d=b<a.length;!d&&c&&h.apply(this,["endOfData",{},c]);return d},current:function(){return a[b]}}}function Jb(a){var b=(new n.Map(a)).filter(n.EnumerableAttribute).getMembers();return bb(a[b[0]])}function Kb(a){return function(b,c,d){function f(a,b){h(a,b||{},d)}function q(a){"error"===a.type&&f(a);0===--g&&f("endOfData")}function m(c){var d=c.type;2===d?(++g,a.explore(c.filePath,function(a){"error"===a.type?f(a):v.IEnumerator.each(a.get("enumerator"),
m,q)})):1===d&&(c=c.filePath,c=e.path.relative(b,c),k(l,c)&&f("data",{path:c}))}var g=0,k=e.path.match,l=e.path.compileMatchPattern(c);a.getInfo(b,function(a){"error"===a.type?f(a):m(a.get("info"))})}}function F(a,b){this._readable=ja(a.readable,v.IReadableStream,!0);this._writable=ja(a.writable,v.IWritableStream,!0);void 0!==a.chunkSize&&(this._chunkSize=a.chunkSize);this._eventsHandler=b}function la(a,b){(new F(a,b)).ready()}function cb(a,b){var c,d=b;c=a.length;for(var f=0,e;0<d&&f<c;)if(e=a[f],
e=e.length,e<=d)++f,d-=e;else break;c=f;p(c<=a.length,"itemsCount within strings range");c=0<c?a.splice(0,c):[];a.length&&d&&(f=a.shift(),c.push(f.substr(0,d)),a.unshift(f.substr(d)));return c.join("")}var x="unknown",k=this,ma,g=l,G=l,na=!1,oa=!1,K,S,pa;"undefined"!==typeof WScript?(x="wscript",k=function(){return this}.apply(null,[]),G=function(a){WScript.Quit(a)},k.console={log:function(a){WScript.Echo("    "+a)},info:function(a){WScript.Echo("[?] "+a)},warn:function(a){WScript.Echo("/!\\ "+a)},
error:function(a){WScript.Echo("(X) "+a)}}):"undefined"!==typeof print&&"undefined"!==typeof java?(x="rhino",k=function(){return this}.apply(null,[]),G=function(a){java.lang.System.exit(a)},k.console={log:function(a){print("    "+a)},info:function(a){print("[?] "+a)},warn:function(a){print("/!\\ "+a)},error:function(a){print("(X) "+a)}}):"undefined"!==typeof phantom&&phantom.version?(x="phantomjs",require("fs"),k=window,oa=na=!0,G=phantom.exit):"undefined"!==typeof module&&module.exports?(x="nodejs",
require("path"),k=global,na=!0,G=process.exit):"undefined"!==typeof window&&(x="browser",k=window,oa=!0,G=l,K=window,S=document,pa=S.getElementsByTagName("head")[0]||S.documentElement);ma=k.gpf;e.noConflict=function(){void 0===ma?delete k.gpf:k.gpf=ma;return e};na&&(e.node={});e.web={};e.version=function(){return"0.1.5-alpha"};e.host=function(){return x};e.context=function(a){return void 0===a?k:M(a.split("."))};e.loaded=function(a){a&&a();return!0};var p,ha;ha=p=l;var db=Array.prototype.slice,qa=
{Array:{on:Array.prototype,every:function(a,b){var c=this.length,d;for(d=0;d<c;++d)if(!a.apply(b,[this[d],d,this]))return!1;return!0},filter:function(a,b){var c=[],d=this.length,f,e;for(f=0;f<d;++f)e=this[f],a.apply(b,[this[f],f,this])&&c.push(e);return c},forEach:function(a,b){var c=this.length,d;for(d=0;d<c;++d)a.apply(b,[this[d],d,this])},indexOf:function(a,b){for(var c=b||0,d=this.length;c<d;){if(this[c]===a)return c;++c}return-1},map:function(a,b){var c=this.length,d=Array(c),f;for(f=0;f<c;++f)d[f]=
a.apply(b,[this[f],f,this]);return d},reduce:function(a,b){var c=this.length,d=0,f;for(f=void 0===b?this[d++]:b;d<c;++d)f=a(f,this[d],d,this);return f}},Function:{on:Function.prototype,bind:function(a){var b=this,c=db.apply(arguments,[1,arguments.length+1]);return function(){var d=db.apply(arguments,[0,arguments.length+1]);b.apply(a,c.concat(d))}}},Object:{on:Object,create:function(){function a(){}return function(b){a.prototype=b;var c=new a;a.prototype=null;c.__proto__||(c.__proto__=b);return c}}(),
getPrototypeOf:function(a){return a.__proto__||a.constructor.prototype}},String:{on:String.prototype,trim:function(){var a=RegExp("^[\\s\ufeff\u00a0]+|[\\s\ufeff\u00a0]+$","g");return function(){return this.replace(a,"")}}()}};(function(){var a,b;for(a in qa)if(qa.hasOwnProperty(a)){b=qa[a];var c=b.on,d=void 0;for(d in b)b.hasOwnProperty(d)&&"on"!==d&&void 0===c[d]&&(c[d]=b[d])}})();var xa=RegExp("//.*$|/\\*(?:[^\\*]*|\\*[^/]*)\\*/","gm");(function(){return"functionName"!==function(){}.name})()?Function.prototype.compatibleName=
ib:Function.prototype.compatibleName=function(){return this.name};var t=e.Promise=function(a){ya(a,Aa.bind(this),Y.bind(this))};Ba.prototype={onFulfilled:null,onRejected:null,resolve:null,reject:null,process:function(a){var b=this;null===a._state?(a.hasOwnProperty("_handlers")||(a._handlers=[]),a._handlers.push(b)):setTimeout(function(){var c,d;c=a._state?b.onFulfilled:b.onRejected;if(null===c)a._state?b.resolve(a._value):b.reject(a._value);else{try{d=c(a._value)}catch(f){b.reject(f);return}b.resolve(d)}},
0)}};t.prototype={_state:null,_value:null,_handlers:[],then:function(a,b){var c=this;return new t(function(d,f){var e=new Ba;void 0!==a&&(e.onFulfilled=a);void 0!==b&&(e.onRejected=b);e.resolve=d;e.reject=f;e.process(c)})},"catch":function(a){return this.then(null,a)}};t.resolve=function(a){return new t(function(b){b(a)})};t.reject=function(a){return new t(function(b,c){g(b);c(a)})};t.all=function(a){return 0===a.length?t.resolve([]):new t(function(b,c){function d(e,m){try{e&&e instanceof t?e.then(function(a){d(a,
m)},c):(a[m]=e,0===--f&&b(a))}catch(g){c(g)}}var f=a.length;a.forEach(d)})};t.race=function(a){return new t(function(b,c){a.forEach(function(a){a.then(b,c)})})};void 0===k.Promise&&(k.Promise=t);var Da=Function,Lb="break case class catch const continue debugger default delete do else export extends finally for function if import in instanceof let new return super switch this throw try typeof var void while with yield".split(" ");Z(e,{HOST_BROWSER:"browser",HOST_NODEJS:"nodejs",HOST_PHANTOMJS:"phantomjs",
HOST_RHINO:"rhino",HOST_UNKNOWN:"unknown",HOST_WSCRIPT:"wscript"});e.events={isValidHandler:Ea};var E=e.events.Event=function(a,b,c){this.type=a;this.scope=null===c||"object"!==typeof c?k:c;void 0!==b&&(this._params=b)};E.prototype={constructor:E,type:"",scope:null,_params:{},get:function(a){return this._params[a]}};var Ga=0;E.prototype.fire=function(a){return h.apply(this,[this,{},a])};e.events.fire=function(a,b,c){g(a,b,c);var d;this!==e.events&&(d=this);void 0===c&&(c=b,b={});return h.apply(d,
[a,b,c])};e.events.getPromiseHandler=function(a){return new Promise(function(b,c){a(function(a){"error"===a.type?c(a.get("error")):b(a)})})};Z(e.events,{EVENT_ANY:"*",EVENT_ERROR:"error",EVENT_READY:"ready",EVENT_DATA:"data",EVENT_END_OF_DATA:"endOfData",EVENT_CONTINUE:"continue",EVENT_STOP:"stop",EVENT_STOPPED:"stopped"});oa&&(e.web.include=function(){function a(a,b){this.id=++f;this.url=a;this.eventsHandler=b;e[this.id]=this}function b(){var a=e[this.id.substr(12)];a&&a.check(this)}function c(){var a=
e[this.id.substr(12)];a&&a.failed(this)}function d(a){pa.insertBefore(a,pa.firstChild)}var f=0,e={};a.prototype={id:0,url:"",eventsHandler:null,clean:function(a){var b=a.parentNode;a.onerror=a.onload=a.onreadystatechange=null;b&&b.removeChild(a);delete e[this.id]},check:function(a){var b=a.readyState;if(!b||-1<["loaded","complete"].indexOf(b))this.clean(a),setTimeout(h,0,"ready",{url:this.url},this.eventsHandler)},failed:function(a){this.clean(a);setTimeout(h,0,"error",{url:this.url},this.eventsHandler)}};
return function(f,e){var q=new a(f,e),g=S.createElement("script");g.language="javascript";g.src=f;g.id="gpf-include-"+q.id;g.onload=g.onreadystatechange=b;g.onerror=c;void 0!==g.async&&(g.async=!0);setTimeout(d,0,g)}}());var T;T="browser"===x&&(K.HTMLCollection||K.NodeList)?function(a){return a instanceof Array||a instanceof K.HTMLCollection||a instanceof K.NodeList}:function(a){return a instanceof Array};e.isArrayLike=T;e.forEach=function(a,b,c){if(T(a)){var d,f=a.length;for(d=0;d<f;++d)b.apply(c,
[a[d],d,a])}else w(a,b,c)};var jb={javascript:{"\\":"\\\\",'"':'\\"',"\n":"\\n","\r":"\\r","\t":"\\t"},xml:{"&":"&amp;","<":"&lt;",">":"&gt;"},html:{"&":"&amp;","<":"&lt;",">":"&gt;","\u00e9":"&eacute;","\u00e8":"&egrave;","\u00ea":"&ecirc;","\u00e1":"&aacute;","\u00e0":"&agrave;"}};e.extend=H;var Mb={"boolean":function(a,b,c){g(c);if("string"===b)return"yes"===a||"true"===a?!0:0!==parseInt(a,10);if("number"===b)return 0!==a},number:function(a,b,c){g(c);if("string"===b)return parseFloat(a)},string:function(a,
b,c){g(b,c);return a.toString()},object:function(a,b,c){g(a,b,c)}};e.value=function(a,b,c){var d=typeof a;c||(c=typeof b);if(c===d)return a;if("undefined"===d)return b;a=Mb[c](a,d,b);return void 0===a?b:a};H(e,{clone:function(a){return JSON.parse(JSON.stringify(a))},test:function(a,b){var c;if(a instanceof Array)for(c=a.length;0<c;){if(a[--c]===b)return c}else for(c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c},set:function(a,b){p(a instanceof Array,"gpf.set must be used with an Array");for(var c=
a.length;0<c;)if(a[--c]===b)return a;a.push(b);return a},clear:function(a,b){var c;if(a instanceof Array)for(c=a.length;0<c;){if(a[--c]===b){a.splice(c,1);break}}else for(c in a)a.hasOwnProperty(c)&&a[c]===b&&delete a[c];return a},xor:function(a,b){return a&&!b||!a&&b}});e.exit=function(a){void 0===a&&(a=0);G(a)};Ia.prototype={isNative:!1,name:"",parameters:[],body:"",replaceInBody:function(a){this.body=N(this.body,a)},_extract:function(a){this.name=a.compatibleName();var b=Function.prototype.toString.call(a).replace(xa,
""),c;0<a.length?(a=b.indexOf("(")+1,c=b.indexOf(")",a)-1,this.parameters=b.substr(a,c-a+1).split(",").map(mb)):this.parameters=[];-1<b.indexOf("[native")?this.isNative=!0:(a=b.indexOf("{")+1,c=b.lastIndexOf("}")-1,this.body=b.substr(a,c-a+1))},generate:function(){return y("return "+this._toSource())()},_toSource:function(){return["function",this.name?" "+this.name:""," ("].concat(this.parameters).concat([") {\n",this.body,"\n}"]).join("")}};Ja.prototype={_pending:[],_done:[],_stack:function(a,b){var c=
this._done,d,f;for(d=c.indexOf(a);-1<d;){f=d%2?c[d-1]:c[d+1];if(f===b)return;d=c.indexOf(a,d+1)}c=this._pending;c.push(a);c.push(b)},_haveDifferentPrototypes:function(a,b){return a.constructor!==b.constructor},explore:function(){for(var a=this._pending,b=this._done,c,d;0!==a.length;)if(d=a.pop(),c=a.pop(),b.push(c,d),this._haveDifferentPrototypes(c,d)||this._checkMembersDifferences(c,d))return!1;return!0},_checkMembersDifferences:function(a,b){var c=0,d;for(d in a)if(a.hasOwnProperty(d)&&(++c,!this.like(a[d],
b[d])))return!0;for(d in b)b.hasOwnProperty(d)&&--c;return 0!==c},_downcast:function(a){return"object"===typeof a?a instanceof String?a.toString():a.valueOf():a},_alike:function(a,b){return this._downcast(a)===this._downcast(b)},like:function(a,b){if(a===b)return!0;if(typeof a!==typeof b)return this._alike(a,b);if(null===a||null===b||"object"!==typeof a)return!1;this._stack(a,b);return!0}};e.like=function(a,b,c){c=new Ja(c);return c.like(a,b)&&c.explore()};var ba=e.Error=function(){};ba.prototype=
{constructor:ba,code:0,name:"Error",message:""};var ob=0;z("boot",{notImplemented:"Not implemented",abstractMethod:"Abstract method",assertionFailed:"Assertion failed: {message}",invalidParameter:"Invalid parameter"});e.mixins={EventDispatcher:{addEventListener:function(a,b){var c;c=this._eventDispatcherListeners;c||(c=this._eventDispatcherListeners={});void 0===c[a]&&(c[a]=[]);c[a].push(b);return this},removeEventListener:function(a,b){var c=this._eventDispatcherListeners,d;c&&(c=c[a],void 0!==c&&
(d=c.indexOf(b),-1!==d&&c.splice(d,1)));return this},dispatchEvent:function(a,b){var c,d,f;if(!this._eventDispatcherListeners)return this;a instanceof E?(c=a,d=a.type):d=a;f=this._eventDispatcherListeners[d];if(void 0===f)return this;c||(c=new E(d,b,this));d=c;var e,g=f.length;for(e=0;e<g;++e)h.apply(d.scope,[d,{},f[e]]);return c}}};var rb={application:{javascript:"js"},image:{gif:0,jpeg:"jpg,jpeg",png:0},text:{css:0,html:"htm,html",plain:"txt,text,log"}},P=null,O=null;X("gpf.web.getMimeType",function(){Ma();
return pb});X("gpf.web.getFileExtension",function(){Ma();return qb});var I=[],Na=0,ca=l;e.handleTimeout=l;"undefined"===typeof setTimeout&&("wscript"===x?ca=function(a){WScript.Sleep(a)}:"rhino"===x?ca=java.lang.Thread.sleep:console.warn("No implementation for setTimeout"),k.setTimeout=tb,k.clearTimeout=ub,e.handleTimeout=vb);var U=987654321,V=(new Date).getTime()&4294967295;e.bin={pow2:function(a){if(31===a)return 2147483648;if(32===a)return 4294967296;if(31>a)return 1<<a;var b=4294967296;for(a-=
31;--a;)b*=2;return b},isPow2:function(a){if(0<a&&0===(a&a-1)){for(var b=0;1<a;)++b,a/=2;return b}return-1},toHexa:function(a,b,c){return Oa("0123456789ABCDEF",a,{length:b,pad:c})},fromHexa:function(a,b){return Pa("0123456789ABCDEF",a,b)},toBase64:function(a,b,c){return Oa("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a,{length:b,pad:c})},fromBase64:function(a,b){return Pa("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a,b)},test:function(a,b){return(a&b)===
b},clear:function(a,b){return a&~b},random:function(){U=36969*(U&65535)+(U>>16)&4294967295;V=18E3*(V&65535)+(V>>16)&4294967295;return((U<<16)+V&4294967295)+2147483647}};var ra,sa,wb={undefined:l,"function":l,number:Qa,"boolean":Qa,string:function(a){return aa(a,"javascript")}};"undefined"===typeof JSON?(ra=Ra,sa=xb,k.JSON={stringify:ra,parse:sa}):(ra=JSON.stringify,sa=JSON.parse);e.path={join:function(a){a=B(a);var b,c=arguments.length,d;for(b=1;b<c;++b){for(d=B(arguments[b]);".."===d[0];)if(d.shift(),
a.length)a.pop();else return"";d.length&&(a=a.concat(d))}return a.join("/")},parent:function(a){a=B(a);a.pop();return a.join("/")},name:da,nameOnly:function(a){a=da(a);var b=a.lastIndexOf(".");return-1===b?a:a.substr(0,b)},extension:function(a){a=da(a);var b=a.lastIndexOf(".");return-1===b?"":a.substr(b)},relative:function(a,b){a=B(a);b=B(b);for(var c;a.length&&b.length&&a[0]===b[0];)a.shift(),b.shift();for(c=a.length+1;--c;)b.unshift("..");return b.join("/")}};Q.prototype={constructor:Q,negative:!1,
start:null,end:null,_matchName:function(a,b){var c=a.length,d,f,e=0;for(d=0;d<c;++d)if(f=a[d])if(e=b.indexOf(f,e),-1===e||0===d&&0<e)return!1;return!f||e+f.length===b.length},_matchStart:function(a){var b=a.parts,c=b.length,d=a.startPos,f=this.start,e=f.length,g;for(g=0;g<e;++g)if(this._matchName(f[g],b[d])){if(++d>=c)return g===e-1&&!this.end}else return!1;a.startPos=d},_matchEnd:function(a){var b=a.parts;a=a.startPos;var c=b.length-1,d=this.end,f=d.length,e;for(e=0;e<f;++e)if(-1<c&&this._matchName(d[e],
b[c])){if(c--<a)return!1}else return!1},match:function(a){var b={parts:a,startPos:0};return this.start&&(a=this._matchStart(b),void 0!==a)||this.end&&(a=this._matchEnd(b),void 0!==a)?a:!0}};H(e.path,{match:function(a,b){var c=B(b),d=Ta(a),c={parts:c};d.every(yb,c);return c.result||!1},compileMatchPattern:function(a){return Ta(a)}});e.js={keywords:function(){return[].concat(Lb)}};z("csv",{csvInvalid:"Invalid CSV syntax (bad quote sequence or missing end of file)"});Ua.prototype={_lines:[],_separator:"",
_quote:"",_columns:[],_unquote:function(a){for(var b=this._quote,c=a.indexOf(b),d=!0;-1<c;){if(c===a.length-1){a=a.substr(0,c);d=!1;break}else if(a.charAt(c+1)===b)a=a.substr(0,c)+a.substr(c+1);else throw e.Error.csvInvalid();c=a.indexOf(b,c+1)}return[a,d]},_processQuotedLineValue:function(a,b,c){var d=a[b],f=[a[b-1]];c.includeCarriageReturn?f.push("\r\n"):f.push(this._separator);d=this._unquote(d);f.push(d[0]);c.inQuotedString=d[1];a[b-1]=f.join("");c.includeCarriageReturn=!1;a.splice(b,1);return b},
_processLineValue:function(a,b,c){var d=a[b];0===d.indexOf(this._quote)&&(c.inQuotedString=!0,d=this._unquote(d.substr(1)),a[b]=d[0],c.inQuotedString=d[1]);return b+1},_processLineValues:function(a,b,c){var d;c.inQuotedString?(c.includeCarriageReturn=!0,a.unshift(b.pop()),d=1):(d=0,c.includeCarriageReturn=!1);for(;d<a.length;)d=c.inQuotedString?this._processQuotedLineValue(a,d,c):this._processLineValue(a,d,c);[].splice.apply(b,[b.length,0].concat(a));return!c.inQuotedString},_readValues:function(){for(var a=
this._lines,b=this._separator,c=[],d={inQuotedString:!1,includeCarriageReturn:!1},f;a.length&&(f=a.shift().split(b),!this._processLineValues(f,c,d)););if(d.inQuotedString)throw e.Error.csvInvalid();return c},read:function(){var a=this._readValues(),b={};this._columns.forEach(function(c,d){b[c]=a[d]});return b},readAll:function(){for(var a=[];this._lines.length;)a.push(this.read());return a}};e.csv={parse:function(a,b){return(new Ua(a,b)).readAll()}};z("define",{classMemberOverloadWithTypeChange:"You can't overload a member and change its type",
classInvalidVisibility:"Invalid visibility keyword"});var ta=!0,Xa={},Bb=0,ga="_gpf_"+e.bin.toHexa(e.bin.random(),8),eb=["public","protected","private","static"];J.prototype={constructor:J,_uid:0,_name:"",_Super:Object,_Subs:[],_definitionAttributes:null,_Constructor:l,_definitionConstructor:null,_resolvedConstructor:l,_definition:null,isConstructionAllowed:function(){return ta},addMember:function(a,b,c){if(void 0===c)c=0;else if(c=eb.indexOf(c),-1===c)throw e.Error.classInvalidVisibility();this._addMember(a,
b,c)},_addMember:function(a,b,c){3===c?(p(void 0===this._Constructor[a],"Static members can't be overridden"),this._Constructor[a]=b):"constructor"===a?this._addConstructor(b,c):this._addNonStaticMember(a,b,c)},_addConstructor:function(a,b){ha({"Constructor must be a function":"function"===typeof a,"Own constructor can't be overridden":null===this._definitionConstructor});Va(a)&&(a=Wa(this._Super,a));g(b);this._definitionConstructor=a},_addNonStaticMember:function(a,b,c){var d=typeof b,f,q,m=this._Constructor.prototype;
p(!m.hasOwnProperty(a),"Existing own member can't be overridden");f=this._Super.prototype[a];q=typeof f;if("undefined"!==q){if(null!==f&&d!==q)throw e.Error.classMemberOverloadWithTypeChange();"function"===d&&Va(b)&&(b=Wa(f,b))}g(c);m[a]=b},_filterAttribute:function(a,b){var c;if("["!==a.charAt(0)||"]"!==a.charAt(a.length-1))return!1;a=fa(a.substr(1,a.length-2));this._definitionAttributes?c=this._definitionAttributes[a]:this._definitionAttributes={};void 0===c&&(c=[]);this._definitionAttributes[a]=
c.concat(b);return!0},_defaultVisibility:-1,_deduceVisibility:function(a){var b=this._defaultVisibility;-1===b&&(b="_"===a.charAt(0)?1:0);return b},_processDefinitionMember:function(a,b){if(!this._filterAttribute(b,a)){var c=eb.indexOf(b);if(-1===c)return this._addMember(b,a,this._deduceVisibility(b));if(-1!==this._defaultVisibility)throw e.Error.classInvalidVisibility();this._processDefinition(a,c)}},_processDefinition:function(a,b){this._defaultVisibility=b;w(a,this._processDefinitionMember,this);
this._defaultVisibility=-1;"wscript"===x&&a.constructor!==Object&&this._addConstructor(a.constructor,this._defaultVisibility)},_processAttributes:function(){var a=this._definitionAttributes,b,c;a&&(p("function"===typeof D,"Attributes can't be defined before they exist"),b=this._Constructor,c=b.prototype,w(a,function(a,f){f=R(f);f in c||"Class"===f?D(b,f,a):console.error("gpf.define: Invalid attribute name '"+f+"'")}))},_getNewClassConstructor:function(a){var b=new Ia(Ab);b.replaceInBody({"function":"function "+
a});return b.generate()(this)},_safeNewSuper:function(){var a;ta=!1;a=new this._Super;ta=!0;return a},_build:function(){var a,b;a=this._name.split(".").pop();this._Constructor=a=this._getNewClassConstructor(a);a[ga]=this._uid;b=this._safeNewSuper();a.prototype=b;b.constructor=a;r(this._Super)._Subs.push(a);this._processDefinition(this._definition,-1);this._processAttributes();this._resolveConstructor()},_resolveConstructor:function(){this._definitionConstructor?this._resolvedConstructor=this._definitionConstructor:
Object!==this._Super&&(this._resolvedConstructor=this._Super)}};var Db={"-":"private","#":"protected","+":"public","~":"static"};e.define=function(a,b,c){"object"===typeof b&&(c=b,b=void 0);void 0===b&&(b=Object);return Ya(a,b,c||{})};J.prototype._attributes=null;var n=e.attributes={},fb,Fb=Za("gpf.attributes","Attribute"),gb=C("gpf.attributes.Attribute",Object,{"#":{_member:"",_alterPrototype:function(a){g(a)}},"+":{getMemberName:function(){return this._member}}});C("gpf.attributes.Array",Object,
{"-":{_array:[]},"+":{constructor:function(){this._array=[]},getItemsCount:y("return this._array.length;"),getItem:$a("_array"),has:function(a){return!this._array.every(function(b){return!(b instanceof a)})},filter:function(a){var b=new n.Array;b._array=this._array.filter(function(b){return b instanceof a});return b},forEach:function(a,b){this._array.forEach(a,b)},every:function(a,b){return this._array.every(a,b)}}});fb=new n.Array;C("gpf.attributes.Map",Object,{"-":{_members:{},_count:0,_copy:function(a,
b,c){w(this._members,function(d,f){f=R(f);d._array.forEach(function(d){b&&!b(f,d,c)||a.add(f,d)})});return a},_filterCallback:function(a,b,c){g(a);return b instanceof c}},"+":{constructor:function(a){this._members={};a instanceof Function?this.fillFromClassDef(r(a)):void 0!==a&&this.fillFromObject(a)},fillFromClassDef:function(a){for(var b;a&&((b=a._attributes)&&b._copy(this),a=a._Super,a!==Object);)a=r(a);return this},fillFromObject:function(a){a=r(a.constructor);return this.fillFromClassDef(a)},
getCount:function(){return this._count},add:function(a,b){a=fa(a);var c=this._members[a];void 0===c&&(c=this._members[a]=new n.Array);c._array.push(b);++this._count},filter:function(a){return this._copy(new n.Map,this._filterCallback,a)},getMemberAttributes:function(a){a=fa(a);a=this._members[a];return void 0!==a&&a instanceof n.Array?a:fb},getMembers:function(){var a=[];w(this._members,function(b,c){g(b);a.push(R(c))});return a},forEach:function(a,b){w(this._members,function(c,d,f){a.apply(b,[c,
R(d),f])})}}});var D=n.add=function(a,b,c){c instanceof n.Array?c=c._array:c instanceof Array||(c=[c]);var d=r(a),f=d._attributes,e,g;f||(f=d._attributes=new n.Map);d=c.length;for(e=0;e<d;++e)g=c[e],p(g instanceof gb,"Expected attribute"),g._member=b,f.add(b,g),g._alterPrototype(a.prototype)};z("a_attributes",{onlyForAttributeClass:"The attribute {attributeName} can be used only on an Attribute class",onlyOnClassForAttributeClass:"The attribute {attributeName} must be used on Class",classOnlyAttribute:"The attribute {attributeName} can be used only for Class",
memberOnlyAttribute:"The attribute {attributeName} can be used only for members",uniqueAttributeConstraint:"Attribute {attributeName} already defined on {className}",uniqueMemberAttributeConstraint:"Attribute {attributeName} already defined on {className}::{memberName}"});var Nb=u("AttrClassOnlyAttribute",{"#":{_alterPrototype:function(a){if(!(a instanceof gb))throw e.Error.onlyForAttributeClass({attributeName:r(this.constructor)._name});if("Class"!==this._member)throw e.Error.onlyOnClassForAttributeClass({attributeName:r(this.constructor)._name});
}}}),W=u("AttrConstraintAttribute",Nb,{"~":{originalAlterPrototype:"_alterPrototype:checked"},"-":{_checkAndAlterPrototype:function(a){var b=this,c=n.AttrConstraintAttribute.originalAlterPrototype;(new n.Map(b)).filter(W).forEach(function(c){c.forEach(function(c){c._check(b,a)})});b[c](a)}},"#":{_check:function(a,b){g(a,b);throw e.Error.abstractMethod();},_alterPrototype:function(a){var b=n.AttrConstraintAttribute.originalAlterPrototype;this._super(a);void 0===a[b]&&(a[b]=a._alterPrototype,a._alterPrototype=
this._checkAndAlterPrototype)}}});u("$ClassAttribute",W,{"#":{_check:function(a,b){g(b);if("Class"!==a._member){var c=r(a.constructor);throw e.Error.classOnlyAttribute({attributeName:c._name});}}}});u("$MemberAttribute",W,{"#":{_check:function(a,b){g(b);if("Class"===a._member){var c=r(a.constructor);throw e.Error.memberOnlyAttribute({attributeName:c._name});}}}});u("$UniqueAttribute",W,{"-":{_classScope:!0},"#":{_check:function(a,b){var c,d,f,g,m=a._member;c=b.constructor;d=r(c);f=new n.Map(c);g=
a.constructor;c=r(g);f=f.filter(g);if(this._classScope){if(1<f.getCount())throw e.Error.uniqueAttributeConstraint({attributeName:c._name,className:d._name});}else if(1<f.getMemberAttributes(m).getItemsCount())throw e.Error.uniqueMemberAttributeConstraint({attributeName:c._name,className:d._name,memberName:m});}},"+":{constructor:function(a){void 0!==a&&(this._classScope=!0===a)}}});var ua=u("ClassAttribute");u("$ClassProperty",ua,{"[Class]":[e.$MemberAttribute(),e.$UniqueAttribute(!1)],"-":{_writeAllowed:!1,
_publicName:void 0,_visibility:void 0},"#":{_alterPrototype:function(a){var b=this._member,c=this._publicName,d=this._visibility;a=r(a.constructor);c||(c="_"===b.charAt(0)?b.substr(1):b);c=Ha(c);this._writeAllowed&&a.addMember("set"+c,ab(Hb,b),d);a.addMember("get"+c,ab(Gb,b),d)}},"+":{constructor:function(a,b,c){a&&(this._writeAllowed=!0);"string"===typeof b&&(this._publicName=b);"string"===typeof c&&(this._visibility=c)}}});u("$ClassEventHandler",ua,{"[Class]":[e.$MemberAttribute(),e.$UniqueAttribute(!1)]});
u("$ClassNonSerialized",ua,{"[Class]":[e.$MemberAttribute(),e.$UniqueAttribute(!1)]});z("interfaces",{interfaceExpected:"Expected interface not implemented: {name}"});var v=e.interfaces={isImplementedBy:function(a,b){a instanceof Function&&(a=a.prototype);return ia(a,b)},query:ja},A=Za("gpf.interfaces","Interface");C("gpf.interfaces.Interface",Object,{});A("IEventDispatcher",{addEventListener:function(a,b){g(a,b);return this},removeEventListener:function(a,b){g(a,b);return this},dispatchEvent:function(a,
b){g(a,b)}});var Ob=A("IUnknown",{queryInterface:function(a){g(a);return null}});u("$InterfaceImplement",{"-":{"[_interfaceDefinition]":[e.$ClassProperty(!1)],_interfaceDefinition:l,"[_builder]":[e.$ClassProperty(!1)],_builder:null,_addMissingInterfaceMembers:function(a){var b=this._interfaceDefinition.prototype,c;for(c in b)c in a||(a[c]=b[c])},_addQueryInterface:function(a){void 0===a.queryInterface?(a.queryInterface=ka,D(a.constructor,"Class",[e.$InterfaceImplement(Ob)])):ka!==a.queryInterface&&
(a.queryInterface=Ib(a.queryInterface))}},"#":{_alterPrototype:function(a){this._builder?this._addQueryInterface(a):(this._addMissingInterfaceMembers(a),(new e.attributes.Map).fillFromClassDef(r(this._interfaceDefinition)).forEach(function(b,c){D(a.constructor,c,b)}))}},"+":{constructor:function(a,b){this._interfaceDefinition=a;b&&(this._builder=b)}}});z("i_enumerator",{enumerableInvalidMember:"$Enumerator can be associated to arrays only"});A("IEnumerator",{reset:function(){},"[moveNext]":[e.$ClassEventHandler()],
moveNext:function(a){g(a);return!1},current:function(){return null},"~":{each:function(a,b,c){function d(b){h.apply(a,[b,{},c])}var f=v.query(a,v.IEnumerator),g;if(1<b.length)g=function(a){if(e.events.EVENT_CONTINUE===a.type){if(!f.moveNext(g))return}else{if(e.events.EVENT_STOP===a.type)return d(e.events.EVENT_STOPPED);if(e.events.EVENT_DATA!==a.type)return d(a.type)}b(f.current(),g)},f.moveNext(g)&&b(f.current(),g);else for(g=function(a){if(e.events.EVENT_DATA!==a.type)return d(a);do b(f.current());
while(f.moveNext(g))};f.moveNext(g);)b(f.current())},fromArray:bb}});u("$Enumerable",n.ClassAttribute,{Class:[e.$UniqueAttribute(),e.$MemberAttribute()],_alterPrototype:function(a){if(!T(a[this._member]))throw e.Error.enumerableInvalidMember();D(a.constructor,"Class",[new n.InterfaceImplementAttribute(v.IEnumerator,Jb)])}});var Pb=A("IReadOnlyArray",{getItemsCount:function(){return 0},getItem:function(a){g(a)}});A("IArray",Pb,{setItemsCount:function(a){g(a);return 0},setItem:function(a,b){g(a,b)}});
u("$ClassIArray",n.ClassAttribute,{"[Class]":[e.$UniqueAttribute(),e.$MemberAttribute()],"-":{_writeAllowed:!1},"#":{_alterPrototype:function(a){var b=this._member;D(a.constructor,"Class",[e.$InterfaceImplement(this._writeAllowed?v.IArray:v.IReadOnlyArray)]);a.getItemsCount=y("return this."+b+".length;");a.getItem=$a(b);this._writeAllowed&&(a.setItemsCount=y(["count"],["var oldValue = this.",b,".length;this.",b,".length = count;return oldValue;"].join("")),a.setItem=y(["idx","value"],["var oldValue = this.",
b,"[idx];this.",b,"[idx] = value;return oldValue;"].join("")))}},"+":{constructor:function(a){a&&(this._writeAllowed=!0)}}});D(n.Array,"_array",[e.$ClassIArray(!1)]);A("IReadableStream",{"[read]":[e.$ClassEventHandler()],read:function(a,b){g(a,b)}});A("IWritableStream",{"[write]":[e.$ClassEventHandler()],write:function(a,b){g(a,b)}});A("IFileStorage",{"[getInfo]":[e.$ClassEventHandler()],getInfo:function(a,b){g(a,b)},"[readAsBinaryStream]":[e.$ClassEventHandler()],readAsBinaryStream:function(a,b){g(a,
b)},"[writeAsBinaryStream]":[e.$ClassEventHandler()],writeAsBinaryStream:function(a,b){g(a,b)},close:function(a,b){g(a,b)},"[explore]":[e.$ClassEventHandler()],explore:function(a,b){g(a,b)},"[createFolder]":[e.$ClassEventHandler()],createFolder:function(a,b){g(a,b)},"[deleteFile]":[e.$ClassEventHandler()],deleteFile:function(a,b){g(a,b)},"[deleteFolder]":[e.$ClassEventHandler()],deleteFolder:function(a,b){g(a,b)}});z("fs",{fileNotFound:"File not found"});e.fs={host:function(){return null},find:l};
X("gpf.fs.find",function(){return Kb(e.fs.host())});Z(e.fs,{TYPE_NOT_FOUND:0,TYPE_FILE:1,TYPE_DIRECTORY:2,TYPE_UNKNOWN:99});z("stream",{readInProgress:"A read operation is already in progress",writeInProgress:"A write operation is already in progress"});e.stream={};F.prototype={_readable:null,_writable:null,_chunkSize:4096,_eventsHandler:null,scope:null};F.prototype.ready=function(a){g(a);this._readable.read(this._chunkSize,this)};F.prototype.endOfData=function(a){g(a);h.apply(this,["ready",{},this._eventsHandler])};
F.prototype.data=function(a){a=a.get("buffer");this._writable.write(a,this)};F.prototype["*"]=function(a){h.apply(this,[a,{},this._eventsHandler])};e.stream.pipe=la;var va=C("StringStream",Object,{"[Class]":[e.$InterfaceImplement(v.IReadableStream),e.$InterfaceImplement(v.IWritableStream)],"+":{constructor:function(a){this._buffer="string"===typeof a?[a]:[]},read:function(a,b){var c;0===this._buffer.length?h.apply(this,["endOfData",{},b]):(c=cb(this._buffer,a),h.apply(this,["data",{buffer:c},b]))},
write:function(a,b){p("string"===typeof a&&a.length,"String buffer must contain data");this._buffer.push(a);h.apply(this,["ready",{},b])},toString:function(){return this._buffer.join("")}},"-":{_buffer:[]}});H(e,{capitalize:Ha,replaceEx:N,escapeFor:aa,stringExtractFromStringArray:cb,stringToStream:function(a){return new va(a)},stringFromStream:function(a,b){if(a instanceof va)h("ready",{buffer:a.toString()},b);else{var c=new va;la({readable:a,writable:c},function(a){"ready"===a.type?h("ready",{buffer:c.toString()},
b):h(a,{},b)})}}});var wa=C("ArrayStream",Object,{"[Class]":[e.$InterfaceImplement(v.IReadableStream),e.$InterfaceImplement(v.IWritableStream)],"+":{constructor:function(a){this._buffer=a instanceof Array?[].concat(a):[]},read:function(a,b){var c;0===this._buffer.length?h.apply(this,["endOfData",{},b]):(c=this._buffer.splice(0,a),h.apply(this,["data",{buffer:c},b]))},write:function(a,b){p(a instanceof Array,"Array expected");this._buffer=this._buffer.concat(a);h.apply(this,["ready",{},b])},toArray:function(){return[].concat(this._buffer)}},
"-":{_buffer:[]}});H(e,{arrayToStream:function(a){return new wa(a)},arrayFromStream:function(a,b){if(a instanceof wa)h("ready",{buffer:a.toArray()},b);else{var c=new wa;la({readable:a,writable:c},function(a){"ready"===a.type?h("ready",{buffer:c.toArray()},b):h(a,{},b)})}}})});
